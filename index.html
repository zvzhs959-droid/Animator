<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Flux Animator - Gemini 2.5 Integrated</title>
    <style>body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background-color: #121212;
    font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    color: #ffffff;
    -webkit-font-smoothing: antialiased;
}

#canvas-container {
    width: 100vw;
    height: 100vh;
    display: block;
    background: radial-gradient(circle at center, #2a2a2a 0%, #111 100%);
}

/* UI Overlays */
#ui-layer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    padding: 20px;
    box-sizing: border-box;
}

/* Glassmorphism Panels */
.panel {
    background: rgba(20, 20, 20, 0.65);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.08);
    box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
    padding: 20px;
    border-radius: 16px;
    pointer-events: auto;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.panel:hover {
    box-shadow: 0 12px 40px 0 rgba(0, 0, 0, 0.4);
    border-color: rgba(255, 255, 255, 0.15);
}

.panel h3 {
    margin: 0 0 15px 0;
    font-size: 1.1rem;
    font-weight: 600;
    color: #eee;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    padding-bottom: 8px;
}

/* Layout Positioning */
.top-left {
    position: absolute;
    top: 20px;
    left: 20px;
    width: 220px;
    z-index: 10;
}

.top-right {
    position: absolute;
    top: 20px;
    right: 20px;
    width: 260px;
    max-height: 50vh;
    display: flex;
    flex-direction: column;
    z-index: 10;
}

.bottom-left {
    position: absolute;
    bottom: 20px;
    left: 20px;
    width: 320px;
    z-index: 10;
}

.bottom-center {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    width: 400px;
    text-align: center;
    z-index: 10;
    padding: 15px 25px;
}

/* Controls */
button {
    background: linear-gradient(135deg, #4a90e2 0%, #357abd 100%);
    color: white;
    border: none;
    padding: 10px 18px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    font-size: 0.9rem;
    transition: all 0.2s ease;
    box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
    width: 100%;
    margin-bottom: 8px;
    text-shadow: 0 1px 2px rgba(0,0,0,0.2);
}

button:hover {
    transform: translateY(-1px);
    box-shadow: 0 6px 20px rgba(74, 144, 226, 0.4);
    filter: brightness(1.1);
}

button:active {
    transform: translateY(1px);
    box-shadow: 0 2px 10px rgba(74, 144, 226, 0.2);
}

button:disabled {
    background: #444;
    color: #888;
    cursor: not-allowed;
    box-shadow: none;
    transform: none;
}

.secondary {
    background: rgba(255, 255, 255, 0.1);
    box-shadow: none;
}

.secondary:hover {
    background: rgba(255, 255, 255, 0.2);
}

/* Inputs */
#gen-prompt {
    width: 100%;
    height: 80px;
    background: rgba(0, 0, 0, 0.4);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    color: white;
    padding: 12px;
    margin-bottom: 12px;
    resize: none;
    font-family: inherit;
    box-sizing: border-box;
    transition: border-color 0.2s;
}

#gen-prompt:focus {
    outline: none;
    border-color: #4a90e2;
    background: rgba(0, 0, 0, 0.6);
}

/* Animation List */
.scrollable-list {
    flex: 1;
    overflow-y: auto;
    margin-top: 10px;
    border: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: 8px;
    background: rgba(0, 0, 0, 0.2);
    max-height: 300px;
}

.scrollable-list::-webkit-scrollbar {
    width: 6px;
}

.scrollable-list::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.2);
    border-radius: 3px;
}

.anim-item {
    padding: 10px 14px;
    cursor: pointer;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    text-align: left;
    transition: background 0.2s;
    font-size: 0.9rem;
    display: flex;
    align-items: center;
}

.anim-item:hover {
    background: rgba(255, 255, 255, 0.1);
}

.anim-item.active {
    background: rgba(74, 144, 226, 0.2);
    color: #4a90e2;
    border-left: 3px solid #4a90e2;
}

/* Playback Controls */
.control-row {
    display: flex;
    align-items: center;
    gap: 15px;
    width: 100%;
}

.icon-btn {
    width: 40px;
    height: 40px;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 1.2rem;
    border-radius: 50%;
    margin-bottom: 0;
}

#anim-slider {
    flex: 1;
    cursor: pointer;
    height: 4px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 2px;
    -webkit-appearance: none;
}

#anim-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 16px;
    height: 16px;
    background: #4a90e2;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 0 10px rgba(74, 144, 226, 0.5);
    transition: transform 0.1s;
}

#anim-slider::-webkit-slider-thumb:hover {
    transform: scale(1.2);
}

.time-display {
    font-family: 'Roboto Mono', monospace;
    font-size: 0.85rem;
    min-width: 45px;
    color: #aaa;
}

/* Modal */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    z-index: 20000;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(8px);
}

.modal-content {
    background: #222;
    padding: 30px;
    border-radius: 16px;
    width: 90%;
    max-width: 400px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 20px 50px rgba(0,0,0,0.6);
}

.input-group input,
.input-group textarea {
    width: 100%;
    padding: 12px;
    background: #151515;
    border: 1px solid #333;
    border-radius: 6px;
    color: white;
    box-sizing: border-box;
    font-size: 1rem;
    font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
}

.input-group input:focus,
.input-group textarea:focus {
    border-color: #4a90e2;
    outline: none;
}

.modal-actions {
    display: flex;
    justify-content: flex-end;
    gap: 12px;
    margin-top: 20px;
}

.modal-actions button {
    width: auto;
    margin-bottom: 0;
}

/* Loading Screen */
#loading-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #000;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 9999;
}

.spinner {
    width: 50px;
    height: 50px;
    border: 4px solid rgba(255, 255, 255, 0.1);
    border-radius: 50%;
    border-top-color: #4a90e2;
    animation: spin 0.8s ease-in-out infinite;
    margin-bottom: 20px;
}

#loading-text {
    font-size: 1.1rem;
    letter-spacing: 1px;
    color: #ccc;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* Drag Active */
body.drag-active::after {
    content: "Drop GLB File Here";
    position: absolute;
    top: 20px;
    left: 20px;
    right: 20px;
    bottom: 20px;
    border: 4px dashed #4a90e2;
    border-radius: 20px;
    background: rgba(0, 0, 0, 0.8);
    z-index: 10000;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 2rem;
    font-weight: bold;
    color: #4a90e2;
    backdrop-filter: blur(5px);
    pointer-events: none;
}

/* --- Mobile Responsiveness --- */
@media (max-width: 768px) {
    .panel {
        padding: 15px;
        border-radius: 12px;
    }

    /* Stack everything vertically or use safe zones */
    .top-left {
        top: 10px;
        left: 10px;
        width: auto;
        right: auto;
        display: flex;
        gap: 10px;
    }
    
    .top-left button {
        width: auto;
        padding: 8px 12px;
        font-size: 0.8rem;
        margin-bottom: 0;
    }
    
    .top-left h3 {
        display: none; /* Hide title on mobile to save space */
    }

    .top-right {
        top: 60px; /* Below top-left buttons */
        left: 10px;
        right: auto;
        width: 180px;
        max-height: 30vh;
    }

    .bottom-left {
        bottom: 80px; /* Above controls */
        left: 10px;
        right: 10px;
        width: auto;
    }

    .bottom-center {
        bottom: 10px;
        width: 95%;
        padding: 10px;
    }

    #gen-prompt {
        height: 50px;
    }
    
    .control-row {
        gap: 8px;
    }
    
    .icon-btn {
        width: 36px;
        height: 36px;
    }
}</style>
    
    <!-- Three.js Core (Global Scope) -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
    <!-- OrbitControls (Global Scope) -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <!-- GLTFLoader (Global Scope) -->
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <!-- GLTFExporter (Global Scope) -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/exporters/GLTFExporter.js"></script>
<script type="importmap">{"imports":{"css/style.css":"data:text/css;base64,Ym9keSB7CiAgICBtYXJnaW46IDA7CiAgICBwYWRkaW5nOiAwOwogICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgIGJhY2tncm91bmQtY29sb3I6ICMxMjEyMTI7CiAgICBmb250LWZhbWlseTogJ1NlZ29lIFVJJywgUm9ib3RvLCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmOwogICAgY29sb3I6ICNmZmZmZmY7CiAgICAtd2Via2l0LWZvbnQtc21vb3RoaW5nOiBhbnRpYWxpYXNlZDsKfQoKI2NhbnZhcy1jb250YWluZXIgewogICAgd2lkdGg6IDEwMHZ3OwogICAgaGVpZ2h0OiAxMDB2aDsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCBjZW50ZXIsICMyYTJhMmEgMCUsICMxMTEgMTAwJSk7Cn0KCi8qIFVJIE92ZXJsYXlzICovCiN1aS1sYXllciB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB0b3A6IDA7CiAgICBsZWZ0OiAwOwogICAgd2lkdGg6IDEwMCU7CiAgICBoZWlnaHQ6IDEwMCU7CiAgICBwb2ludGVyLWV2ZW50czogbm9uZTsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgcGFkZGluZzogMjBweDsKICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7Cn0KCi8qIEdsYXNzbW9ycGhpc20gUGFuZWxzICovCi5wYW5lbCB7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDIwLCAyMCwgMjAsIDAuNjUpOwogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDEycHgpOwogICAgLXdlYmtpdC1iYWNrZHJvcC1maWx0ZXI6IGJsdXIoMTJweCk7CiAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDgpOwogICAgYm94LXNoYWRvdzogMCA4cHggMzJweCAwIHJnYmEoMCwgMCwgMCwgMC4zKTsKICAgIHBhZGRpbmc6IDIwcHg7CiAgICBib3JkZXItcmFkaXVzOiAxNnB4OwogICAgcG9pbnRlci1ldmVudHM6IGF1dG87CiAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4ycyBlYXNlLCBib3gtc2hhZG93IDAuMnMgZWFzZTsKfQoKLnBhbmVsOmhvdmVyIHsKICAgIGJveC1zaGFkb3c6IDAgMTJweCA0MHB4IDAgcmdiYSgwLCAwLCAwLCAwLjQpOwogICAgYm9yZGVyLWNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMTUpOwp9CgoucGFuZWwgaDMgewogICAgbWFyZ2luOiAwIDAgMTVweCAwOwogICAgZm9udC1zaXplOiAxLjFyZW07CiAgICBmb250LXdlaWdodDogNjAwOwogICAgY29sb3I6ICNlZWU7CiAgICBsZXR0ZXItc3BhY2luZzogMC41cHg7CiAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOwogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTsKICAgIHBhZGRpbmctYm90dG9tOiA4cHg7Cn0KCi8qIExheW91dCBQb3NpdGlvbmluZyAqLwoudG9wLWxlZnQgewogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgdG9wOiAyMHB4OwogICAgbGVmdDogMjBweDsKICAgIHdpZHRoOiAyMjBweDsKICAgIHotaW5kZXg6IDEwOwp9CgoudG9wLXJpZ2h0IHsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHRvcDogMjBweDsKICAgIHJpZ2h0OiAyMHB4OwogICAgd2lkdGg6IDI2MHB4OwogICAgbWF4LWhlaWdodDogNTB2aDsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgei1pbmRleDogMTA7Cn0KCi5ib3R0b20tbGVmdCB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICBib3R0b206IDIwcHg7CiAgICBsZWZ0OiAyMHB4OwogICAgd2lkdGg6IDMyMHB4OwogICAgei1pbmRleDogMTA7Cn0KCi5ib3R0b20tY2VudGVyIHsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIGJvdHRvbTogMjBweDsKICAgIGxlZnQ6IDUwJTsKICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsKICAgIHdpZHRoOiA0MDBweDsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIHotaW5kZXg6IDEwOwogICAgcGFkZGluZzogMTVweCAyNXB4Owp9CgovKiBDb250cm9scyAqLwpidXR0b24gewogICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzRhOTBlMiAwJSwgIzM1N2FiZCAxMDAlKTsKICAgIGNvbG9yOiB3aGl0ZTsKICAgIGJvcmRlcjogbm9uZTsKICAgIHBhZGRpbmc6IDEwcHggMThweDsKICAgIGJvcmRlci1yYWRpdXM6IDhweDsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICBmb250LXNpemU6IDAuOXJlbTsKICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7CiAgICBib3gtc2hhZG93OiAwIDRweCAxNXB4IHJnYmEoNzQsIDE0NCwgMjI2LCAwLjMpOwogICAgd2lkdGg6IDEwMCU7CiAgICBtYXJnaW4tYm90dG9tOiA4cHg7CiAgICB0ZXh0LXNoYWRvdzogMCAxcHggMnB4IHJnYmEoMCwwLDAsMC4yKTsKfQoKYnV0dG9uOmhvdmVyIHsKICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMXB4KTsKICAgIGJveC1zaGFkb3c6IDAgNnB4IDIwcHggcmdiYSg3NCwgMTQ0LCAyMjYsIDAuNCk7CiAgICBmaWx0ZXI6IGJyaWdodG5lc3MoMS4xKTsKfQoKYnV0dG9uOmFjdGl2ZSB7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMXB4KTsKICAgIGJveC1zaGFkb3c6IDAgMnB4IDEwcHggcmdiYSg3NCwgMTQ0LCAyMjYsIDAuMik7Cn0KCmJ1dHRvbjpkaXNhYmxlZCB7CiAgICBiYWNrZ3JvdW5kOiAjNDQ0OwogICAgY29sb3I6ICM4ODg7CiAgICBjdXJzb3I6IG5vdC1hbGxvd2VkOwogICAgYm94LXNoYWRvdzogbm9uZTsKICAgIHRyYW5zZm9ybTogbm9uZTsKfQoKLnNlY29uZGFyeSB7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSk7CiAgICBib3gtc2hhZG93OiBub25lOwp9Cgouc2Vjb25kYXJ5OmhvdmVyIHsKICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTsKfQoKLyogSW5wdXRzICovCiNnZW4tcHJvbXB0IHsKICAgIHdpZHRoOiAxMDAlOwogICAgaGVpZ2h0OiA4MHB4OwogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjQpOwogICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpOwogICAgYm9yZGVyLXJhZGl1czogOHB4OwogICAgY29sb3I6IHdoaXRlOwogICAgcGFkZGluZzogMTJweDsKICAgIG1hcmdpbi1ib3R0b206IDEycHg7CiAgICByZXNpemU6IG5vbmU7CiAgICBmb250LWZhbWlseTogaW5oZXJpdDsKICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgICB0cmFuc2l0aW9uOiBib3JkZXItY29sb3IgMC4yczsKfQoKI2dlbi1wcm9tcHQ6Zm9jdXMgewogICAgb3V0bGluZTogbm9uZTsKICAgIGJvcmRlci1jb2xvcjogIzRhOTBlMjsKICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC42KTsKfQoKLyogQW5pbWF0aW9uIExpc3QgKi8KLnNjcm9sbGFibGUtbGlzdCB7CiAgICBmbGV4OiAxOwogICAgb3ZlcmZsb3cteTogYXV0bzsKICAgIG1hcmdpbi10b3A6IDEwcHg7CiAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDUpOwogICAgYm9yZGVyLXJhZGl1czogOHB4OwogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjIpOwogICAgbWF4LWhlaWdodDogMzAwcHg7Cn0KCi5zY3JvbGxhYmxlLWxpc3Q6Oi13ZWJraXQtc2Nyb2xsYmFyIHsKICAgIHdpZHRoOiA2cHg7Cn0KCi5zY3JvbGxhYmxlLWxpc3Q6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHsKICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTsKICAgIGJvcmRlci1yYWRpdXM6IDNweDsKfQoKLmFuaW0taXRlbSB7CiAgICBwYWRkaW5nOiAxMHB4IDE0cHg7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjA1KTsKICAgIHRleHQtYWxpZ246IGxlZnQ7CiAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIDAuMnM7CiAgICBmb250LXNpemU6IDAuOXJlbTsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwp9CgouYW5pbS1pdGVtOmhvdmVyIHsKICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTsKfQoKLmFuaW0taXRlbS5hY3RpdmUgewogICAgYmFja2dyb3VuZDogcmdiYSg3NCwgMTQ0LCAyMjYsIDAuMik7CiAgICBjb2xvcjogIzRhOTBlMjsKICAgIGJvcmRlci1sZWZ0OiAzcHggc29saWQgIzRhOTBlMjsKfQoKLyogUGxheWJhY2sgQ29udHJvbHMgKi8KLmNvbnRyb2wtcm93IHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgZ2FwOiAxNXB4OwogICAgd2lkdGg6IDEwMCU7Cn0KCi5pY29uLWJ0biB7CiAgICB3aWR0aDogNDBweDsKICAgIGhlaWdodDogNDBweDsKICAgIHBhZGRpbmc6IDA7CiAgICBkaXNwbGF5OiBmbGV4OwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgZm9udC1zaXplOiAxLjJyZW07CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICBtYXJnaW4tYm90dG9tOiAwOwp9CgojYW5pbS1zbGlkZXIgewogICAgZmxleDogMTsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIGhlaWdodDogNHB4OwogICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjIpOwogICAgYm9yZGVyLXJhZGl1czogMnB4OwogICAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lOwp9CgojYW5pbS1zbGlkZXI6Oi13ZWJraXQtc2xpZGVyLXRodW1iIHsKICAgIC13ZWJraXQtYXBwZWFyYW5jZTogbm9uZTsKICAgIHdpZHRoOiAxNnB4OwogICAgaGVpZ2h0OiAxNnB4OwogICAgYmFja2dyb3VuZDogIzRhOTBlMjsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIGJveC1zaGFkb3c6IDAgMCAxMHB4IHJnYmEoNzQsIDE0NCwgMjI2LCAwLjUpOwogICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMXM7Cn0KCiNhbmltLXNsaWRlcjo6LXdlYmtpdC1zbGlkZXItdGh1bWI6aG92ZXIgewogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjIpOwp9CgoudGltZS1kaXNwbGF5IHsKICAgIGZvbnQtZmFtaWx5OiAnUm9ib3RvIE1vbm8nLCBtb25vc3BhY2U7CiAgICBmb250LXNpemU6IDAuODVyZW07CiAgICBtaW4td2lkdGg6IDQ1cHg7CiAgICBjb2xvcjogI2FhYTsKfQoKLyogTW9kYWwgKi8KLm1vZGFsIHsKICAgIGRpc3BsYXk6IG5vbmU7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICB0b3A6IDA7CiAgICBsZWZ0OiAwOwogICAgd2lkdGg6IDEwMCU7CiAgICBoZWlnaHQ6IDEwMCU7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuODUpOwogICAgei1pbmRleDogMjAwMDA7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoOHB4KTsKfQoKLm1vZGFsLWNvbnRlbnQgewogICAgYmFja2dyb3VuZDogIzIyMjsKICAgIHBhZGRpbmc6IDMwcHg7CiAgICBib3JkZXItcmFkaXVzOiAxNnB4OwogICAgd2lkdGg6IDkwJTsKICAgIG1heC13aWR0aDogNDAwcHg7CiAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSk7CiAgICBib3gtc2hhZG93OiAwIDIwcHggNTBweCByZ2JhKDAsMCwwLDAuNik7Cn0KCi5pbnB1dC1ncm91cCBpbnB1dCwKLmlucHV0LWdyb3VwIHRleHRhcmVhIHsKICAgIHdpZHRoOiAxMDAlOwogICAgcGFkZGluZzogMTJweDsKICAgIGJhY2tncm91bmQ6ICMxNTE1MTU7CiAgICBib3JkZXI6IDFweCBzb2xpZCAjMzMzOwogICAgYm9yZGVyLXJhZGl1czogNnB4OwogICAgY29sb3I6IHdoaXRlOwogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsKICAgIGZvbnQtc2l6ZTogMXJlbTsKICAgIGZvbnQtZmFtaWx5OiAnU2Vnb2UgVUknLCBSb2JvdG8sIEhlbHZldGljYSwgQXJpYWwsIHNhbnMtc2VyaWY7Cn0KCi5pbnB1dC1ncm91cCBpbnB1dDpmb2N1cywKLmlucHV0LWdyb3VwIHRleHRhcmVhOmZvY3VzIHsKICAgIGJvcmRlci1jb2xvcjogIzRhOTBlMjsKICAgIG91dGxpbmU6IG5vbmU7Cn0KCi5tb2RhbC1hY3Rpb25zIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kOwogICAgZ2FwOiAxMnB4OwogICAgbWFyZ2luLXRvcDogMjBweDsKfQoKLm1vZGFsLWFjdGlvbnMgYnV0dG9uIHsKICAgIHdpZHRoOiBhdXRvOwogICAgbWFyZ2luLWJvdHRvbTogMDsKfQoKLyogTG9hZGluZyBTY3JlZW4gKi8KI2xvYWRpbmctb3ZlcmxheSB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB0b3A6IDA7CiAgICBsZWZ0OiAwOwogICAgd2lkdGg6IDEwMCU7CiAgICBoZWlnaHQ6IDEwMCU7CiAgICBiYWNrZ3JvdW5kOiAjMDAwOwogICAgZGlzcGxheTogZmxleDsKICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICB6LWluZGV4OiA5OTk5Owp9Cgouc3Bpbm5lciB7CiAgICB3aWR0aDogNTBweDsKICAgIGhlaWdodDogNTBweDsKICAgIGJvcmRlcjogNHB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIGJvcmRlci10b3AtY29sb3I6ICM0YTkwZTI7CiAgICBhbmltYXRpb246IHNwaW4gMC44cyBlYXNlLWluLW91dCBpbmZpbml0ZTsKICAgIG1hcmdpbi1ib3R0b206IDIwcHg7Cn0KCiNsb2FkaW5nLXRleHQgewogICAgZm9udC1zaXplOiAxLjFyZW07CiAgICBsZXR0ZXItc3BhY2luZzogMXB4OwogICAgY29sb3I6ICNjY2M7Cn0KCkBrZXlmcmFtZXMgc3BpbiB7CiAgICB0byB7IHRyYW5zZm9ybTogcm90YXRlKDM2MGRlZyk7IH0KfQoKLyogRHJhZyBBY3RpdmUgKi8KYm9keS5kcmFnLWFjdGl2ZTo6YWZ0ZXIgewogICAgY29udGVudDogIkRyb3AgR0xCIEZpbGUgSGVyZSI7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB0b3A6IDIwcHg7CiAgICBsZWZ0OiAyMHB4OwogICAgcmlnaHQ6IDIwcHg7CiAgICBib3R0b206IDIwcHg7CiAgICBib3JkZXI6IDRweCBkYXNoZWQgIzRhOTBlMjsKICAgIGJvcmRlci1yYWRpdXM6IDIwcHg7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuOCk7CiAgICB6LWluZGV4OiAxMDAwMDsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICBmb250LXNpemU6IDJyZW07CiAgICBmb250LXdlaWdodDogYm9sZDsKICAgIGNvbG9yOiAjNGE5MGUyOwogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDVweCk7CiAgICBwb2ludGVyLWV2ZW50czogbm9uZTsKfQoKLyogLS0tIE1vYmlsZSBSZXNwb25zaXZlbmVzcyAtLS0gKi8KQG1lZGlhIChtYXgtd2lkdGg6IDc2OHB4KSB7CiAgICAucGFuZWwgewogICAgICAgIHBhZGRpbmc6IDE1cHg7CiAgICAgICAgYm9yZGVyLXJhZGl1czogMTJweDsKICAgIH0KCiAgICAvKiBTdGFjayBldmVyeXRoaW5nIHZlcnRpY2FsbHkgb3IgdXNlIHNhZmUgem9uZXMgKi8KICAgIC50b3AtbGVmdCB7CiAgICAgICAgdG9wOiAxMHB4OwogICAgICAgIGxlZnQ6IDEwcHg7CiAgICAgICAgd2lkdGg6IGF1dG87CiAgICAgICAgcmlnaHQ6IGF1dG87CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBnYXA6IDEwcHg7CiAgICB9CiAgICAKICAgIC50b3AtbGVmdCBidXR0b24gewogICAgICAgIHdpZHRoOiBhdXRvOwogICAgICAgIHBhZGRpbmc6IDhweCAxMnB4OwogICAgICAgIGZvbnQtc2l6ZTogMC44cmVtOwogICAgICAgIG1hcmdpbi1ib3R0b206IDA7CiAgICB9CiAgICAKICAgIC50b3AtbGVmdCBoMyB7CiAgICAgICAgZGlzcGxheTogbm9uZTsgLyogSGlkZSB0aXRsZSBvbiBtb2JpbGUgdG8gc2F2ZSBzcGFjZSAqLwogICAgfQoKICAgIC50b3AtcmlnaHQgewogICAgICAgIHRvcDogNjBweDsgLyogQmVsb3cgdG9wLWxlZnQgYnV0dG9ucyAqLwogICAgICAgIGxlZnQ6IDEwcHg7CiAgICAgICAgcmlnaHQ6IGF1dG87CiAgICAgICAgd2lkdGg6IDE4MHB4OwogICAgICAgIG1heC1oZWlnaHQ6IDMwdmg7CiAgICB9CgogICAgLmJvdHRvbS1sZWZ0IHsKICAgICAgICBib3R0b206IDgwcHg7IC8qIEFib3ZlIGNvbnRyb2xzICovCiAgICAgICAgbGVmdDogMTBweDsKICAgICAgICByaWdodDogMTBweDsKICAgICAgICB3aWR0aDogYXV0bzsKICAgIH0KCiAgICAuYm90dG9tLWNlbnRlciB7CiAgICAgICAgYm90dG9tOiAxMHB4OwogICAgICAgIHdpZHRoOiA5NSU7CiAgICAgICAgcGFkZGluZzogMTBweDsKICAgIH0KCiAgICAjZ2VuLXByb21wdCB7CiAgICAgICAgaGVpZ2h0OiA1MHB4OwogICAgfQogICAgCiAgICAuY29udHJvbC1yb3cgewogICAgICAgIGdhcDogOHB4OwogICAgfQogICAgCiAgICAuaWNvbi1idG4gewogICAgICAgIHdpZHRoOiAzNnB4OwogICAgICAgIGhlaWdodDogMzZweDsKICAgIH0KfQ==","./css/style.css":"data:text/css;base64,Ym9keSB7CiAgICBtYXJnaW46IDA7CiAgICBwYWRkaW5nOiAwOwogICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgIGJhY2tncm91bmQtY29sb3I6ICMxMjEyMTI7CiAgICBmb250LWZhbWlseTogJ1NlZ29lIFVJJywgUm9ib3RvLCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmOwogICAgY29sb3I6ICNmZmZmZmY7CiAgICAtd2Via2l0LWZvbnQtc21vb3RoaW5nOiBhbnRpYWxpYXNlZDsKfQoKI2NhbnZhcy1jb250YWluZXIgewogICAgd2lkdGg6IDEwMHZ3OwogICAgaGVpZ2h0OiAxMDB2aDsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCBjZW50ZXIsICMyYTJhMmEgMCUsICMxMTEgMTAwJSk7Cn0KCi8qIFVJIE92ZXJsYXlzICovCiN1aS1sYXllciB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB0b3A6IDA7CiAgICBsZWZ0OiAwOwogICAgd2lkdGg6IDEwMCU7CiAgICBoZWlnaHQ6IDEwMCU7CiAgICBwb2ludGVyLWV2ZW50czogbm9uZTsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgcGFkZGluZzogMjBweDsKICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7Cn0KCi8qIEdsYXNzbW9ycGhpc20gUGFuZWxzICovCi5wYW5lbCB7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDIwLCAyMCwgMjAsIDAuNjUpOwogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDEycHgpOwogICAgLXdlYmtpdC1iYWNrZHJvcC1maWx0ZXI6IGJsdXIoMTJweCk7CiAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDgpOwogICAgYm94LXNoYWRvdzogMCA4cHggMzJweCAwIHJnYmEoMCwgMCwgMCwgMC4zKTsKICAgIHBhZGRpbmc6IDIwcHg7CiAgICBib3JkZXItcmFkaXVzOiAxNnB4OwogICAgcG9pbnRlci1ldmVudHM6IGF1dG87CiAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4ycyBlYXNlLCBib3gtc2hhZG93IDAuMnMgZWFzZTsKfQoKLnBhbmVsOmhvdmVyIHsKICAgIGJveC1zaGFkb3c6IDAgMTJweCA0MHB4IDAgcmdiYSgwLCAwLCAwLCAwLjQpOwogICAgYm9yZGVyLWNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMTUpOwp9CgoucGFuZWwgaDMgewogICAgbWFyZ2luOiAwIDAgMTVweCAwOwogICAgZm9udC1zaXplOiAxLjFyZW07CiAgICBmb250LXdlaWdodDogNjAwOwogICAgY29sb3I6ICNlZWU7CiAgICBsZXR0ZXItc3BhY2luZzogMC41cHg7CiAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOwogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTsKICAgIHBhZGRpbmctYm90dG9tOiA4cHg7Cn0KCi8qIExheW91dCBQb3NpdGlvbmluZyAqLwoudG9wLWxlZnQgewogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgdG9wOiAyMHB4OwogICAgbGVmdDogMjBweDsKICAgIHdpZHRoOiAyMjBweDsKICAgIHotaW5kZXg6IDEwOwp9CgoudG9wLXJpZ2h0IHsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHRvcDogMjBweDsKICAgIHJpZ2h0OiAyMHB4OwogICAgd2lkdGg6IDI2MHB4OwogICAgbWF4LWhlaWdodDogNTB2aDsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgei1pbmRleDogMTA7Cn0KCi5ib3R0b20tbGVmdCB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICBib3R0b206IDIwcHg7CiAgICBsZWZ0OiAyMHB4OwogICAgd2lkdGg6IDMyMHB4OwogICAgei1pbmRleDogMTA7Cn0KCi5ib3R0b20tY2VudGVyIHsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIGJvdHRvbTogMjBweDsKICAgIGxlZnQ6IDUwJTsKICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsKICAgIHdpZHRoOiA0MDBweDsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIHotaW5kZXg6IDEwOwogICAgcGFkZGluZzogMTVweCAyNXB4Owp9CgovKiBDb250cm9scyAqLwpidXR0b24gewogICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzRhOTBlMiAwJSwgIzM1N2FiZCAxMDAlKTsKICAgIGNvbG9yOiB3aGl0ZTsKICAgIGJvcmRlcjogbm9uZTsKICAgIHBhZGRpbmc6IDEwcHggMThweDsKICAgIGJvcmRlci1yYWRpdXM6IDhweDsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICBmb250LXNpemU6IDAuOXJlbTsKICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7CiAgICBib3gtc2hhZG93OiAwIDRweCAxNXB4IHJnYmEoNzQsIDE0NCwgMjI2LCAwLjMpOwogICAgd2lkdGg6IDEwMCU7CiAgICBtYXJnaW4tYm90dG9tOiA4cHg7CiAgICB0ZXh0LXNoYWRvdzogMCAxcHggMnB4IHJnYmEoMCwwLDAsMC4yKTsKfQoKYnV0dG9uOmhvdmVyIHsKICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMXB4KTsKICAgIGJveC1zaGFkb3c6IDAgNnB4IDIwcHggcmdiYSg3NCwgMTQ0LCAyMjYsIDAuNCk7CiAgICBmaWx0ZXI6IGJyaWdodG5lc3MoMS4xKTsKfQoKYnV0dG9uOmFjdGl2ZSB7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMXB4KTsKICAgIGJveC1zaGFkb3c6IDAgMnB4IDEwcHggcmdiYSg3NCwgMTQ0LCAyMjYsIDAuMik7Cn0KCmJ1dHRvbjpkaXNhYmxlZCB7CiAgICBiYWNrZ3JvdW5kOiAjNDQ0OwogICAgY29sb3I6ICM4ODg7CiAgICBjdXJzb3I6IG5vdC1hbGxvd2VkOwogICAgYm94LXNoYWRvdzogbm9uZTsKICAgIHRyYW5zZm9ybTogbm9uZTsKfQoKLnNlY29uZGFyeSB7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSk7CiAgICBib3gtc2hhZG93OiBub25lOwp9Cgouc2Vjb25kYXJ5OmhvdmVyIHsKICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTsKfQoKLyogSW5wdXRzICovCiNnZW4tcHJvbXB0IHsKICAgIHdpZHRoOiAxMDAlOwogICAgaGVpZ2h0OiA4MHB4OwogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjQpOwogICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpOwogICAgYm9yZGVyLXJhZGl1czogOHB4OwogICAgY29sb3I6IHdoaXRlOwogICAgcGFkZGluZzogMTJweDsKICAgIG1hcmdpbi1ib3R0b206IDEycHg7CiAgICByZXNpemU6IG5vbmU7CiAgICBmb250LWZhbWlseTogaW5oZXJpdDsKICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgICB0cmFuc2l0aW9uOiBib3JkZXItY29sb3IgMC4yczsKfQoKI2dlbi1wcm9tcHQ6Zm9jdXMgewogICAgb3V0bGluZTogbm9uZTsKICAgIGJvcmRlci1jb2xvcjogIzRhOTBlMjsKICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC42KTsKfQoKLyogQW5pbWF0aW9uIExpc3QgKi8KLnNjcm9sbGFibGUtbGlzdCB7CiAgICBmbGV4OiAxOwogICAgb3ZlcmZsb3cteTogYXV0bzsKICAgIG1hcmdpbi10b3A6IDEwcHg7CiAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDUpOwogICAgYm9yZGVyLXJhZGl1czogOHB4OwogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjIpOwogICAgbWF4LWhlaWdodDogMzAwcHg7Cn0KCi5zY3JvbGxhYmxlLWxpc3Q6Oi13ZWJraXQtc2Nyb2xsYmFyIHsKICAgIHdpZHRoOiA2cHg7Cn0KCi5zY3JvbGxhYmxlLWxpc3Q6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHsKICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTsKICAgIGJvcmRlci1yYWRpdXM6IDNweDsKfQoKLmFuaW0taXRlbSB7CiAgICBwYWRkaW5nOiAxMHB4IDE0cHg7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjA1KTsKICAgIHRleHQtYWxpZ246IGxlZnQ7CiAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIDAuMnM7CiAgICBmb250LXNpemU6IDAuOXJlbTsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwp9CgouYW5pbS1pdGVtOmhvdmVyIHsKICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTsKfQoKLmFuaW0taXRlbS5hY3RpdmUgewogICAgYmFja2dyb3VuZDogcmdiYSg3NCwgMTQ0LCAyMjYsIDAuMik7CiAgICBjb2xvcjogIzRhOTBlMjsKICAgIGJvcmRlci1sZWZ0OiAzcHggc29saWQgIzRhOTBlMjsKfQoKLyogUGxheWJhY2sgQ29udHJvbHMgKi8KLmNvbnRyb2wtcm93IHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgZ2FwOiAxNXB4OwogICAgd2lkdGg6IDEwMCU7Cn0KCi5pY29uLWJ0biB7CiAgICB3aWR0aDogNDBweDsKICAgIGhlaWdodDogNDBweDsKICAgIHBhZGRpbmc6IDA7CiAgICBkaXNwbGF5OiBmbGV4OwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgZm9udC1zaXplOiAxLjJyZW07CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICBtYXJnaW4tYm90dG9tOiAwOwp9CgojYW5pbS1zbGlkZXIgewogICAgZmxleDogMTsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIGhlaWdodDogNHB4OwogICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjIpOwogICAgYm9yZGVyLXJhZGl1czogMnB4OwogICAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lOwp9CgojYW5pbS1zbGlkZXI6Oi13ZWJraXQtc2xpZGVyLXRodW1iIHsKICAgIC13ZWJraXQtYXBwZWFyYW5jZTogbm9uZTsKICAgIHdpZHRoOiAxNnB4OwogICAgaGVpZ2h0OiAxNnB4OwogICAgYmFja2dyb3VuZDogIzRhOTBlMjsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIGJveC1zaGFkb3c6IDAgMCAxMHB4IHJnYmEoNzQsIDE0NCwgMjI2LCAwLjUpOwogICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMXM7Cn0KCiNhbmltLXNsaWRlcjo6LXdlYmtpdC1zbGlkZXItdGh1bWI6aG92ZXIgewogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjIpOwp9CgoudGltZS1kaXNwbGF5IHsKICAgIGZvbnQtZmFtaWx5OiAnUm9ib3RvIE1vbm8nLCBtb25vc3BhY2U7CiAgICBmb250LXNpemU6IDAuODVyZW07CiAgICBtaW4td2lkdGg6IDQ1cHg7CiAgICBjb2xvcjogI2FhYTsKfQoKLyogTW9kYWwgKi8KLm1vZGFsIHsKICAgIGRpc3BsYXk6IG5vbmU7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICB0b3A6IDA7CiAgICBsZWZ0OiAwOwogICAgd2lkdGg6IDEwMCU7CiAgICBoZWlnaHQ6IDEwMCU7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuODUpOwogICAgei1pbmRleDogMjAwMDA7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoOHB4KTsKfQoKLm1vZGFsLWNvbnRlbnQgewogICAgYmFja2dyb3VuZDogIzIyMjsKICAgIHBhZGRpbmc6IDMwcHg7CiAgICBib3JkZXItcmFkaXVzOiAxNnB4OwogICAgd2lkdGg6IDkwJTsKICAgIG1heC13aWR0aDogNDAwcHg7CiAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSk7CiAgICBib3gtc2hhZG93OiAwIDIwcHggNTBweCByZ2JhKDAsMCwwLDAuNik7Cn0KCi5pbnB1dC1ncm91cCBpbnB1dCwKLmlucHV0LWdyb3VwIHRleHRhcmVhIHsKICAgIHdpZHRoOiAxMDAlOwogICAgcGFkZGluZzogMTJweDsKICAgIGJhY2tncm91bmQ6ICMxNTE1MTU7CiAgICBib3JkZXI6IDFweCBzb2xpZCAjMzMzOwogICAgYm9yZGVyLXJhZGl1czogNnB4OwogICAgY29sb3I6IHdoaXRlOwogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsKICAgIGZvbnQtc2l6ZTogMXJlbTsKICAgIGZvbnQtZmFtaWx5OiAnU2Vnb2UgVUknLCBSb2JvdG8sIEhlbHZldGljYSwgQXJpYWwsIHNhbnMtc2VyaWY7Cn0KCi5pbnB1dC1ncm91cCBpbnB1dDpmb2N1cywKLmlucHV0LWdyb3VwIHRleHRhcmVhOmZvY3VzIHsKICAgIGJvcmRlci1jb2xvcjogIzRhOTBlMjsKICAgIG91dGxpbmU6IG5vbmU7Cn0KCi5tb2RhbC1hY3Rpb25zIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kOwogICAgZ2FwOiAxMnB4OwogICAgbWFyZ2luLXRvcDogMjBweDsKfQoKLm1vZGFsLWFjdGlvbnMgYnV0dG9uIHsKICAgIHdpZHRoOiBhdXRvOwogICAgbWFyZ2luLWJvdHRvbTogMDsKfQoKLyogTG9hZGluZyBTY3JlZW4gKi8KI2xvYWRpbmctb3ZlcmxheSB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB0b3A6IDA7CiAgICBsZWZ0OiAwOwogICAgd2lkdGg6IDEwMCU7CiAgICBoZWlnaHQ6IDEwMCU7CiAgICBiYWNrZ3JvdW5kOiAjMDAwOwogICAgZGlzcGxheTogZmxleDsKICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICB6LWluZGV4OiA5OTk5Owp9Cgouc3Bpbm5lciB7CiAgICB3aWR0aDogNTBweDsKICAgIGhlaWdodDogNTBweDsKICAgIGJvcmRlcjogNHB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIGJvcmRlci10b3AtY29sb3I6ICM0YTkwZTI7CiAgICBhbmltYXRpb246IHNwaW4gMC44cyBlYXNlLWluLW91dCBpbmZpbml0ZTsKICAgIG1hcmdpbi1ib3R0b206IDIwcHg7Cn0KCiNsb2FkaW5nLXRleHQgewogICAgZm9udC1zaXplOiAxLjFyZW07CiAgICBsZXR0ZXItc3BhY2luZzogMXB4OwogICAgY29sb3I6ICNjY2M7Cn0KCkBrZXlmcmFtZXMgc3BpbiB7CiAgICB0byB7IHRyYW5zZm9ybTogcm90YXRlKDM2MGRlZyk7IH0KfQoKLyogRHJhZyBBY3RpdmUgKi8KYm9keS5kcmFnLWFjdGl2ZTo6YWZ0ZXIgewogICAgY29udGVudDogIkRyb3AgR0xCIEZpbGUgSGVyZSI7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB0b3A6IDIwcHg7CiAgICBsZWZ0OiAyMHB4OwogICAgcmlnaHQ6IDIwcHg7CiAgICBib3R0b206IDIwcHg7CiAgICBib3JkZXI6IDRweCBkYXNoZWQgIzRhOTBlMjsKICAgIGJvcmRlci1yYWRpdXM6IDIwcHg7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuOCk7CiAgICB6LWluZGV4OiAxMDAwMDsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICBmb250LXNpemU6IDJyZW07CiAgICBmb250LXdlaWdodDogYm9sZDsKICAgIGNvbG9yOiAjNGE5MGUyOwogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDVweCk7CiAgICBwb2ludGVyLWV2ZW50czogbm9uZTsKfQoKLyogLS0tIE1vYmlsZSBSZXNwb25zaXZlbmVzcyAtLS0gKi8KQG1lZGlhIChtYXgtd2lkdGg6IDc2OHB4KSB7CiAgICAucGFuZWwgewogICAgICAgIHBhZGRpbmc6IDE1cHg7CiAgICAgICAgYm9yZGVyLXJhZGl1czogMTJweDsKICAgIH0KCiAgICAvKiBTdGFjayBldmVyeXRoaW5nIHZlcnRpY2FsbHkgb3IgdXNlIHNhZmUgem9uZXMgKi8KICAgIC50b3AtbGVmdCB7CiAgICAgICAgdG9wOiAxMHB4OwogICAgICAgIGxlZnQ6IDEwcHg7CiAgICAgICAgd2lkdGg6IGF1dG87CiAgICAgICAgcmlnaHQ6IGF1dG87CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBnYXA6IDEwcHg7CiAgICB9CiAgICAKICAgIC50b3AtbGVmdCBidXR0b24gewogICAgICAgIHdpZHRoOiBhdXRvOwogICAgICAgIHBhZGRpbmc6IDhweCAxMnB4OwogICAgICAgIGZvbnQtc2l6ZTogMC44cmVtOwogICAgICAgIG1hcmdpbi1ib3R0b206IDA7CiAgICB9CiAgICAKICAgIC50b3AtbGVmdCBoMyB7CiAgICAgICAgZGlzcGxheTogbm9uZTsgLyogSGlkZSB0aXRsZSBvbiBtb2JpbGUgdG8gc2F2ZSBzcGFjZSAqLwogICAgfQoKICAgIC50b3AtcmlnaHQgewogICAgICAgIHRvcDogNjBweDsgLyogQmVsb3cgdG9wLWxlZnQgYnV0dG9ucyAqLwogICAgICAgIGxlZnQ6IDEwcHg7CiAgICAgICAgcmlnaHQ6IGF1dG87CiAgICAgICAgd2lkdGg6IDE4MHB4OwogICAgICAgIG1heC1oZWlnaHQ6IDMwdmg7CiAgICB9CgogICAgLmJvdHRvbS1sZWZ0IHsKICAgICAgICBib3R0b206IDgwcHg7IC8qIEFib3ZlIGNvbnRyb2xzICovCiAgICAgICAgbGVmdDogMTBweDsKICAgICAgICByaWdodDogMTBweDsKICAgICAgICB3aWR0aDogYXV0bzsKICAgIH0KCiAgICAuYm90dG9tLWNlbnRlciB7CiAgICAgICAgYm90dG9tOiAxMHB4OwogICAgICAgIHdpZHRoOiA5NSU7CiAgICAgICAgcGFkZGluZzogMTBweDsKICAgIH0KCiAgICAjZ2VuLXByb21wdCB7CiAgICAgICAgaGVpZ2h0OiA1MHB4OwogICAgfQogICAgCiAgICAuY29udHJvbC1yb3cgewogICAgICAgIGdhcDogOHB4OwogICAgfQogICAgCiAgICAuaWNvbi1idG4gewogICAgICAgIHdpZHRoOiAzNnB4OwogICAgICAgIGhlaWdodDogMzZweDsKICAgIH0KfQ==","/css/style.css":"data:text/css;base64,Ym9keSB7CiAgICBtYXJnaW46IDA7CiAgICBwYWRkaW5nOiAwOwogICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgIGJhY2tncm91bmQtY29sb3I6ICMxMjEyMTI7CiAgICBmb250LWZhbWlseTogJ1NlZ29lIFVJJywgUm9ib3RvLCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmOwogICAgY29sb3I6ICNmZmZmZmY7CiAgICAtd2Via2l0LWZvbnQtc21vb3RoaW5nOiBhbnRpYWxpYXNlZDsKfQoKI2NhbnZhcy1jb250YWluZXIgewogICAgd2lkdGg6IDEwMHZ3OwogICAgaGVpZ2h0OiAxMDB2aDsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCBjZW50ZXIsICMyYTJhMmEgMCUsICMxMTEgMTAwJSk7Cn0KCi8qIFVJIE92ZXJsYXlzICovCiN1aS1sYXllciB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB0b3A6IDA7CiAgICBsZWZ0OiAwOwogICAgd2lkdGg6IDEwMCU7CiAgICBoZWlnaHQ6IDEwMCU7CiAgICBwb2ludGVyLWV2ZW50czogbm9uZTsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgcGFkZGluZzogMjBweDsKICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7Cn0KCi8qIEdsYXNzbW9ycGhpc20gUGFuZWxzICovCi5wYW5lbCB7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDIwLCAyMCwgMjAsIDAuNjUpOwogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDEycHgpOwogICAgLXdlYmtpdC1iYWNrZHJvcC1maWx0ZXI6IGJsdXIoMTJweCk7CiAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDgpOwogICAgYm94LXNoYWRvdzogMCA4cHggMzJweCAwIHJnYmEoMCwgMCwgMCwgMC4zKTsKICAgIHBhZGRpbmc6IDIwcHg7CiAgICBib3JkZXItcmFkaXVzOiAxNnB4OwogICAgcG9pbnRlci1ldmVudHM6IGF1dG87CiAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4ycyBlYXNlLCBib3gtc2hhZG93IDAuMnMgZWFzZTsKfQoKLnBhbmVsOmhvdmVyIHsKICAgIGJveC1zaGFkb3c6IDAgMTJweCA0MHB4IDAgcmdiYSgwLCAwLCAwLCAwLjQpOwogICAgYm9yZGVyLWNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMTUpOwp9CgoucGFuZWwgaDMgewogICAgbWFyZ2luOiAwIDAgMTVweCAwOwogICAgZm9udC1zaXplOiAxLjFyZW07CiAgICBmb250LXdlaWdodDogNjAwOwogICAgY29sb3I6ICNlZWU7CiAgICBsZXR0ZXItc3BhY2luZzogMC41cHg7CiAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOwogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTsKICAgIHBhZGRpbmctYm90dG9tOiA4cHg7Cn0KCi8qIExheW91dCBQb3NpdGlvbmluZyAqLwoudG9wLWxlZnQgewogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgdG9wOiAyMHB4OwogICAgbGVmdDogMjBweDsKICAgIHdpZHRoOiAyMjBweDsKICAgIHotaW5kZXg6IDEwOwp9CgoudG9wLXJpZ2h0IHsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHRvcDogMjBweDsKICAgIHJpZ2h0OiAyMHB4OwogICAgd2lkdGg6IDI2MHB4OwogICAgbWF4LWhlaWdodDogNTB2aDsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgei1pbmRleDogMTA7Cn0KCi5ib3R0b20tbGVmdCB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICBib3R0b206IDIwcHg7CiAgICBsZWZ0OiAyMHB4OwogICAgd2lkdGg6IDMyMHB4OwogICAgei1pbmRleDogMTA7Cn0KCi5ib3R0b20tY2VudGVyIHsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIGJvdHRvbTogMjBweDsKICAgIGxlZnQ6IDUwJTsKICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsKICAgIHdpZHRoOiA0MDBweDsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIHotaW5kZXg6IDEwOwogICAgcGFkZGluZzogMTVweCAyNXB4Owp9CgovKiBDb250cm9scyAqLwpidXR0b24gewogICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzRhOTBlMiAwJSwgIzM1N2FiZCAxMDAlKTsKICAgIGNvbG9yOiB3aGl0ZTsKICAgIGJvcmRlcjogbm9uZTsKICAgIHBhZGRpbmc6IDEwcHggMThweDsKICAgIGJvcmRlci1yYWRpdXM6IDhweDsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICBmb250LXNpemU6IDAuOXJlbTsKICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7CiAgICBib3gtc2hhZG93OiAwIDRweCAxNXB4IHJnYmEoNzQsIDE0NCwgMjI2LCAwLjMpOwogICAgd2lkdGg6IDEwMCU7CiAgICBtYXJnaW4tYm90dG9tOiA4cHg7CiAgICB0ZXh0LXNoYWRvdzogMCAxcHggMnB4IHJnYmEoMCwwLDAsMC4yKTsKfQoKYnV0dG9uOmhvdmVyIHsKICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMXB4KTsKICAgIGJveC1zaGFkb3c6IDAgNnB4IDIwcHggcmdiYSg3NCwgMTQ0LCAyMjYsIDAuNCk7CiAgICBmaWx0ZXI6IGJyaWdodG5lc3MoMS4xKTsKfQoKYnV0dG9uOmFjdGl2ZSB7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMXB4KTsKICAgIGJveC1zaGFkb3c6IDAgMnB4IDEwcHggcmdiYSg3NCwgMTQ0LCAyMjYsIDAuMik7Cn0KCmJ1dHRvbjpkaXNhYmxlZCB7CiAgICBiYWNrZ3JvdW5kOiAjNDQ0OwogICAgY29sb3I6ICM4ODg7CiAgICBjdXJzb3I6IG5vdC1hbGxvd2VkOwogICAgYm94LXNoYWRvdzogbm9uZTsKICAgIHRyYW5zZm9ybTogbm9uZTsKfQoKLnNlY29uZGFyeSB7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSk7CiAgICBib3gtc2hhZG93OiBub25lOwp9Cgouc2Vjb25kYXJ5OmhvdmVyIHsKICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTsKfQoKLyogSW5wdXRzICovCiNnZW4tcHJvbXB0IHsKICAgIHdpZHRoOiAxMDAlOwogICAgaGVpZ2h0OiA4MHB4OwogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjQpOwogICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpOwogICAgYm9yZGVyLXJhZGl1czogOHB4OwogICAgY29sb3I6IHdoaXRlOwogICAgcGFkZGluZzogMTJweDsKICAgIG1hcmdpbi1ib3R0b206IDEycHg7CiAgICByZXNpemU6IG5vbmU7CiAgICBmb250LWZhbWlseTogaW5oZXJpdDsKICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgICB0cmFuc2l0aW9uOiBib3JkZXItY29sb3IgMC4yczsKfQoKI2dlbi1wcm9tcHQ6Zm9jdXMgewogICAgb3V0bGluZTogbm9uZTsKICAgIGJvcmRlci1jb2xvcjogIzRhOTBlMjsKICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC42KTsKfQoKLyogQW5pbWF0aW9uIExpc3QgKi8KLnNjcm9sbGFibGUtbGlzdCB7CiAgICBmbGV4OiAxOwogICAgb3ZlcmZsb3cteTogYXV0bzsKICAgIG1hcmdpbi10b3A6IDEwcHg7CiAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDUpOwogICAgYm9yZGVyLXJhZGl1czogOHB4OwogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjIpOwogICAgbWF4LWhlaWdodDogMzAwcHg7Cn0KCi5zY3JvbGxhYmxlLWxpc3Q6Oi13ZWJraXQtc2Nyb2xsYmFyIHsKICAgIHdpZHRoOiA2cHg7Cn0KCi5zY3JvbGxhYmxlLWxpc3Q6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHsKICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTsKICAgIGJvcmRlci1yYWRpdXM6IDNweDsKfQoKLmFuaW0taXRlbSB7CiAgICBwYWRkaW5nOiAxMHB4IDE0cHg7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjA1KTsKICAgIHRleHQtYWxpZ246IGxlZnQ7CiAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIDAuMnM7CiAgICBmb250LXNpemU6IDAuOXJlbTsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwp9CgouYW5pbS1pdGVtOmhvdmVyIHsKICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTsKfQoKLmFuaW0taXRlbS5hY3RpdmUgewogICAgYmFja2dyb3VuZDogcmdiYSg3NCwgMTQ0LCAyMjYsIDAuMik7CiAgICBjb2xvcjogIzRhOTBlMjsKICAgIGJvcmRlci1sZWZ0OiAzcHggc29saWQgIzRhOTBlMjsKfQoKLyogUGxheWJhY2sgQ29udHJvbHMgKi8KLmNvbnRyb2wtcm93IHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgZ2FwOiAxNXB4OwogICAgd2lkdGg6IDEwMCU7Cn0KCi5pY29uLWJ0biB7CiAgICB3aWR0aDogNDBweDsKICAgIGhlaWdodDogNDBweDsKICAgIHBhZGRpbmc6IDA7CiAgICBkaXNwbGF5OiBmbGV4OwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgZm9udC1zaXplOiAxLjJyZW07CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICBtYXJnaW4tYm90dG9tOiAwOwp9CgojYW5pbS1zbGlkZXIgewogICAgZmxleDogMTsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIGhlaWdodDogNHB4OwogICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjIpOwogICAgYm9yZGVyLXJhZGl1czogMnB4OwogICAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lOwp9CgojYW5pbS1zbGlkZXI6Oi13ZWJraXQtc2xpZGVyLXRodW1iIHsKICAgIC13ZWJraXQtYXBwZWFyYW5jZTogbm9uZTsKICAgIHdpZHRoOiAxNnB4OwogICAgaGVpZ2h0OiAxNnB4OwogICAgYmFja2dyb3VuZDogIzRhOTBlMjsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIGJveC1zaGFkb3c6IDAgMCAxMHB4IHJnYmEoNzQsIDE0NCwgMjI2LCAwLjUpOwogICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMXM7Cn0KCiNhbmltLXNsaWRlcjo6LXdlYmtpdC1zbGlkZXItdGh1bWI6aG92ZXIgewogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjIpOwp9CgoudGltZS1kaXNwbGF5IHsKICAgIGZvbnQtZmFtaWx5OiAnUm9ib3RvIE1vbm8nLCBtb25vc3BhY2U7CiAgICBmb250LXNpemU6IDAuODVyZW07CiAgICBtaW4td2lkdGg6IDQ1cHg7CiAgICBjb2xvcjogI2FhYTsKfQoKLyogTW9kYWwgKi8KLm1vZGFsIHsKICAgIGRpc3BsYXk6IG5vbmU7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICB0b3A6IDA7CiAgICBsZWZ0OiAwOwogICAgd2lkdGg6IDEwMCU7CiAgICBoZWlnaHQ6IDEwMCU7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuODUpOwogICAgei1pbmRleDogMjAwMDA7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoOHB4KTsKfQoKLm1vZGFsLWNvbnRlbnQgewogICAgYmFja2dyb3VuZDogIzIyMjsKICAgIHBhZGRpbmc6IDMwcHg7CiAgICBib3JkZXItcmFkaXVzOiAxNnB4OwogICAgd2lkdGg6IDkwJTsKICAgIG1heC13aWR0aDogNDAwcHg7CiAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSk7CiAgICBib3gtc2hhZG93OiAwIDIwcHggNTBweCByZ2JhKDAsMCwwLDAuNik7Cn0KCi5pbnB1dC1ncm91cCBpbnB1dCwKLmlucHV0LWdyb3VwIHRleHRhcmVhIHsKICAgIHdpZHRoOiAxMDAlOwogICAgcGFkZGluZzogMTJweDsKICAgIGJhY2tncm91bmQ6ICMxNTE1MTU7CiAgICBib3JkZXI6IDFweCBzb2xpZCAjMzMzOwogICAgYm9yZGVyLXJhZGl1czogNnB4OwogICAgY29sb3I6IHdoaXRlOwogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsKICAgIGZvbnQtc2l6ZTogMXJlbTsKICAgIGZvbnQtZmFtaWx5OiAnU2Vnb2UgVUknLCBSb2JvdG8sIEhlbHZldGljYSwgQXJpYWwsIHNhbnMtc2VyaWY7Cn0KCi5pbnB1dC1ncm91cCBpbnB1dDpmb2N1cywKLmlucHV0LWdyb3VwIHRleHRhcmVhOmZvY3VzIHsKICAgIGJvcmRlci1jb2xvcjogIzRhOTBlMjsKICAgIG91dGxpbmU6IG5vbmU7Cn0KCi5tb2RhbC1hY3Rpb25zIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kOwogICAgZ2FwOiAxMnB4OwogICAgbWFyZ2luLXRvcDogMjBweDsKfQoKLm1vZGFsLWFjdGlvbnMgYnV0dG9uIHsKICAgIHdpZHRoOiBhdXRvOwogICAgbWFyZ2luLWJvdHRvbTogMDsKfQoKLyogTG9hZGluZyBTY3JlZW4gKi8KI2xvYWRpbmctb3ZlcmxheSB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB0b3A6IDA7CiAgICBsZWZ0OiAwOwogICAgd2lkdGg6IDEwMCU7CiAgICBoZWlnaHQ6IDEwMCU7CiAgICBiYWNrZ3JvdW5kOiAjMDAwOwogICAgZGlzcGxheTogZmxleDsKICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICB6LWluZGV4OiA5OTk5Owp9Cgouc3Bpbm5lciB7CiAgICB3aWR0aDogNTBweDsKICAgIGhlaWdodDogNTBweDsKICAgIGJvcmRlcjogNHB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIGJvcmRlci10b3AtY29sb3I6ICM0YTkwZTI7CiAgICBhbmltYXRpb246IHNwaW4gMC44cyBlYXNlLWluLW91dCBpbmZpbml0ZTsKICAgIG1hcmdpbi1ib3R0b206IDIwcHg7Cn0KCiNsb2FkaW5nLXRleHQgewogICAgZm9udC1zaXplOiAxLjFyZW07CiAgICBsZXR0ZXItc3BhY2luZzogMXB4OwogICAgY29sb3I6ICNjY2M7Cn0KCkBrZXlmcmFtZXMgc3BpbiB7CiAgICB0byB7IHRyYW5zZm9ybTogcm90YXRlKDM2MGRlZyk7IH0KfQoKLyogRHJhZyBBY3RpdmUgKi8KYm9keS5kcmFnLWFjdGl2ZTo6YWZ0ZXIgewogICAgY29udGVudDogIkRyb3AgR0xCIEZpbGUgSGVyZSI7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB0b3A6IDIwcHg7CiAgICBsZWZ0OiAyMHB4OwogICAgcmlnaHQ6IDIwcHg7CiAgICBib3R0b206IDIwcHg7CiAgICBib3JkZXI6IDRweCBkYXNoZWQgIzRhOTBlMjsKICAgIGJvcmRlci1yYWRpdXM6IDIwcHg7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuOCk7CiAgICB6LWluZGV4OiAxMDAwMDsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICBmb250LXNpemU6IDJyZW07CiAgICBmb250LXdlaWdodDogYm9sZDsKICAgIGNvbG9yOiAjNGE5MGUyOwogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDVweCk7CiAgICBwb2ludGVyLWV2ZW50czogbm9uZTsKfQoKLyogLS0tIE1vYmlsZSBSZXNwb25zaXZlbmVzcyAtLS0gKi8KQG1lZGlhIChtYXgtd2lkdGg6IDc2OHB4KSB7CiAgICAucGFuZWwgewogICAgICAgIHBhZGRpbmc6IDE1cHg7CiAgICAgICAgYm9yZGVyLXJhZGl1czogMTJweDsKICAgIH0KCiAgICAvKiBTdGFjayBldmVyeXRoaW5nIHZlcnRpY2FsbHkgb3IgdXNlIHNhZmUgem9uZXMgKi8KICAgIC50b3AtbGVmdCB7CiAgICAgICAgdG9wOiAxMHB4OwogICAgICAgIGxlZnQ6IDEwcHg7CiAgICAgICAgd2lkdGg6IGF1dG87CiAgICAgICAgcmlnaHQ6IGF1dG87CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBnYXA6IDEwcHg7CiAgICB9CiAgICAKICAgIC50b3AtbGVmdCBidXR0b24gewogICAgICAgIHdpZHRoOiBhdXRvOwogICAgICAgIHBhZGRpbmc6IDhweCAxMnB4OwogICAgICAgIGZvbnQtc2l6ZTogMC44cmVtOwogICAgICAgIG1hcmdpbi1ib3R0b206IDA7CiAgICB9CiAgICAKICAgIC50b3AtbGVmdCBoMyB7CiAgICAgICAgZGlzcGxheTogbm9uZTsgLyogSGlkZSB0aXRsZSBvbiBtb2JpbGUgdG8gc2F2ZSBzcGFjZSAqLwogICAgfQoKICAgIC50b3AtcmlnaHQgewogICAgICAgIHRvcDogNjBweDsgLyogQmVsb3cgdG9wLWxlZnQgYnV0dG9ucyAqLwogICAgICAgIGxlZnQ6IDEwcHg7CiAgICAgICAgcmlnaHQ6IGF1dG87CiAgICAgICAgd2lkdGg6IDE4MHB4OwogICAgICAgIG1heC1oZWlnaHQ6IDMwdmg7CiAgICB9CgogICAgLmJvdHRvbS1sZWZ0IHsKICAgICAgICBib3R0b206IDgwcHg7IC8qIEFib3ZlIGNvbnRyb2xzICovCiAgICAgICAgbGVmdDogMTBweDsKICAgICAgICByaWdodDogMTBweDsKICAgICAgICB3aWR0aDogYXV0bzsKICAgIH0KCiAgICAuYm90dG9tLWNlbnRlciB7CiAgICAgICAgYm90dG9tOiAxMHB4OwogICAgICAgIHdpZHRoOiA5NSU7CiAgICAgICAgcGFkZGluZzogMTBweDsKICAgIH0KCiAgICAjZ2VuLXByb21wdCB7CiAgICAgICAgaGVpZ2h0OiA1MHB4OwogICAgfQogICAgCiAgICAuY29udHJvbC1yb3cgewogICAgICAgIGdhcDogOHB4OwogICAgfQogICAgCiAgICAuaWNvbi1idG4gewogICAgICAgIHdpZHRoOiAzNnB4OwogICAgICAgIGhlaWdodDogMzZweDsKICAgIH0KfQ==","js/main.js":"data:text/javascript;base64,LyoqCiAqIE1haW4gRW50cnkgUG9pbnQgZm9yIEZsdXggQW5pbWF0b3IKICogSGFuZGxlcyBTY2VuZSBTZXR1cCwgUmVuZGVyaW5nIExvb3AsIGFuZCBXaW5kb3cgUmVzaXppbmcKICovCgovLyBOYW1lc3BhY2UgcmVnaXN0cmF0aW9uCndpbmRvdy5mbHV4ID0gd2luZG93LmZsdXggfHwge307CgooZnVuY3Rpb24oKSB7CiAgICAvLyAtLS0gUHJpdmF0ZSBNb2R1bGUgU2NvcGUgVmFyaWFibGVzIC0tLQogICAgLy8gKFVzaW5nIHVuZGVyc2NvcmUgcHJlZml4IGZvciBmaWxlLXNjb3BlZCB2YXJpYWJsZXMgdG8gYXZvaWQgY29sbGlzaW9ucyBpZiB3ZSB3ZXJlIGluIGdsb2JhbCwgCiAgICAvLyB0aG91Z2ggdGhpcyBJSUZFIHByb3RlY3RzIHRoZW0uIFdlIGF0dGFjaCBwdWJsaWMgQVBJIHRvIHdpbmRvdy5mbHV4KQogICAgCiAgICBsZXQgX3NjZW5lLCBfY2FtZXJhLCBfcmVuZGVyZXIsIF9jb250cm9sczsKICAgIGxldCBfY2xvY2s7CiAgICAKICAgIC8vIENvbmZpZ3VyYXRpb24gZm9yIHRoZSBlbnZpcm9ubWVudAogICAgY29uc3QgX2VudkNvbmZpZyA9IHsKICAgICAgICBiZ0NvbG9yOiAweDIyMjIyMiwKICAgICAgICBncmlkU2l6ZTogMjAsCiAgICAgICAgZ3JpZERpdmlzaW9uczogMjAKICAgIH07CgogICAgLyoqCiAgICAgKiBJbml0aWFsaXplIHRoZSAzRCBFbnZpcm9ubWVudAogICAgICovCiAgICBmdW5jdGlvbiBpbml0KCkgewogICAgICAgIGNvbnNvbGUubG9nKCJGbHV4OiBJbml0aWFsaXppbmcgQ29yZSBFbnZpcm9ubWVudC4uLiIpOwoKICAgICAgICAvLyAxLiBTY2VuZQogICAgICAgIF9zY2VuZSA9IG5ldyBUSFJFRS5TY2VuZSgpOwogICAgICAgIF9zY2VuZS5iYWNrZ3JvdW5kID0gbmV3IFRIUkVFLkNvbG9yKF9lbnZDb25maWcuYmdDb2xvcik7CiAgICAgICAgCiAgICAgICAgLy8gRm9nIGZvciBkZXB0aAogICAgICAgIF9zY2VuZS5mb2cgPSBuZXcgVEhSRUUuRm9nKF9lbnZDb25maWcuYmdDb2xvciwgMTAsIDUwKTsKCiAgICAgICAgLy8gMi4gQ2FtZXJhCiAgICAgICAgX2NhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSgKICAgICAgICAgICAgNjAsIC8vIEZPVgogICAgICAgICAgICB3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodCwgLy8gQXNwZWN0CiAgICAgICAgICAgIDAuMSwgLy8gTmVhcgogICAgICAgICAgICAxMDAwIC8vIEZhcgogICAgICAgICk7CiAgICAgICAgX2NhbWVyYS5wb3NpdGlvbi5zZXQoMCwgMS41LCAzKTsgLy8gU3RhbmRhcmQgY2hhcmFjdGVyIHZpZXdpbmcgaGVpZ2h0CgogICAgICAgIC8vIDMuIFJlbmRlcmVyCiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhcy1jb250YWluZXInKTsKICAgICAgICBfcmVuZGVyZXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcih7IGFudGlhbGlhczogdHJ1ZSB9KTsKICAgICAgICBfcmVuZGVyZXIuc2V0UGl4ZWxSYXRpbyh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyk7CiAgICAgICAgX3JlbmRlcmVyLnNldFNpemUod2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCk7CiAgICAgICAgX3JlbmRlcmVyLm91dHB1dEVuY29kaW5nID0gVEhSRUUuc1JHQkVuY29kaW5nOwogICAgICAgIF9yZW5kZXJlci5zaGFkb3dNYXAuZW5hYmxlZCA9IHRydWU7CiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKF9yZW5kZXJlci5kb21FbGVtZW50KTsKCiAgICAgICAgLy8gNC4gTGlnaHRzCiAgICAgICAgc2V0dXBMaWdodHMoKTsKCiAgICAgICAgLy8gNS4gSGVscGVycyAoR3JpZCkKICAgICAgICBjb25zdCBncmlkSGVscGVyID0gbmV3IFRIUkVFLkdyaWRIZWxwZXIoX2VudkNvbmZpZy5ncmlkU2l6ZSwgX2VudkNvbmZpZy5ncmlkRGl2aXNpb25zLCAweDQ0NDQ0NCwgMHgzMzMzMzMpOwogICAgICAgIF9zY2VuZS5hZGQoZ3JpZEhlbHBlcik7CgogICAgICAgIC8vIDYuIENvbnRyb2xzCiAgICAgICAgX2NvbnRyb2xzID0gbmV3IFRIUkVFLk9yYml0Q29udHJvbHMoX2NhbWVyYSwgX3JlbmRlcmVyLmRvbUVsZW1lbnQpOwogICAgICAgIF9jb250cm9scy5lbmFibGVEYW1waW5nID0gdHJ1ZTsKICAgICAgICBfY29udHJvbHMuZGFtcGluZ0ZhY3RvciA9IDAuMDU7CiAgICAgICAgX2NvbnRyb2xzLnRhcmdldC5zZXQoMCwgMSwgMCk7IC8vIExvb2sgYXQgcm91Z2hseSBjaGVzdCBoZWlnaHQgb2YgYSBjaGFyYWN0ZXIKICAgICAgICBfY29udHJvbHMudXBkYXRlKCk7CgogICAgICAgIC8vIDcuIENsb2NrCiAgICAgICAgX2Nsb2NrID0gbmV3IFRIUkVFLkNsb2NrKCk7CgogICAgICAgIC8vIDguIEV2ZW50IExpc3RlbmVycwogICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBvbldpbmRvd1Jlc2l6ZSwgZmFsc2UpOwoKICAgICAgICAvLyA5LiBFeHBvc2UgdG8gTmFtZXNwYWNlCiAgICAgICAgd2luZG93LmZsdXguc2NlbmUgPSBfc2NlbmU7CiAgICAgICAgd2luZG93LmZsdXguY2FtZXJhID0gX2NhbWVyYTsKICAgICAgICB3aW5kb3cuZmx1eC5yZW5kZXJlciA9IF9yZW5kZXJlcjsKICAgICAgICB3aW5kb3cuZmx1eC5jb250cm9scyA9IF9jb250cm9sczsKCi8vIFN0YXJ0IExvb3AKICAgICAgICBhbmltYXRlKCk7CiAgICAgICAgCiAgICAgICAgLy8gSW5pdGlhbGl6ZSBMb2FkZXIgU2VydmljZQogICAgICAgIGlmICh3aW5kb3cuZmx1eC5sb2FkZXIpIHsKICAgICAgICAgICAgd2luZG93LmZsdXgubG9hZGVyLmluaXQoKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gSGlkZSBMb2FkZXIKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmctb3ZlcmxheScpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1aS1sYXllcicpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgIH0sIDUwMCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXR1cCBMaWdodGluZyBFbnZpcm9ubWVudAogICAgICovCiAgICBmdW5jdGlvbiBzZXR1cExpZ2h0cygpIHsKICAgICAgICAvLyBIZW1pc3BoZXJlIExpZ2h0IChTa3kvR3JvdW5kIGFtYmllbnQpCiAgICAgICAgY29uc3QgaGVtaUxpZ2h0ID0gbmV3IFRIUkVFLkhlbWlzcGhlcmVMaWdodCgweGZmZmZmZiwgMHg0NDQ0NDQsIDAuNik7CiAgICAgICAgaGVtaUxpZ2h0LnBvc2l0aW9uLnNldCgwLCAyMCwgMCk7CiAgICAgICAgX3NjZW5lLmFkZChoZW1pTGlnaHQpOwoKICAgICAgICAvLyBEaXJlY3Rpb25hbCBMaWdodCAoU3VuL0tleSBsaWdodCkKICAgICAgICBjb25zdCBkaXJMaWdodCA9IG5ldyBUSFJFRS5EaXJlY3Rpb25hbExpZ2h0KDB4ZmZmZmZmLCAwLjgpOwogICAgICAgIGRpckxpZ2h0LnBvc2l0aW9uLnNldCgzLCAxMCwgMTApOwogICAgICAgIGRpckxpZ2h0LmNhc3RTaGFkb3cgPSB0cnVlOwogICAgICAgIGRpckxpZ2h0LnNoYWRvdy5jYW1lcmEudG9wID0gMjsKICAgICAgICBkaXJMaWdodC5zaGFkb3cuY2FtZXJhLmJvdHRvbSA9IC0yOwogICAgICAgIGRpckxpZ2h0LnNoYWRvdy5jYW1lcmEubGVmdCA9IC0yOwogICAgICAgIGRpckxpZ2h0LnNoYWRvdy5jYW1lcmEucmlnaHQgPSAyOwogICAgICAgIGRpckxpZ2h0LnNoYWRvdy5jYW1lcmEubmVhciA9IDAuMTsKICAgICAgICBkaXJMaWdodC5zaGFkb3cuY2FtZXJhLmZhciA9IDQwOwogICAgICAgIF9zY2VuZS5hZGQoZGlyTGlnaHQpOwogICAgfQoKICAgIC8qKgogICAgICogSGFuZGxlIFdpbmRvdyBSZXNpemUKICAgICAqLwogICAgZnVuY3Rpb24gb25XaW5kb3dSZXNpemUoKSB7CiAgICAgICAgaWYgKCFfY2FtZXJhIHx8ICFfcmVuZGVyZXIpIHJldHVybjsKICAgICAgICAKICAgICAgICBfY2FtZXJhLmFzcGVjdCA9IHdpbmRvdy5pbm5lcldpZHRoIC8gd2luZG93LmlubmVySGVpZ2h0OwogICAgICAgIF9jYW1lcmEudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpOwogICAgICAgIF9yZW5kZXJlci5zZXRTaXplKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpOwogICAgfQoKICAgIC8qKgogICAgICogTWFpbiBBbmltYXRpb24gTG9vcAogICAgICovCiAgICBmdW5jdGlvbiBhbmltYXRlKCkgewogICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlKTsKCiAgICAgICAgY29uc3QgZGVsdGEgPSBfY2xvY2suZ2V0RGVsdGEoKTsKCiAgICAgICAgaWYgKF9jb250cm9scykgX2NvbnRyb2xzLnVwZGF0ZSgpOwoKLy8gUGxhY2Vob2xkZXIgZm9yIG1peGVyIHVwZGF0ZXMgbGF0ZXIKICAgICAgICBpZiAod2luZG93LmZsdXgubWl4ZXJzKSB7CiAgICAgICAgICAgIHdpbmRvdy5mbHV4Lm1peGVycy5mb3JFYWNoKG1peGVyID0+IG1peGVyLnVwZGF0ZShkZWx0YSkpOwogICAgICAgIH0KCiAgICAgICAgLy8gVXBkYXRlIFVJCiAgICAgICAgaWYgKHdpbmRvdy5mbHV4LnVpKSB7CiAgICAgICAgICAgIHdpbmRvdy5mbHV4LnVpLnVwZGF0ZSgpOwogICAgICAgIH0KCiAgICAgICAgX3JlbmRlcmVyLnJlbmRlcihfc2NlbmUsIF9jYW1lcmEpOwogICAgfQoKICAgIC8vIEJvb3QKICAgIGluaXQoKTsKCn0pKCk7","./js/main.js":"data:text/javascript;base64,LyoqCiAqIE1haW4gRW50cnkgUG9pbnQgZm9yIEZsdXggQW5pbWF0b3IKICogSGFuZGxlcyBTY2VuZSBTZXR1cCwgUmVuZGVyaW5nIExvb3AsIGFuZCBXaW5kb3cgUmVzaXppbmcKICovCgovLyBOYW1lc3BhY2UgcmVnaXN0cmF0aW9uCndpbmRvdy5mbHV4ID0gd2luZG93LmZsdXggfHwge307CgooZnVuY3Rpb24oKSB7CiAgICAvLyAtLS0gUHJpdmF0ZSBNb2R1bGUgU2NvcGUgVmFyaWFibGVzIC0tLQogICAgLy8gKFVzaW5nIHVuZGVyc2NvcmUgcHJlZml4IGZvciBmaWxlLXNjb3BlZCB2YXJpYWJsZXMgdG8gYXZvaWQgY29sbGlzaW9ucyBpZiB3ZSB3ZXJlIGluIGdsb2JhbCwgCiAgICAvLyB0aG91Z2ggdGhpcyBJSUZFIHByb3RlY3RzIHRoZW0uIFdlIGF0dGFjaCBwdWJsaWMgQVBJIHRvIHdpbmRvdy5mbHV4KQogICAgCiAgICBsZXQgX3NjZW5lLCBfY2FtZXJhLCBfcmVuZGVyZXIsIF9jb250cm9sczsKICAgIGxldCBfY2xvY2s7CiAgICAKICAgIC8vIENvbmZpZ3VyYXRpb24gZm9yIHRoZSBlbnZpcm9ubWVudAogICAgY29uc3QgX2VudkNvbmZpZyA9IHsKICAgICAgICBiZ0NvbG9yOiAweDIyMjIyMiwKICAgICAgICBncmlkU2l6ZTogMjAsCiAgICAgICAgZ3JpZERpdmlzaW9uczogMjAKICAgIH07CgogICAgLyoqCiAgICAgKiBJbml0aWFsaXplIHRoZSAzRCBFbnZpcm9ubWVudAogICAgICovCiAgICBmdW5jdGlvbiBpbml0KCkgewogICAgICAgIGNvbnNvbGUubG9nKCJGbHV4OiBJbml0aWFsaXppbmcgQ29yZSBFbnZpcm9ubWVudC4uLiIpOwoKICAgICAgICAvLyAxLiBTY2VuZQogICAgICAgIF9zY2VuZSA9IG5ldyBUSFJFRS5TY2VuZSgpOwogICAgICAgIF9zY2VuZS5iYWNrZ3JvdW5kID0gbmV3IFRIUkVFLkNvbG9yKF9lbnZDb25maWcuYmdDb2xvcik7CiAgICAgICAgCiAgICAgICAgLy8gRm9nIGZvciBkZXB0aAogICAgICAgIF9zY2VuZS5mb2cgPSBuZXcgVEhSRUUuRm9nKF9lbnZDb25maWcuYmdDb2xvciwgMTAsIDUwKTsKCiAgICAgICAgLy8gMi4gQ2FtZXJhCiAgICAgICAgX2NhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSgKICAgICAgICAgICAgNjAsIC8vIEZPVgogICAgICAgICAgICB3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodCwgLy8gQXNwZWN0CiAgICAgICAgICAgIDAuMSwgLy8gTmVhcgogICAgICAgICAgICAxMDAwIC8vIEZhcgogICAgICAgICk7CiAgICAgICAgX2NhbWVyYS5wb3NpdGlvbi5zZXQoMCwgMS41LCAzKTsgLy8gU3RhbmRhcmQgY2hhcmFjdGVyIHZpZXdpbmcgaGVpZ2h0CgogICAgICAgIC8vIDMuIFJlbmRlcmVyCiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhcy1jb250YWluZXInKTsKICAgICAgICBfcmVuZGVyZXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcih7IGFudGlhbGlhczogdHJ1ZSB9KTsKICAgICAgICBfcmVuZGVyZXIuc2V0UGl4ZWxSYXRpbyh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyk7CiAgICAgICAgX3JlbmRlcmVyLnNldFNpemUod2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCk7CiAgICAgICAgX3JlbmRlcmVyLm91dHB1dEVuY29kaW5nID0gVEhSRUUuc1JHQkVuY29kaW5nOwogICAgICAgIF9yZW5kZXJlci5zaGFkb3dNYXAuZW5hYmxlZCA9IHRydWU7CiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKF9yZW5kZXJlci5kb21FbGVtZW50KTsKCiAgICAgICAgLy8gNC4gTGlnaHRzCiAgICAgICAgc2V0dXBMaWdodHMoKTsKCiAgICAgICAgLy8gNS4gSGVscGVycyAoR3JpZCkKICAgICAgICBjb25zdCBncmlkSGVscGVyID0gbmV3IFRIUkVFLkdyaWRIZWxwZXIoX2VudkNvbmZpZy5ncmlkU2l6ZSwgX2VudkNvbmZpZy5ncmlkRGl2aXNpb25zLCAweDQ0NDQ0NCwgMHgzMzMzMzMpOwogICAgICAgIF9zY2VuZS5hZGQoZ3JpZEhlbHBlcik7CgogICAgICAgIC8vIDYuIENvbnRyb2xzCiAgICAgICAgX2NvbnRyb2xzID0gbmV3IFRIUkVFLk9yYml0Q29udHJvbHMoX2NhbWVyYSwgX3JlbmRlcmVyLmRvbUVsZW1lbnQpOwogICAgICAgIF9jb250cm9scy5lbmFibGVEYW1waW5nID0gdHJ1ZTsKICAgICAgICBfY29udHJvbHMuZGFtcGluZ0ZhY3RvciA9IDAuMDU7CiAgICAgICAgX2NvbnRyb2xzLnRhcmdldC5zZXQoMCwgMSwgMCk7IC8vIExvb2sgYXQgcm91Z2hseSBjaGVzdCBoZWlnaHQgb2YgYSBjaGFyYWN0ZXIKICAgICAgICBfY29udHJvbHMudXBkYXRlKCk7CgogICAgICAgIC8vIDcuIENsb2NrCiAgICAgICAgX2Nsb2NrID0gbmV3IFRIUkVFLkNsb2NrKCk7CgogICAgICAgIC8vIDguIEV2ZW50IExpc3RlbmVycwogICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBvbldpbmRvd1Jlc2l6ZSwgZmFsc2UpOwoKICAgICAgICAvLyA5LiBFeHBvc2UgdG8gTmFtZXNwYWNlCiAgICAgICAgd2luZG93LmZsdXguc2NlbmUgPSBfc2NlbmU7CiAgICAgICAgd2luZG93LmZsdXguY2FtZXJhID0gX2NhbWVyYTsKICAgICAgICB3aW5kb3cuZmx1eC5yZW5kZXJlciA9IF9yZW5kZXJlcjsKICAgICAgICB3aW5kb3cuZmx1eC5jb250cm9scyA9IF9jb250cm9sczsKCi8vIFN0YXJ0IExvb3AKICAgICAgICBhbmltYXRlKCk7CiAgICAgICAgCiAgICAgICAgLy8gSW5pdGlhbGl6ZSBMb2FkZXIgU2VydmljZQogICAgICAgIGlmICh3aW5kb3cuZmx1eC5sb2FkZXIpIHsKICAgICAgICAgICAgd2luZG93LmZsdXgubG9hZGVyLmluaXQoKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gSGlkZSBMb2FkZXIKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmctb3ZlcmxheScpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1aS1sYXllcicpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgIH0sIDUwMCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXR1cCBMaWdodGluZyBFbnZpcm9ubWVudAogICAgICovCiAgICBmdW5jdGlvbiBzZXR1cExpZ2h0cygpIHsKICAgICAgICAvLyBIZW1pc3BoZXJlIExpZ2h0IChTa3kvR3JvdW5kIGFtYmllbnQpCiAgICAgICAgY29uc3QgaGVtaUxpZ2h0ID0gbmV3IFRIUkVFLkhlbWlzcGhlcmVMaWdodCgweGZmZmZmZiwgMHg0NDQ0NDQsIDAuNik7CiAgICAgICAgaGVtaUxpZ2h0LnBvc2l0aW9uLnNldCgwLCAyMCwgMCk7CiAgICAgICAgX3NjZW5lLmFkZChoZW1pTGlnaHQpOwoKICAgICAgICAvLyBEaXJlY3Rpb25hbCBMaWdodCAoU3VuL0tleSBsaWdodCkKICAgICAgICBjb25zdCBkaXJMaWdodCA9IG5ldyBUSFJFRS5EaXJlY3Rpb25hbExpZ2h0KDB4ZmZmZmZmLCAwLjgpOwogICAgICAgIGRpckxpZ2h0LnBvc2l0aW9uLnNldCgzLCAxMCwgMTApOwogICAgICAgIGRpckxpZ2h0LmNhc3RTaGFkb3cgPSB0cnVlOwogICAgICAgIGRpckxpZ2h0LnNoYWRvdy5jYW1lcmEudG9wID0gMjsKICAgICAgICBkaXJMaWdodC5zaGFkb3cuY2FtZXJhLmJvdHRvbSA9IC0yOwogICAgICAgIGRpckxpZ2h0LnNoYWRvdy5jYW1lcmEubGVmdCA9IC0yOwogICAgICAgIGRpckxpZ2h0LnNoYWRvdy5jYW1lcmEucmlnaHQgPSAyOwogICAgICAgIGRpckxpZ2h0LnNoYWRvdy5jYW1lcmEubmVhciA9IDAuMTsKICAgICAgICBkaXJMaWdodC5zaGFkb3cuY2FtZXJhLmZhciA9IDQwOwogICAgICAgIF9zY2VuZS5hZGQoZGlyTGlnaHQpOwogICAgfQoKICAgIC8qKgogICAgICogSGFuZGxlIFdpbmRvdyBSZXNpemUKICAgICAqLwogICAgZnVuY3Rpb24gb25XaW5kb3dSZXNpemUoKSB7CiAgICAgICAgaWYgKCFfY2FtZXJhIHx8ICFfcmVuZGVyZXIpIHJldHVybjsKICAgICAgICAKICAgICAgICBfY2FtZXJhLmFzcGVjdCA9IHdpbmRvdy5pbm5lcldpZHRoIC8gd2luZG93LmlubmVySGVpZ2h0OwogICAgICAgIF9jYW1lcmEudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpOwogICAgICAgIF9yZW5kZXJlci5zZXRTaXplKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpOwogICAgfQoKICAgIC8qKgogICAgICogTWFpbiBBbmltYXRpb24gTG9vcAogICAgICovCiAgICBmdW5jdGlvbiBhbmltYXRlKCkgewogICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlKTsKCiAgICAgICAgY29uc3QgZGVsdGEgPSBfY2xvY2suZ2V0RGVsdGEoKTsKCiAgICAgICAgaWYgKF9jb250cm9scykgX2NvbnRyb2xzLnVwZGF0ZSgpOwoKLy8gUGxhY2Vob2xkZXIgZm9yIG1peGVyIHVwZGF0ZXMgbGF0ZXIKICAgICAgICBpZiAod2luZG93LmZsdXgubWl4ZXJzKSB7CiAgICAgICAgICAgIHdpbmRvdy5mbHV4Lm1peGVycy5mb3JFYWNoKG1peGVyID0+IG1peGVyLnVwZGF0ZShkZWx0YSkpOwogICAgICAgIH0KCiAgICAgICAgLy8gVXBkYXRlIFVJCiAgICAgICAgaWYgKHdpbmRvdy5mbHV4LnVpKSB7CiAgICAgICAgICAgIHdpbmRvdy5mbHV4LnVpLnVwZGF0ZSgpOwogICAgICAgIH0KCiAgICAgICAgX3JlbmRlcmVyLnJlbmRlcihfc2NlbmUsIF9jYW1lcmEpOwogICAgfQoKICAgIC8vIEJvb3QKICAgIGluaXQoKTsKCn0pKCk7","/js/main.js":"data:text/javascript;base64,LyoqCiAqIE1haW4gRW50cnkgUG9pbnQgZm9yIEZsdXggQW5pbWF0b3IKICogSGFuZGxlcyBTY2VuZSBTZXR1cCwgUmVuZGVyaW5nIExvb3AsIGFuZCBXaW5kb3cgUmVzaXppbmcKICovCgovLyBOYW1lc3BhY2UgcmVnaXN0cmF0aW9uCndpbmRvdy5mbHV4ID0gd2luZG93LmZsdXggfHwge307CgooZnVuY3Rpb24oKSB7CiAgICAvLyAtLS0gUHJpdmF0ZSBNb2R1bGUgU2NvcGUgVmFyaWFibGVzIC0tLQogICAgLy8gKFVzaW5nIHVuZGVyc2NvcmUgcHJlZml4IGZvciBmaWxlLXNjb3BlZCB2YXJpYWJsZXMgdG8gYXZvaWQgY29sbGlzaW9ucyBpZiB3ZSB3ZXJlIGluIGdsb2JhbCwgCiAgICAvLyB0aG91Z2ggdGhpcyBJSUZFIHByb3RlY3RzIHRoZW0uIFdlIGF0dGFjaCBwdWJsaWMgQVBJIHRvIHdpbmRvdy5mbHV4KQogICAgCiAgICBsZXQgX3NjZW5lLCBfY2FtZXJhLCBfcmVuZGVyZXIsIF9jb250cm9sczsKICAgIGxldCBfY2xvY2s7CiAgICAKICAgIC8vIENvbmZpZ3VyYXRpb24gZm9yIHRoZSBlbnZpcm9ubWVudAogICAgY29uc3QgX2VudkNvbmZpZyA9IHsKICAgICAgICBiZ0NvbG9yOiAweDIyMjIyMiwKICAgICAgICBncmlkU2l6ZTogMjAsCiAgICAgICAgZ3JpZERpdmlzaW9uczogMjAKICAgIH07CgogICAgLyoqCiAgICAgKiBJbml0aWFsaXplIHRoZSAzRCBFbnZpcm9ubWVudAogICAgICovCiAgICBmdW5jdGlvbiBpbml0KCkgewogICAgICAgIGNvbnNvbGUubG9nKCJGbHV4OiBJbml0aWFsaXppbmcgQ29yZSBFbnZpcm9ubWVudC4uLiIpOwoKICAgICAgICAvLyAxLiBTY2VuZQogICAgICAgIF9zY2VuZSA9IG5ldyBUSFJFRS5TY2VuZSgpOwogICAgICAgIF9zY2VuZS5iYWNrZ3JvdW5kID0gbmV3IFRIUkVFLkNvbG9yKF9lbnZDb25maWcuYmdDb2xvcik7CiAgICAgICAgCiAgICAgICAgLy8gRm9nIGZvciBkZXB0aAogICAgICAgIF9zY2VuZS5mb2cgPSBuZXcgVEhSRUUuRm9nKF9lbnZDb25maWcuYmdDb2xvciwgMTAsIDUwKTsKCiAgICAgICAgLy8gMi4gQ2FtZXJhCiAgICAgICAgX2NhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSgKICAgICAgICAgICAgNjAsIC8vIEZPVgogICAgICAgICAgICB3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodCwgLy8gQXNwZWN0CiAgICAgICAgICAgIDAuMSwgLy8gTmVhcgogICAgICAgICAgICAxMDAwIC8vIEZhcgogICAgICAgICk7CiAgICAgICAgX2NhbWVyYS5wb3NpdGlvbi5zZXQoMCwgMS41LCAzKTsgLy8gU3RhbmRhcmQgY2hhcmFjdGVyIHZpZXdpbmcgaGVpZ2h0CgogICAgICAgIC8vIDMuIFJlbmRlcmVyCiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhcy1jb250YWluZXInKTsKICAgICAgICBfcmVuZGVyZXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcih7IGFudGlhbGlhczogdHJ1ZSB9KTsKICAgICAgICBfcmVuZGVyZXIuc2V0UGl4ZWxSYXRpbyh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyk7CiAgICAgICAgX3JlbmRlcmVyLnNldFNpemUod2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCk7CiAgICAgICAgX3JlbmRlcmVyLm91dHB1dEVuY29kaW5nID0gVEhSRUUuc1JHQkVuY29kaW5nOwogICAgICAgIF9yZW5kZXJlci5zaGFkb3dNYXAuZW5hYmxlZCA9IHRydWU7CiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKF9yZW5kZXJlci5kb21FbGVtZW50KTsKCiAgICAgICAgLy8gNC4gTGlnaHRzCiAgICAgICAgc2V0dXBMaWdodHMoKTsKCiAgICAgICAgLy8gNS4gSGVscGVycyAoR3JpZCkKICAgICAgICBjb25zdCBncmlkSGVscGVyID0gbmV3IFRIUkVFLkdyaWRIZWxwZXIoX2VudkNvbmZpZy5ncmlkU2l6ZSwgX2VudkNvbmZpZy5ncmlkRGl2aXNpb25zLCAweDQ0NDQ0NCwgMHgzMzMzMzMpOwogICAgICAgIF9zY2VuZS5hZGQoZ3JpZEhlbHBlcik7CgogICAgICAgIC8vIDYuIENvbnRyb2xzCiAgICAgICAgX2NvbnRyb2xzID0gbmV3IFRIUkVFLk9yYml0Q29udHJvbHMoX2NhbWVyYSwgX3JlbmRlcmVyLmRvbUVsZW1lbnQpOwogICAgICAgIF9jb250cm9scy5lbmFibGVEYW1waW5nID0gdHJ1ZTsKICAgICAgICBfY29udHJvbHMuZGFtcGluZ0ZhY3RvciA9IDAuMDU7CiAgICAgICAgX2NvbnRyb2xzLnRhcmdldC5zZXQoMCwgMSwgMCk7IC8vIExvb2sgYXQgcm91Z2hseSBjaGVzdCBoZWlnaHQgb2YgYSBjaGFyYWN0ZXIKICAgICAgICBfY29udHJvbHMudXBkYXRlKCk7CgogICAgICAgIC8vIDcuIENsb2NrCiAgICAgICAgX2Nsb2NrID0gbmV3IFRIUkVFLkNsb2NrKCk7CgogICAgICAgIC8vIDguIEV2ZW50IExpc3RlbmVycwogICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBvbldpbmRvd1Jlc2l6ZSwgZmFsc2UpOwoKICAgICAgICAvLyA5LiBFeHBvc2UgdG8gTmFtZXNwYWNlCiAgICAgICAgd2luZG93LmZsdXguc2NlbmUgPSBfc2NlbmU7CiAgICAgICAgd2luZG93LmZsdXguY2FtZXJhID0gX2NhbWVyYTsKICAgICAgICB3aW5kb3cuZmx1eC5yZW5kZXJlciA9IF9yZW5kZXJlcjsKICAgICAgICB3aW5kb3cuZmx1eC5jb250cm9scyA9IF9jb250cm9sczsKCi8vIFN0YXJ0IExvb3AKICAgICAgICBhbmltYXRlKCk7CiAgICAgICAgCiAgICAgICAgLy8gSW5pdGlhbGl6ZSBMb2FkZXIgU2VydmljZQogICAgICAgIGlmICh3aW5kb3cuZmx1eC5sb2FkZXIpIHsKICAgICAgICAgICAgd2luZG93LmZsdXgubG9hZGVyLmluaXQoKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gSGlkZSBMb2FkZXIKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmctb3ZlcmxheScpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1aS1sYXllcicpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgIH0sIDUwMCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXR1cCBMaWdodGluZyBFbnZpcm9ubWVudAogICAgICovCiAgICBmdW5jdGlvbiBzZXR1cExpZ2h0cygpIHsKICAgICAgICAvLyBIZW1pc3BoZXJlIExpZ2h0IChTa3kvR3JvdW5kIGFtYmllbnQpCiAgICAgICAgY29uc3QgaGVtaUxpZ2h0ID0gbmV3IFRIUkVFLkhlbWlzcGhlcmVMaWdodCgweGZmZmZmZiwgMHg0NDQ0NDQsIDAuNik7CiAgICAgICAgaGVtaUxpZ2h0LnBvc2l0aW9uLnNldCgwLCAyMCwgMCk7CiAgICAgICAgX3NjZW5lLmFkZChoZW1pTGlnaHQpOwoKICAgICAgICAvLyBEaXJlY3Rpb25hbCBMaWdodCAoU3VuL0tleSBsaWdodCkKICAgICAgICBjb25zdCBkaXJMaWdodCA9IG5ldyBUSFJFRS5EaXJlY3Rpb25hbExpZ2h0KDB4ZmZmZmZmLCAwLjgpOwogICAgICAgIGRpckxpZ2h0LnBvc2l0aW9uLnNldCgzLCAxMCwgMTApOwogICAgICAgIGRpckxpZ2h0LmNhc3RTaGFkb3cgPSB0cnVlOwogICAgICAgIGRpckxpZ2h0LnNoYWRvdy5jYW1lcmEudG9wID0gMjsKICAgICAgICBkaXJMaWdodC5zaGFkb3cuY2FtZXJhLmJvdHRvbSA9IC0yOwogICAgICAgIGRpckxpZ2h0LnNoYWRvdy5jYW1lcmEubGVmdCA9IC0yOwogICAgICAgIGRpckxpZ2h0LnNoYWRvdy5jYW1lcmEucmlnaHQgPSAyOwogICAgICAgIGRpckxpZ2h0LnNoYWRvdy5jYW1lcmEubmVhciA9IDAuMTsKICAgICAgICBkaXJMaWdodC5zaGFkb3cuY2FtZXJhLmZhciA9IDQwOwogICAgICAgIF9zY2VuZS5hZGQoZGlyTGlnaHQpOwogICAgfQoKICAgIC8qKgogICAgICogSGFuZGxlIFdpbmRvdyBSZXNpemUKICAgICAqLwogICAgZnVuY3Rpb24gb25XaW5kb3dSZXNpemUoKSB7CiAgICAgICAgaWYgKCFfY2FtZXJhIHx8ICFfcmVuZGVyZXIpIHJldHVybjsKICAgICAgICAKICAgICAgICBfY2FtZXJhLmFzcGVjdCA9IHdpbmRvdy5pbm5lcldpZHRoIC8gd2luZG93LmlubmVySGVpZ2h0OwogICAgICAgIF9jYW1lcmEudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpOwogICAgICAgIF9yZW5kZXJlci5zZXRTaXplKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpOwogICAgfQoKICAgIC8qKgogICAgICogTWFpbiBBbmltYXRpb24gTG9vcAogICAgICovCiAgICBmdW5jdGlvbiBhbmltYXRlKCkgewogICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlKTsKCiAgICAgICAgY29uc3QgZGVsdGEgPSBfY2xvY2suZ2V0RGVsdGEoKTsKCiAgICAgICAgaWYgKF9jb250cm9scykgX2NvbnRyb2xzLnVwZGF0ZSgpOwoKLy8gUGxhY2Vob2xkZXIgZm9yIG1peGVyIHVwZGF0ZXMgbGF0ZXIKICAgICAgICBpZiAod2luZG93LmZsdXgubWl4ZXJzKSB7CiAgICAgICAgICAgIHdpbmRvdy5mbHV4Lm1peGVycy5mb3JFYWNoKG1peGVyID0+IG1peGVyLnVwZGF0ZShkZWx0YSkpOwogICAgICAgIH0KCiAgICAgICAgLy8gVXBkYXRlIFVJCiAgICAgICAgaWYgKHdpbmRvdy5mbHV4LnVpKSB7CiAgICAgICAgICAgIHdpbmRvdy5mbHV4LnVpLnVwZGF0ZSgpOwogICAgICAgIH0KCiAgICAgICAgX3JlbmRlcmVyLnJlbmRlcihfc2NlbmUsIF9jYW1lcmEpOwogICAgfQoKICAgIC8vIEJvb3QKICAgIGluaXQoKTsKCn0pKCk7","js/rig-manager.js":"data:text/javascript;base64,LyoqCiAqIFJpZ01hbmFnZXIKICogSGFuZGxlcyBTa2VsZXRvbiBBbmFseXNpcywgQm9uZSBNYXBwaW5nLCBhbmQgQW5pbWF0aW9uIE1peGluZwogKi8KCndpbmRvdy5mbHV4ID0gd2luZG93LmZsdXggfHwge307CgooZnVuY3Rpb24oKSB7CiAgICAvLyBTdGFuZGFyZCBNaXhhbW8gYm9uZSBuYW1lcyBmb3IgdmFsaWRhdGlvbi9tYXBwaW5nCiAgICBjb25zdCBfbWl4YW1vQm9uZXMgPSBbCiAgICAgICAgJ0hpcHMnLCAnU3BpbmUnLCAnU3BpbmUxJywgJ1NwaW5lMicsICdOZWNrJywgJ0hlYWQnLAogICAgICAgICdMZWZ0U2hvdWxkZXInLCAnTGVmdEFybScsICdMZWZ0Rm9yZUFybScsICdMZWZ0SGFuZCcsCiAgICAgICAgJ1JpZ2h0U2hvdWxkZXInLCAnUmlnaHRBcm0nLCAnUmlnaHRGb3JlQXJtJywgJ1JpZ2h0SGFuZCcsCiAgICAgICAgJ0xlZnRVcExlZycsICdMZWZ0TGVnJywgJ0xlZnRGb290JywKICAgICAgICAnUmlnaHRVcExlZycsICdSaWdodExlZycsICdSaWdodEZvb3QnCiAgICBdOwoKY2xhc3MgUmlnTWFuYWdlciB7CiAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICAgIHRoaXMubW9kZWwgPSBudWxsOwogICAgICAgICAgICB0aGlzLnNrZWxldG9uID0gbnVsbDsKICAgICAgICAgICAgdGhpcy5ib25lcyA9IHt9OyAvLyBNYXAgb2YgY2xlYW5OYW1lIC0+IEJvbmUgT2JqZWN0CiAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9ucyA9IFtdOwogICAgICAgICAgICB0aGlzLm1peGVyID0gbnVsbDsKICAgICAgICAgICAgdGhpcy5jdXJyZW50QWN0aW9uID0gbnVsbDsKICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEFuYWx5emUgYSBsb2FkZWQgbW9kZWwgZm9yIFJpZ2dpbmcgY2FwYWJpbGl0aWVzCiAgICAgICAgICogQHBhcmFtIHtUSFJFRS5PYmplY3QzRH0gbW9kZWwgCiAgICAgICAgICogQHBhcmFtIHtUSFJFRS5BbmltYXRpb25DbGlwW119IGFuaW1hdGlvbnMgCiAgICAgICAgICogQHJldHVybnMge2Jvb2xlYW59IGlzUmlnZ2VkCiAgICAgICAgICovCiAgICAgICAgYW5hbHl6ZShtb2RlbCwgYW5pbWF0aW9ucykgewogICAgICAgICAgICB0aGlzLnJlc2V0KCk7CiAgICAgICAgICAgIHRoaXMubW9kZWwgPSBtb2RlbDsKICAgICAgICAgICAgdGhpcy5hbmltYXRpb25zID0gYW5pbWF0aW9ucyB8fCBbXTsKCiAgICAgICAgICAgIC8vIDEuIEZpbmQgU2tpbm5lZE1lc2gKICAgICAgICAgICAgbGV0IHNraW5uZWRNZXNoID0gbnVsbDsKICAgICAgICAgICAgbW9kZWwudHJhdmVyc2UoKGNoaWxkKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoY2hpbGQuaXNTa2lubmVkTWVzaCAmJiAhc2tpbm5lZE1lc2gpIHsKICAgICAgICAgICAgICAgICAgICBza2lubmVkTWVzaCA9IGNoaWxkOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGlmICghc2tpbm5lZE1lc2gpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybigiUmlnTWFuYWdlcjogTm8gU2tpbm5lZE1lc2ggZm91bmQuIik7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMuc2tlbGV0b24gPSBza2lubmVkTWVzaC5za2VsZXRvbjsKICAgICAgICAgICAgY29uc29sZS5sb2coIlJpZ01hbmFnZXI6IFNrZWxldG9uIGRldGVjdGVkLiIsIHRoaXMuc2tlbGV0b24pOwoKICAgICAgICAgICAgLy8gMi4gTWFwIEJvbmVzCiAgICAgICAgICAgIHRoaXMubWFwQm9uZXMoKTsKCiAgICAgICAgICAgIC8vIDMuIFNldHVwIE1peGVyCiAgICAgICAgICAgIHRoaXMubWl4ZXIgPSBuZXcgVEhSRUUuQW5pbWF0aW9uTWl4ZXIodGhpcy5tb2RlbCk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBBZGQgdG8gZ2xvYmFsIG1peGVyIGxvb3AKICAgICAgICAgICAgaWYgKCF3aW5kb3cuZmx1eC5taXhlcnMpIHdpbmRvdy5mbHV4Lm1peGVycyA9IFtdOwogICAgICAgICAgICB3aW5kb3cuZmx1eC5taXhlcnMucHVzaCh0aGlzLm1peGVyKTsKCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgcmVzZXQoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLm1peGVyKSB7CiAgICAgICAgICAgICAgICB0aGlzLm1peGVyLnN0b3BBbGxBY3Rpb24oKTsKICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBmcm9tIGdsb2JhbCBsb29wCiAgICAgICAgICAgICAgICBpZiAod2luZG93LmZsdXgubWl4ZXJzKSB7CiAgICAgICAgICAgICAgICAgICAgd2luZG93LmZsdXgubWl4ZXJzID0gd2luZG93LmZsdXgubWl4ZXJzLmZpbHRlcihtID0+IG0gIT09IHRoaXMubWl4ZXIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMubW9kZWwgPSBudWxsOwogICAgICAgICAgICB0aGlzLnNrZWxldG9uID0gbnVsbDsKICAgICAgICAgICAgdGhpcy5ib25lcyA9IHt9OwogICAgICAgICAgICB0aGlzLmFuaW1hdGlvbnMgPSBbXTsKICAgICAgICAgICAgdGhpcy5taXhlciA9IG51bGw7CiAgICAgICAgICAgIHRoaXMuY3VycmVudEFjdGlvbiA9IG51bGw7CiAgICAgICAgICAgIHRoaXMuaXNQbGF5aW5nID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBtYXBCb25lcygpIHsKICAgICAgICAgICAgaWYgKCF0aGlzLnNrZWxldG9uKSByZXR1cm47CgogICAgICAgICAgICB0aGlzLnNrZWxldG9uLmJvbmVzLmZvckVhY2goYm9uZSA9PiB7CiAgICAgICAgICAgICAgICAvLyBOb3JtYWxpemUgbmFtZTogcmVtb3ZlICJNaXhhbW9yaWc6IiBwcmVmaXgsIHJlbW92ZSBzcGFjZXMvY29sb25zCiAgICAgICAgICAgICAgICBjb25zdCBjbGVhbk5hbWUgPSBib25lLm5hbWUucmVwbGFjZSgvTWl4YW1vcmlnOnw6L2csICcnKTsKICAgICAgICAgICAgICAgIHRoaXMuYm9uZXNbY2xlYW5OYW1lXSA9IGJvbmU7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogUGxheSBhbiBhbmltYXRpb24gYnkgaW5kZXggb3IgbmFtZQogICAgICAgICAqLwogICAgICAgIHBsYXlBbmltYXRpb24oaWRlbnRpZmllcikgewogICAgICAgICAgICBpZiAoIXRoaXMubWl4ZXIgfHwgdGhpcy5hbmltYXRpb25zLmxlbmd0aCA9PT0gMCkgcmV0dXJuOwoKICAgICAgICAgICAgbGV0IGNsaXAgPSBudWxsOwogICAgICAgICAgICBpZiAodHlwZW9mIGlkZW50aWZpZXIgPT09ICdudW1iZXInKSB7CiAgICAgICAgICAgICAgICBjbGlwID0gdGhpcy5hbmltYXRpb25zW2lkZW50aWZpZXJdOwogICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBpZGVudGlmaWVyID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAgICAgY2xpcCA9IHRoaXMuYW5pbWF0aW9ucy5maW5kKGEgPT4gYS5uYW1lID09PSBpZGVudGlmaWVyKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGNsaXApIHsKICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRBY3Rpb24pIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRBY3Rpb24uZmFkZU91dCgwLjIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29uc3QgYWN0aW9uID0gdGhpcy5taXhlci5jbGlwQWN0aW9uKGNsaXApOwogICAgICAgICAgICAgICAgYWN0aW9uLnJlc2V0KCk7CiAgICAgICAgICAgICAgICBhY3Rpb24uZmFkZUluKDAuMik7CiAgICAgICAgICAgICAgICBhY3Rpb24ucGxheSgpOwogICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50QWN0aW9uID0gYWN0aW9uOwogICAgICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFJpZ01hbmFnZXI6IFBsYXlpbmcgJHtjbGlwLm5hbWV9YCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHBhdXNlKCkgewogICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50QWN0aW9uKSB7CiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRBY3Rpb24ucGF1c2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHRoaXMuaXNQbGF5aW5nID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJlc3VtZSgpIHsKICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudEFjdGlvbikgewogICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50QWN0aW9uLnBhdXNlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBzdG9wKCkgewogICAgICAgICAgICBpZiAodGhpcy5taXhlcikgewogICAgICAgICAgICAgICAgdGhpcy5taXhlci5zdG9wQWxsQWN0aW9uKCk7CiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRBY3Rpb24gPSBudWxsOwogICAgICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogU2NydWIgYW5pbWF0aW9uIHRvIHNwZWNpZmljIG5vcm1hbGl6ZWQgdGltZSAoMC0xKQogICAgICAgICAqLwogICAgICAgIHNjcnViKHByb2dyZXNzKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRBY3Rpb24pIHsKICAgICAgICAgICAgICAgIGNvbnN0IGR1cmF0aW9uID0gdGhpcy5jdXJyZW50QWN0aW9uLmdldENsaXAoKS5kdXJhdGlvbjsKICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEFjdGlvbi50aW1lID0gZHVyYXRpb24gKiBwcm9ncmVzczsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZ2V0QW5pbWF0aW9uTGlzdCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuYW5pbWF0aW9ucy5tYXAoKGEsIGkpID0+ICh7IG5hbWU6IGEubmFtZSwgaW5kZXg6IGkgfSkpOwogICAgICAgIH0KCmdldFN0YXR1cygpIHsKICAgICAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRBY3Rpb24pIHJldHVybiB7IHBsYXlpbmc6IGZhbHNlLCB0aW1lOiAwLCBkdXJhdGlvbjogMCwgcHJvZ3Jlc3M6IDAgfTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbnN0IGNsaXAgPSB0aGlzLmN1cnJlbnRBY3Rpb24uZ2V0Q2xpcCgpOwogICAgICAgICAgICBjb25zdCBkdXJhdGlvbiA9IGNsaXAuZHVyYXRpb247CiAgICAgICAgICAgIGNvbnN0IHRpbWUgPSB0aGlzLmN1cnJlbnRBY3Rpb24udGltZTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBwbGF5aW5nOiAhdGhpcy5jdXJyZW50QWN0aW9uLnBhdXNlZCAmJiB0aGlzLmlzUGxheWluZywKICAgICAgICAgICAgICAgIHRpbWU6IHRpbWUgJSBkdXJhdGlvbiwKICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBkdXJhdGlvbiwKICAgICAgICAgICAgICAgIHByb2dyZXNzOiAodGltZSAlIGR1cmF0aW9uKSAvIGR1cmF0aW9uCiAgICAgICAgICAgIH07CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBHZXQgbGlzdCBvZiBib25lIG5hbWVzIGZvciBBSQogICAgICAgICAqLwogICAgICAgIGdldFNrZWxldG9uU3RydWN0dXJlKCkgewogICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5ib25lcyk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGUgQW5pbWF0aW9uQ2xpcCBmcm9tIEdlbWluaSBKU09OCiAgICAgICAgICovCmNyZWF0ZUFuaW1hdGlvbkZyb21KU09OKGRhdGEpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIlJpZ01hbmFnZXI6IFBhcnNpbmcgQUkgQW5pbWF0aW9uIERhdGEuLi4iLCBkYXRhKTsKCiAgICAgICAgICAgIGlmICghZGF0YS50cmFja3MgfHwgIUFycmF5LmlzQXJyYXkoZGF0YS50cmFja3MpKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCJSaWdNYW5hZ2VyOiBJbnZhbGlkIGFuaW1hdGlvbiBkYXRhIGZvcm1hdC4gJ3RyYWNrcycgYXJyYXkgbWlzc2luZy4iKTsKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zdCB0cmFja3MgPSBbXTsKICAgICAgICAgICAgLy8gVXNlIHByb3ZpZGVkIGR1cmF0aW9uIG9yIGNhbGN1bGF0ZSBtYXggdGltZQogICAgICAgICAgICBsZXQgbWF4VGltZSA9IDA7CgogICAgICAgICAgICBkYXRhLnRyYWNrcy5mb3JFYWNoKHRyYWNrRGF0YSA9PiB7CiAgICAgICAgICAgICAgICAvLyBGaW5kIHRoZSBhY3R1YWwgYm9uZSBvYmplY3QKICAgICAgICAgICAgICAgIGNvbnN0IGJvbmUgPSB0aGlzLmJvbmVzW3RyYWNrRGF0YS5ib25lXTsKICAgICAgICAgICAgICAgIGlmICghYm9uZSkgewogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUud2FybihgUmlnTWFuYWdlcjogQm9uZSAnJHt0cmFja0RhdGEuYm9uZX0nIG5vdCBmb3VuZCBpbiByaWcuIFNraXBwaW5nIHRyYWNrLmApOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsgCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY29uc3QgdHJhY2tOYW1lID0gYm9uZS5uYW1lICsgKHRyYWNrRGF0YS50eXBlID09PSAndmVjdG9yJyA/ICcucG9zaXRpb24nIDogJy5xdWF0ZXJuaW9uJyk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIFNhbml0aXplIElucHV0cwogICAgICAgICAgICAgICAgbGV0IHRpbWVzID0gdHJhY2tEYXRhLnRpbWVzOwogICAgICAgICAgICAgICAgbGV0IHZhbHVlcyA9IHRyYWNrRGF0YS52YWx1ZXM7CgogICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHRpbWVzKSB8fCAhQXJyYXkuaXNBcnJheSh2YWx1ZXMpKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBSaWdNYW5hZ2VyOiBJbnZhbGlkIGRhdGEgZm9yIGJvbmUgJHt0cmFja0RhdGEuYm9uZX1gKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gRW5zdXJlIEZsb2F0MzIgYW5kIGZsYXQgYXJyYXlzCiAgICAgICAgICAgICAgICB0aW1lcyA9IG5ldyBGbG9hdDMyQXJyYXkodGltZXMpOwogICAgICAgICAgICAgICAgdmFsdWVzID0gbmV3IEZsb2F0MzJBcnJheSh2YWx1ZXMuZmxhdCgpKTsKCiAgICAgICAgICAgICAgICAvLyBWYWxpZGF0aW9uOiBWYWx1ZSBjb3VudAogICAgICAgICAgICAgICAgY29uc3Qgc3RyaWRlID0gdHJhY2tEYXRhLnR5cGUgPT09ICd2ZWN0b3InID8gMyA6IDQ7CiAgICAgICAgICAgICAgICBpZiAodmFsdWVzLmxlbmd0aCAhPT0gdGltZXMubGVuZ3RoICogc3RyaWRlKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBSaWdNYW5hZ2VyOiBNaXNtYXRjaCBpbiB0aW1lcy92YWx1ZXMgZm9yICR7dHJhY2tEYXRhLmJvbmV9LiBFeHBlY3RlZCAke3RpbWVzLmxlbmd0aCAqIHN0cmlkZX0gdmFsdWVzLCBnb3QgJHt2YWx1ZXMubGVuZ3RofS4gVHJpbW1pbmcvUGFkZGluZy5gKTsKICAgICAgICAgICAgICAgICAgICAvLyBTaW1wbGUgZml4OiB0cnVuY2F0ZSB0byBtYXRjaCBzaG9ydGVzdAogICAgICAgICAgICAgICAgICAgIGNvbnN0IG1pbkxlbiA9IE1hdGgubWluKHRpbWVzLmxlbmd0aCwgTWF0aC5mbG9vcih2YWx1ZXMubGVuZ3RoIC8gc3RyaWRlKSk7CiAgICAgICAgICAgICAgICAgICAgdGltZXMgPSB0aW1lcy5zbGljZSgwLCBtaW5MZW4pOwogICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHZhbHVlcy5zbGljZSgwLCBtaW5MZW4gKiBzdHJpZGUpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBtYXggdGltZQogICAgICAgICAgICAgICAgaWYgKHRpbWVzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICBtYXhUaW1lID0gTWF0aC5tYXgobWF4VGltZSwgdGltZXNbdGltZXMubGVuZ3RoIC0gMV0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBUcmFjawogICAgICAgICAgICAgICAgbGV0IHRyYWNrOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBpZiAodHJhY2tEYXRhLnR5cGUgPT09ICd2ZWN0b3InKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrID0gbmV3IFRIUkVFLlZlY3RvcktleWZyYW1lVHJhY2sodHJhY2tOYW1lLCBBcnJheS5mcm9tKHRpbWVzKSwgQXJyYXkuZnJvbSh2YWx1ZXMpKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICB0cmFjayA9IG5ldyBUSFJFRS5RdWF0ZXJuaW9uS2V5ZnJhbWVUcmFjayh0cmFja05hbWUsIEFycmF5LmZyb20odGltZXMpLCBBcnJheS5mcm9tKHZhbHVlcykpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0cmFja3MucHVzaCh0cmFjayk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBSaWdNYW5hZ2VyOiBGYWlsZWQgdG8gY3JlYXRlIHRyYWNrIGZvciAke3RyYWNrRGF0YS5ib25lfWAsIGVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYgKHRyYWNrcy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIlJpZ01hbmFnZXI6IE5vIHZhbGlkIHRyYWNrcyBnZW5lcmF0ZWQuIik7CiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgZHVyYXRpb24gPSBkYXRhLmR1cmF0aW9uIHx8IG1heFRpbWU7CiAgICAgICAgICAgIC8vIEdlbmVyYXRlIHVuaXF1ZSBuYW1lCiAgICAgICAgICAgIGNvbnN0IGFuaW1OYW1lID0gKGRhdGEubmFtZSB8fCAnQUlfQW5pbScpICsgJ18nICsgRGF0ZS5ub3coKS50b1N0cmluZygpLnNsaWNlKC00KTsKICAgICAgICAgICAgY29uc3QgY2xpcCA9IG5ldyBUSFJFRS5BbmltYXRpb25DbGlwKGFuaW1OYW1lLCBkdXJhdGlvbiwgdHJhY2tzKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIEFkZCB0byBsaXN0CiAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9ucy5wdXNoKGNsaXApOwogICAgICAgICAgICBjb25zb2xlLmxvZyhgUmlnTWFuYWdlcjogQ3JlYXRlZCBhbmltYXRpb24gJyR7YW5pbU5hbWV9JyB3aXRoICR7dHJhY2tzLmxlbmd0aH0gdHJhY2tzLiBEdXJhdGlvbjogJHtkdXJhdGlvbn1zYCk7CiAgICAgICAgICAgIHJldHVybiBjbGlwOwp9CiAgICB9CgogICAgLy8gRXhwb3J0IGluc3RhbmNlCiAgICB3aW5kb3cuZmx1eC5yaWdNYW5hZ2VyID0gbmV3IFJpZ01hbmFnZXIoKTsKfSkoKTs=","./js/rig-manager.js":"data:text/javascript;base64,LyoqCiAqIFJpZ01hbmFnZXIKICogSGFuZGxlcyBTa2VsZXRvbiBBbmFseXNpcywgQm9uZSBNYXBwaW5nLCBhbmQgQW5pbWF0aW9uIE1peGluZwogKi8KCndpbmRvdy5mbHV4ID0gd2luZG93LmZsdXggfHwge307CgooZnVuY3Rpb24oKSB7CiAgICAvLyBTdGFuZGFyZCBNaXhhbW8gYm9uZSBuYW1lcyBmb3IgdmFsaWRhdGlvbi9tYXBwaW5nCiAgICBjb25zdCBfbWl4YW1vQm9uZXMgPSBbCiAgICAgICAgJ0hpcHMnLCAnU3BpbmUnLCAnU3BpbmUxJywgJ1NwaW5lMicsICdOZWNrJywgJ0hlYWQnLAogICAgICAgICdMZWZ0U2hvdWxkZXInLCAnTGVmdEFybScsICdMZWZ0Rm9yZUFybScsICdMZWZ0SGFuZCcsCiAgICAgICAgJ1JpZ2h0U2hvdWxkZXInLCAnUmlnaHRBcm0nLCAnUmlnaHRGb3JlQXJtJywgJ1JpZ2h0SGFuZCcsCiAgICAgICAgJ0xlZnRVcExlZycsICdMZWZ0TGVnJywgJ0xlZnRGb290JywKICAgICAgICAnUmlnaHRVcExlZycsICdSaWdodExlZycsICdSaWdodEZvb3QnCiAgICBdOwoKY2xhc3MgUmlnTWFuYWdlciB7CiAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICAgIHRoaXMubW9kZWwgPSBudWxsOwogICAgICAgICAgICB0aGlzLnNrZWxldG9uID0gbnVsbDsKICAgICAgICAgICAgdGhpcy5ib25lcyA9IHt9OyAvLyBNYXAgb2YgY2xlYW5OYW1lIC0+IEJvbmUgT2JqZWN0CiAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9ucyA9IFtdOwogICAgICAgICAgICB0aGlzLm1peGVyID0gbnVsbDsKICAgICAgICAgICAgdGhpcy5jdXJyZW50QWN0aW9uID0gbnVsbDsKICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEFuYWx5emUgYSBsb2FkZWQgbW9kZWwgZm9yIFJpZ2dpbmcgY2FwYWJpbGl0aWVzCiAgICAgICAgICogQHBhcmFtIHtUSFJFRS5PYmplY3QzRH0gbW9kZWwgCiAgICAgICAgICogQHBhcmFtIHtUSFJFRS5BbmltYXRpb25DbGlwW119IGFuaW1hdGlvbnMgCiAgICAgICAgICogQHJldHVybnMge2Jvb2xlYW59IGlzUmlnZ2VkCiAgICAgICAgICovCiAgICAgICAgYW5hbHl6ZShtb2RlbCwgYW5pbWF0aW9ucykgewogICAgICAgICAgICB0aGlzLnJlc2V0KCk7CiAgICAgICAgICAgIHRoaXMubW9kZWwgPSBtb2RlbDsKICAgICAgICAgICAgdGhpcy5hbmltYXRpb25zID0gYW5pbWF0aW9ucyB8fCBbXTsKCiAgICAgICAgICAgIC8vIDEuIEZpbmQgU2tpbm5lZE1lc2gKICAgICAgICAgICAgbGV0IHNraW5uZWRNZXNoID0gbnVsbDsKICAgICAgICAgICAgbW9kZWwudHJhdmVyc2UoKGNoaWxkKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoY2hpbGQuaXNTa2lubmVkTWVzaCAmJiAhc2tpbm5lZE1lc2gpIHsKICAgICAgICAgICAgICAgICAgICBza2lubmVkTWVzaCA9IGNoaWxkOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGlmICghc2tpbm5lZE1lc2gpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybigiUmlnTWFuYWdlcjogTm8gU2tpbm5lZE1lc2ggZm91bmQuIik7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMuc2tlbGV0b24gPSBza2lubmVkTWVzaC5za2VsZXRvbjsKICAgICAgICAgICAgY29uc29sZS5sb2coIlJpZ01hbmFnZXI6IFNrZWxldG9uIGRldGVjdGVkLiIsIHRoaXMuc2tlbGV0b24pOwoKICAgICAgICAgICAgLy8gMi4gTWFwIEJvbmVzCiAgICAgICAgICAgIHRoaXMubWFwQm9uZXMoKTsKCiAgICAgICAgICAgIC8vIDMuIFNldHVwIE1peGVyCiAgICAgICAgICAgIHRoaXMubWl4ZXIgPSBuZXcgVEhSRUUuQW5pbWF0aW9uTWl4ZXIodGhpcy5tb2RlbCk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBBZGQgdG8gZ2xvYmFsIG1peGVyIGxvb3AKICAgICAgICAgICAgaWYgKCF3aW5kb3cuZmx1eC5taXhlcnMpIHdpbmRvdy5mbHV4Lm1peGVycyA9IFtdOwogICAgICAgICAgICB3aW5kb3cuZmx1eC5taXhlcnMucHVzaCh0aGlzLm1peGVyKTsKCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgcmVzZXQoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLm1peGVyKSB7CiAgICAgICAgICAgICAgICB0aGlzLm1peGVyLnN0b3BBbGxBY3Rpb24oKTsKICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBmcm9tIGdsb2JhbCBsb29wCiAgICAgICAgICAgICAgICBpZiAod2luZG93LmZsdXgubWl4ZXJzKSB7CiAgICAgICAgICAgICAgICAgICAgd2luZG93LmZsdXgubWl4ZXJzID0gd2luZG93LmZsdXgubWl4ZXJzLmZpbHRlcihtID0+IG0gIT09IHRoaXMubWl4ZXIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMubW9kZWwgPSBudWxsOwogICAgICAgICAgICB0aGlzLnNrZWxldG9uID0gbnVsbDsKICAgICAgICAgICAgdGhpcy5ib25lcyA9IHt9OwogICAgICAgICAgICB0aGlzLmFuaW1hdGlvbnMgPSBbXTsKICAgICAgICAgICAgdGhpcy5taXhlciA9IG51bGw7CiAgICAgICAgICAgIHRoaXMuY3VycmVudEFjdGlvbiA9IG51bGw7CiAgICAgICAgICAgIHRoaXMuaXNQbGF5aW5nID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBtYXBCb25lcygpIHsKICAgICAgICAgICAgaWYgKCF0aGlzLnNrZWxldG9uKSByZXR1cm47CgogICAgICAgICAgICB0aGlzLnNrZWxldG9uLmJvbmVzLmZvckVhY2goYm9uZSA9PiB7CiAgICAgICAgICAgICAgICAvLyBOb3JtYWxpemUgbmFtZTogcmVtb3ZlICJNaXhhbW9yaWc6IiBwcmVmaXgsIHJlbW92ZSBzcGFjZXMvY29sb25zCiAgICAgICAgICAgICAgICBjb25zdCBjbGVhbk5hbWUgPSBib25lLm5hbWUucmVwbGFjZSgvTWl4YW1vcmlnOnw6L2csICcnKTsKICAgICAgICAgICAgICAgIHRoaXMuYm9uZXNbY2xlYW5OYW1lXSA9IGJvbmU7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogUGxheSBhbiBhbmltYXRpb24gYnkgaW5kZXggb3IgbmFtZQogICAgICAgICAqLwogICAgICAgIHBsYXlBbmltYXRpb24oaWRlbnRpZmllcikgewogICAgICAgICAgICBpZiAoIXRoaXMubWl4ZXIgfHwgdGhpcy5hbmltYXRpb25zLmxlbmd0aCA9PT0gMCkgcmV0dXJuOwoKICAgICAgICAgICAgbGV0IGNsaXAgPSBudWxsOwogICAgICAgICAgICBpZiAodHlwZW9mIGlkZW50aWZpZXIgPT09ICdudW1iZXInKSB7CiAgICAgICAgICAgICAgICBjbGlwID0gdGhpcy5hbmltYXRpb25zW2lkZW50aWZpZXJdOwogICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBpZGVudGlmaWVyID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAgICAgY2xpcCA9IHRoaXMuYW5pbWF0aW9ucy5maW5kKGEgPT4gYS5uYW1lID09PSBpZGVudGlmaWVyKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGNsaXApIHsKICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRBY3Rpb24pIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRBY3Rpb24uZmFkZU91dCgwLjIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29uc3QgYWN0aW9uID0gdGhpcy5taXhlci5jbGlwQWN0aW9uKGNsaXApOwogICAgICAgICAgICAgICAgYWN0aW9uLnJlc2V0KCk7CiAgICAgICAgICAgICAgICBhY3Rpb24uZmFkZUluKDAuMik7CiAgICAgICAgICAgICAgICBhY3Rpb24ucGxheSgpOwogICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50QWN0aW9uID0gYWN0aW9uOwogICAgICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFJpZ01hbmFnZXI6IFBsYXlpbmcgJHtjbGlwLm5hbWV9YCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHBhdXNlKCkgewogICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50QWN0aW9uKSB7CiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRBY3Rpb24ucGF1c2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHRoaXMuaXNQbGF5aW5nID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJlc3VtZSgpIHsKICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudEFjdGlvbikgewogICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50QWN0aW9uLnBhdXNlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBzdG9wKCkgewogICAgICAgICAgICBpZiAodGhpcy5taXhlcikgewogICAgICAgICAgICAgICAgdGhpcy5taXhlci5zdG9wQWxsQWN0aW9uKCk7CiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRBY3Rpb24gPSBudWxsOwogICAgICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogU2NydWIgYW5pbWF0aW9uIHRvIHNwZWNpZmljIG5vcm1hbGl6ZWQgdGltZSAoMC0xKQogICAgICAgICAqLwogICAgICAgIHNjcnViKHByb2dyZXNzKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRBY3Rpb24pIHsKICAgICAgICAgICAgICAgIGNvbnN0IGR1cmF0aW9uID0gdGhpcy5jdXJyZW50QWN0aW9uLmdldENsaXAoKS5kdXJhdGlvbjsKICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEFjdGlvbi50aW1lID0gZHVyYXRpb24gKiBwcm9ncmVzczsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZ2V0QW5pbWF0aW9uTGlzdCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuYW5pbWF0aW9ucy5tYXAoKGEsIGkpID0+ICh7IG5hbWU6IGEubmFtZSwgaW5kZXg6IGkgfSkpOwogICAgICAgIH0KCmdldFN0YXR1cygpIHsKICAgICAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRBY3Rpb24pIHJldHVybiB7IHBsYXlpbmc6IGZhbHNlLCB0aW1lOiAwLCBkdXJhdGlvbjogMCwgcHJvZ3Jlc3M6IDAgfTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbnN0IGNsaXAgPSB0aGlzLmN1cnJlbnRBY3Rpb24uZ2V0Q2xpcCgpOwogICAgICAgICAgICBjb25zdCBkdXJhdGlvbiA9IGNsaXAuZHVyYXRpb247CiAgICAgICAgICAgIGNvbnN0IHRpbWUgPSB0aGlzLmN1cnJlbnRBY3Rpb24udGltZTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBwbGF5aW5nOiAhdGhpcy5jdXJyZW50QWN0aW9uLnBhdXNlZCAmJiB0aGlzLmlzUGxheWluZywKICAgICAgICAgICAgICAgIHRpbWU6IHRpbWUgJSBkdXJhdGlvbiwKICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBkdXJhdGlvbiwKICAgICAgICAgICAgICAgIHByb2dyZXNzOiAodGltZSAlIGR1cmF0aW9uKSAvIGR1cmF0aW9uCiAgICAgICAgICAgIH07CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBHZXQgbGlzdCBvZiBib25lIG5hbWVzIGZvciBBSQogICAgICAgICAqLwogICAgICAgIGdldFNrZWxldG9uU3RydWN0dXJlKCkgewogICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5ib25lcyk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGUgQW5pbWF0aW9uQ2xpcCBmcm9tIEdlbWluaSBKU09OCiAgICAgICAgICovCmNyZWF0ZUFuaW1hdGlvbkZyb21KU09OKGRhdGEpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIlJpZ01hbmFnZXI6IFBhcnNpbmcgQUkgQW5pbWF0aW9uIERhdGEuLi4iLCBkYXRhKTsKCiAgICAgICAgICAgIGlmICghZGF0YS50cmFja3MgfHwgIUFycmF5LmlzQXJyYXkoZGF0YS50cmFja3MpKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCJSaWdNYW5hZ2VyOiBJbnZhbGlkIGFuaW1hdGlvbiBkYXRhIGZvcm1hdC4gJ3RyYWNrcycgYXJyYXkgbWlzc2luZy4iKTsKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zdCB0cmFja3MgPSBbXTsKICAgICAgICAgICAgLy8gVXNlIHByb3ZpZGVkIGR1cmF0aW9uIG9yIGNhbGN1bGF0ZSBtYXggdGltZQogICAgICAgICAgICBsZXQgbWF4VGltZSA9IDA7CgogICAgICAgICAgICBkYXRhLnRyYWNrcy5mb3JFYWNoKHRyYWNrRGF0YSA9PiB7CiAgICAgICAgICAgICAgICAvLyBGaW5kIHRoZSBhY3R1YWwgYm9uZSBvYmplY3QKICAgICAgICAgICAgICAgIGNvbnN0IGJvbmUgPSB0aGlzLmJvbmVzW3RyYWNrRGF0YS5ib25lXTsKICAgICAgICAgICAgICAgIGlmICghYm9uZSkgewogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUud2FybihgUmlnTWFuYWdlcjogQm9uZSAnJHt0cmFja0RhdGEuYm9uZX0nIG5vdCBmb3VuZCBpbiByaWcuIFNraXBwaW5nIHRyYWNrLmApOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsgCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY29uc3QgdHJhY2tOYW1lID0gYm9uZS5uYW1lICsgKHRyYWNrRGF0YS50eXBlID09PSAndmVjdG9yJyA/ICcucG9zaXRpb24nIDogJy5xdWF0ZXJuaW9uJyk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIFNhbml0aXplIElucHV0cwogICAgICAgICAgICAgICAgbGV0IHRpbWVzID0gdHJhY2tEYXRhLnRpbWVzOwogICAgICAgICAgICAgICAgbGV0IHZhbHVlcyA9IHRyYWNrRGF0YS52YWx1ZXM7CgogICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHRpbWVzKSB8fCAhQXJyYXkuaXNBcnJheSh2YWx1ZXMpKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBSaWdNYW5hZ2VyOiBJbnZhbGlkIGRhdGEgZm9yIGJvbmUgJHt0cmFja0RhdGEuYm9uZX1gKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gRW5zdXJlIEZsb2F0MzIgYW5kIGZsYXQgYXJyYXlzCiAgICAgICAgICAgICAgICB0aW1lcyA9IG5ldyBGbG9hdDMyQXJyYXkodGltZXMpOwogICAgICAgICAgICAgICAgdmFsdWVzID0gbmV3IEZsb2F0MzJBcnJheSh2YWx1ZXMuZmxhdCgpKTsKCiAgICAgICAgICAgICAgICAvLyBWYWxpZGF0aW9uOiBWYWx1ZSBjb3VudAogICAgICAgICAgICAgICAgY29uc3Qgc3RyaWRlID0gdHJhY2tEYXRhLnR5cGUgPT09ICd2ZWN0b3InID8gMyA6IDQ7CiAgICAgICAgICAgICAgICBpZiAodmFsdWVzLmxlbmd0aCAhPT0gdGltZXMubGVuZ3RoICogc3RyaWRlKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBSaWdNYW5hZ2VyOiBNaXNtYXRjaCBpbiB0aW1lcy92YWx1ZXMgZm9yICR7dHJhY2tEYXRhLmJvbmV9LiBFeHBlY3RlZCAke3RpbWVzLmxlbmd0aCAqIHN0cmlkZX0gdmFsdWVzLCBnb3QgJHt2YWx1ZXMubGVuZ3RofS4gVHJpbW1pbmcvUGFkZGluZy5gKTsKICAgICAgICAgICAgICAgICAgICAvLyBTaW1wbGUgZml4OiB0cnVuY2F0ZSB0byBtYXRjaCBzaG9ydGVzdAogICAgICAgICAgICAgICAgICAgIGNvbnN0IG1pbkxlbiA9IE1hdGgubWluKHRpbWVzLmxlbmd0aCwgTWF0aC5mbG9vcih2YWx1ZXMubGVuZ3RoIC8gc3RyaWRlKSk7CiAgICAgICAgICAgICAgICAgICAgdGltZXMgPSB0aW1lcy5zbGljZSgwLCBtaW5MZW4pOwogICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHZhbHVlcy5zbGljZSgwLCBtaW5MZW4gKiBzdHJpZGUpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBtYXggdGltZQogICAgICAgICAgICAgICAgaWYgKHRpbWVzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICBtYXhUaW1lID0gTWF0aC5tYXgobWF4VGltZSwgdGltZXNbdGltZXMubGVuZ3RoIC0gMV0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBUcmFjawogICAgICAgICAgICAgICAgbGV0IHRyYWNrOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBpZiAodHJhY2tEYXRhLnR5cGUgPT09ICd2ZWN0b3InKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrID0gbmV3IFRIUkVFLlZlY3RvcktleWZyYW1lVHJhY2sodHJhY2tOYW1lLCBBcnJheS5mcm9tKHRpbWVzKSwgQXJyYXkuZnJvbSh2YWx1ZXMpKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICB0cmFjayA9IG5ldyBUSFJFRS5RdWF0ZXJuaW9uS2V5ZnJhbWVUcmFjayh0cmFja05hbWUsIEFycmF5LmZyb20odGltZXMpLCBBcnJheS5mcm9tKHZhbHVlcykpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0cmFja3MucHVzaCh0cmFjayk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBSaWdNYW5hZ2VyOiBGYWlsZWQgdG8gY3JlYXRlIHRyYWNrIGZvciAke3RyYWNrRGF0YS5ib25lfWAsIGVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYgKHRyYWNrcy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIlJpZ01hbmFnZXI6IE5vIHZhbGlkIHRyYWNrcyBnZW5lcmF0ZWQuIik7CiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgZHVyYXRpb24gPSBkYXRhLmR1cmF0aW9uIHx8IG1heFRpbWU7CiAgICAgICAgICAgIC8vIEdlbmVyYXRlIHVuaXF1ZSBuYW1lCiAgICAgICAgICAgIGNvbnN0IGFuaW1OYW1lID0gKGRhdGEubmFtZSB8fCAnQUlfQW5pbScpICsgJ18nICsgRGF0ZS5ub3coKS50b1N0cmluZygpLnNsaWNlKC00KTsKICAgICAgICAgICAgY29uc3QgY2xpcCA9IG5ldyBUSFJFRS5BbmltYXRpb25DbGlwKGFuaW1OYW1lLCBkdXJhdGlvbiwgdHJhY2tzKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIEFkZCB0byBsaXN0CiAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9ucy5wdXNoKGNsaXApOwogICAgICAgICAgICBjb25zb2xlLmxvZyhgUmlnTWFuYWdlcjogQ3JlYXRlZCBhbmltYXRpb24gJyR7YW5pbU5hbWV9JyB3aXRoICR7dHJhY2tzLmxlbmd0aH0gdHJhY2tzLiBEdXJhdGlvbjogJHtkdXJhdGlvbn1zYCk7CiAgICAgICAgICAgIHJldHVybiBjbGlwOwp9CiAgICB9CgogICAgLy8gRXhwb3J0IGluc3RhbmNlCiAgICB3aW5kb3cuZmx1eC5yaWdNYW5hZ2VyID0gbmV3IFJpZ01hbmFnZXIoKTsKfSkoKTs=","/js/rig-manager.js":"data:text/javascript;base64,LyoqCiAqIFJpZ01hbmFnZXIKICogSGFuZGxlcyBTa2VsZXRvbiBBbmFseXNpcywgQm9uZSBNYXBwaW5nLCBhbmQgQW5pbWF0aW9uIE1peGluZwogKi8KCndpbmRvdy5mbHV4ID0gd2luZG93LmZsdXggfHwge307CgooZnVuY3Rpb24oKSB7CiAgICAvLyBTdGFuZGFyZCBNaXhhbW8gYm9uZSBuYW1lcyBmb3IgdmFsaWRhdGlvbi9tYXBwaW5nCiAgICBjb25zdCBfbWl4YW1vQm9uZXMgPSBbCiAgICAgICAgJ0hpcHMnLCAnU3BpbmUnLCAnU3BpbmUxJywgJ1NwaW5lMicsICdOZWNrJywgJ0hlYWQnLAogICAgICAgICdMZWZ0U2hvdWxkZXInLCAnTGVmdEFybScsICdMZWZ0Rm9yZUFybScsICdMZWZ0SGFuZCcsCiAgICAgICAgJ1JpZ2h0U2hvdWxkZXInLCAnUmlnaHRBcm0nLCAnUmlnaHRGb3JlQXJtJywgJ1JpZ2h0SGFuZCcsCiAgICAgICAgJ0xlZnRVcExlZycsICdMZWZ0TGVnJywgJ0xlZnRGb290JywKICAgICAgICAnUmlnaHRVcExlZycsICdSaWdodExlZycsICdSaWdodEZvb3QnCiAgICBdOwoKY2xhc3MgUmlnTWFuYWdlciB7CiAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICAgIHRoaXMubW9kZWwgPSBudWxsOwogICAgICAgICAgICB0aGlzLnNrZWxldG9uID0gbnVsbDsKICAgICAgICAgICAgdGhpcy5ib25lcyA9IHt9OyAvLyBNYXAgb2YgY2xlYW5OYW1lIC0+IEJvbmUgT2JqZWN0CiAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9ucyA9IFtdOwogICAgICAgICAgICB0aGlzLm1peGVyID0gbnVsbDsKICAgICAgICAgICAgdGhpcy5jdXJyZW50QWN0aW9uID0gbnVsbDsKICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEFuYWx5emUgYSBsb2FkZWQgbW9kZWwgZm9yIFJpZ2dpbmcgY2FwYWJpbGl0aWVzCiAgICAgICAgICogQHBhcmFtIHtUSFJFRS5PYmplY3QzRH0gbW9kZWwgCiAgICAgICAgICogQHBhcmFtIHtUSFJFRS5BbmltYXRpb25DbGlwW119IGFuaW1hdGlvbnMgCiAgICAgICAgICogQHJldHVybnMge2Jvb2xlYW59IGlzUmlnZ2VkCiAgICAgICAgICovCiAgICAgICAgYW5hbHl6ZShtb2RlbCwgYW5pbWF0aW9ucykgewogICAgICAgICAgICB0aGlzLnJlc2V0KCk7CiAgICAgICAgICAgIHRoaXMubW9kZWwgPSBtb2RlbDsKICAgICAgICAgICAgdGhpcy5hbmltYXRpb25zID0gYW5pbWF0aW9ucyB8fCBbXTsKCiAgICAgICAgICAgIC8vIDEuIEZpbmQgU2tpbm5lZE1lc2gKICAgICAgICAgICAgbGV0IHNraW5uZWRNZXNoID0gbnVsbDsKICAgICAgICAgICAgbW9kZWwudHJhdmVyc2UoKGNoaWxkKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoY2hpbGQuaXNTa2lubmVkTWVzaCAmJiAhc2tpbm5lZE1lc2gpIHsKICAgICAgICAgICAgICAgICAgICBza2lubmVkTWVzaCA9IGNoaWxkOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGlmICghc2tpbm5lZE1lc2gpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybigiUmlnTWFuYWdlcjogTm8gU2tpbm5lZE1lc2ggZm91bmQuIik7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMuc2tlbGV0b24gPSBza2lubmVkTWVzaC5za2VsZXRvbjsKICAgICAgICAgICAgY29uc29sZS5sb2coIlJpZ01hbmFnZXI6IFNrZWxldG9uIGRldGVjdGVkLiIsIHRoaXMuc2tlbGV0b24pOwoKICAgICAgICAgICAgLy8gMi4gTWFwIEJvbmVzCiAgICAgICAgICAgIHRoaXMubWFwQm9uZXMoKTsKCiAgICAgICAgICAgIC8vIDMuIFNldHVwIE1peGVyCiAgICAgICAgICAgIHRoaXMubWl4ZXIgPSBuZXcgVEhSRUUuQW5pbWF0aW9uTWl4ZXIodGhpcy5tb2RlbCk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBBZGQgdG8gZ2xvYmFsIG1peGVyIGxvb3AKICAgICAgICAgICAgaWYgKCF3aW5kb3cuZmx1eC5taXhlcnMpIHdpbmRvdy5mbHV4Lm1peGVycyA9IFtdOwogICAgICAgICAgICB3aW5kb3cuZmx1eC5taXhlcnMucHVzaCh0aGlzLm1peGVyKTsKCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgcmVzZXQoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLm1peGVyKSB7CiAgICAgICAgICAgICAgICB0aGlzLm1peGVyLnN0b3BBbGxBY3Rpb24oKTsKICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBmcm9tIGdsb2JhbCBsb29wCiAgICAgICAgICAgICAgICBpZiAod2luZG93LmZsdXgubWl4ZXJzKSB7CiAgICAgICAgICAgICAgICAgICAgd2luZG93LmZsdXgubWl4ZXJzID0gd2luZG93LmZsdXgubWl4ZXJzLmZpbHRlcihtID0+IG0gIT09IHRoaXMubWl4ZXIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMubW9kZWwgPSBudWxsOwogICAgICAgICAgICB0aGlzLnNrZWxldG9uID0gbnVsbDsKICAgICAgICAgICAgdGhpcy5ib25lcyA9IHt9OwogICAgICAgICAgICB0aGlzLmFuaW1hdGlvbnMgPSBbXTsKICAgICAgICAgICAgdGhpcy5taXhlciA9IG51bGw7CiAgICAgICAgICAgIHRoaXMuY3VycmVudEFjdGlvbiA9IG51bGw7CiAgICAgICAgICAgIHRoaXMuaXNQbGF5aW5nID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBtYXBCb25lcygpIHsKICAgICAgICAgICAgaWYgKCF0aGlzLnNrZWxldG9uKSByZXR1cm47CgogICAgICAgICAgICB0aGlzLnNrZWxldG9uLmJvbmVzLmZvckVhY2goYm9uZSA9PiB7CiAgICAgICAgICAgICAgICAvLyBOb3JtYWxpemUgbmFtZTogcmVtb3ZlICJNaXhhbW9yaWc6IiBwcmVmaXgsIHJlbW92ZSBzcGFjZXMvY29sb25zCiAgICAgICAgICAgICAgICBjb25zdCBjbGVhbk5hbWUgPSBib25lLm5hbWUucmVwbGFjZSgvTWl4YW1vcmlnOnw6L2csICcnKTsKICAgICAgICAgICAgICAgIHRoaXMuYm9uZXNbY2xlYW5OYW1lXSA9IGJvbmU7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogUGxheSBhbiBhbmltYXRpb24gYnkgaW5kZXggb3IgbmFtZQogICAgICAgICAqLwogICAgICAgIHBsYXlBbmltYXRpb24oaWRlbnRpZmllcikgewogICAgICAgICAgICBpZiAoIXRoaXMubWl4ZXIgfHwgdGhpcy5hbmltYXRpb25zLmxlbmd0aCA9PT0gMCkgcmV0dXJuOwoKICAgICAgICAgICAgbGV0IGNsaXAgPSBudWxsOwogICAgICAgICAgICBpZiAodHlwZW9mIGlkZW50aWZpZXIgPT09ICdudW1iZXInKSB7CiAgICAgICAgICAgICAgICBjbGlwID0gdGhpcy5hbmltYXRpb25zW2lkZW50aWZpZXJdOwogICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBpZGVudGlmaWVyID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAgICAgY2xpcCA9IHRoaXMuYW5pbWF0aW9ucy5maW5kKGEgPT4gYS5uYW1lID09PSBpZGVudGlmaWVyKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGNsaXApIHsKICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRBY3Rpb24pIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRBY3Rpb24uZmFkZU91dCgwLjIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29uc3QgYWN0aW9uID0gdGhpcy5taXhlci5jbGlwQWN0aW9uKGNsaXApOwogICAgICAgICAgICAgICAgYWN0aW9uLnJlc2V0KCk7CiAgICAgICAgICAgICAgICBhY3Rpb24uZmFkZUluKDAuMik7CiAgICAgICAgICAgICAgICBhY3Rpb24ucGxheSgpOwogICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50QWN0aW9uID0gYWN0aW9uOwogICAgICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFJpZ01hbmFnZXI6IFBsYXlpbmcgJHtjbGlwLm5hbWV9YCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHBhdXNlKCkgewogICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50QWN0aW9uKSB7CiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRBY3Rpb24ucGF1c2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHRoaXMuaXNQbGF5aW5nID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJlc3VtZSgpIHsKICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudEFjdGlvbikgewogICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50QWN0aW9uLnBhdXNlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBzdG9wKCkgewogICAgICAgICAgICBpZiAodGhpcy5taXhlcikgewogICAgICAgICAgICAgICAgdGhpcy5taXhlci5zdG9wQWxsQWN0aW9uKCk7CiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRBY3Rpb24gPSBudWxsOwogICAgICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogU2NydWIgYW5pbWF0aW9uIHRvIHNwZWNpZmljIG5vcm1hbGl6ZWQgdGltZSAoMC0xKQogICAgICAgICAqLwogICAgICAgIHNjcnViKHByb2dyZXNzKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRBY3Rpb24pIHsKICAgICAgICAgICAgICAgIGNvbnN0IGR1cmF0aW9uID0gdGhpcy5jdXJyZW50QWN0aW9uLmdldENsaXAoKS5kdXJhdGlvbjsKICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEFjdGlvbi50aW1lID0gZHVyYXRpb24gKiBwcm9ncmVzczsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZ2V0QW5pbWF0aW9uTGlzdCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuYW5pbWF0aW9ucy5tYXAoKGEsIGkpID0+ICh7IG5hbWU6IGEubmFtZSwgaW5kZXg6IGkgfSkpOwogICAgICAgIH0KCmdldFN0YXR1cygpIHsKICAgICAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRBY3Rpb24pIHJldHVybiB7IHBsYXlpbmc6IGZhbHNlLCB0aW1lOiAwLCBkdXJhdGlvbjogMCwgcHJvZ3Jlc3M6IDAgfTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbnN0IGNsaXAgPSB0aGlzLmN1cnJlbnRBY3Rpb24uZ2V0Q2xpcCgpOwogICAgICAgICAgICBjb25zdCBkdXJhdGlvbiA9IGNsaXAuZHVyYXRpb247CiAgICAgICAgICAgIGNvbnN0IHRpbWUgPSB0aGlzLmN1cnJlbnRBY3Rpb24udGltZTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBwbGF5aW5nOiAhdGhpcy5jdXJyZW50QWN0aW9uLnBhdXNlZCAmJiB0aGlzLmlzUGxheWluZywKICAgICAgICAgICAgICAgIHRpbWU6IHRpbWUgJSBkdXJhdGlvbiwKICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBkdXJhdGlvbiwKICAgICAgICAgICAgICAgIHByb2dyZXNzOiAodGltZSAlIGR1cmF0aW9uKSAvIGR1cmF0aW9uCiAgICAgICAgICAgIH07CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBHZXQgbGlzdCBvZiBib25lIG5hbWVzIGZvciBBSQogICAgICAgICAqLwogICAgICAgIGdldFNrZWxldG9uU3RydWN0dXJlKCkgewogICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5ib25lcyk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGUgQW5pbWF0aW9uQ2xpcCBmcm9tIEdlbWluaSBKU09OCiAgICAgICAgICovCmNyZWF0ZUFuaW1hdGlvbkZyb21KU09OKGRhdGEpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIlJpZ01hbmFnZXI6IFBhcnNpbmcgQUkgQW5pbWF0aW9uIERhdGEuLi4iLCBkYXRhKTsKCiAgICAgICAgICAgIGlmICghZGF0YS50cmFja3MgfHwgIUFycmF5LmlzQXJyYXkoZGF0YS50cmFja3MpKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCJSaWdNYW5hZ2VyOiBJbnZhbGlkIGFuaW1hdGlvbiBkYXRhIGZvcm1hdC4gJ3RyYWNrcycgYXJyYXkgbWlzc2luZy4iKTsKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zdCB0cmFja3MgPSBbXTsKICAgICAgICAgICAgLy8gVXNlIHByb3ZpZGVkIGR1cmF0aW9uIG9yIGNhbGN1bGF0ZSBtYXggdGltZQogICAgICAgICAgICBsZXQgbWF4VGltZSA9IDA7CgogICAgICAgICAgICBkYXRhLnRyYWNrcy5mb3JFYWNoKHRyYWNrRGF0YSA9PiB7CiAgICAgICAgICAgICAgICAvLyBGaW5kIHRoZSBhY3R1YWwgYm9uZSBvYmplY3QKICAgICAgICAgICAgICAgIGNvbnN0IGJvbmUgPSB0aGlzLmJvbmVzW3RyYWNrRGF0YS5ib25lXTsKICAgICAgICAgICAgICAgIGlmICghYm9uZSkgewogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUud2FybihgUmlnTWFuYWdlcjogQm9uZSAnJHt0cmFja0RhdGEuYm9uZX0nIG5vdCBmb3VuZCBpbiByaWcuIFNraXBwaW5nIHRyYWNrLmApOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsgCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY29uc3QgdHJhY2tOYW1lID0gYm9uZS5uYW1lICsgKHRyYWNrRGF0YS50eXBlID09PSAndmVjdG9yJyA/ICcucG9zaXRpb24nIDogJy5xdWF0ZXJuaW9uJyk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIFNhbml0aXplIElucHV0cwogICAgICAgICAgICAgICAgbGV0IHRpbWVzID0gdHJhY2tEYXRhLnRpbWVzOwogICAgICAgICAgICAgICAgbGV0IHZhbHVlcyA9IHRyYWNrRGF0YS52YWx1ZXM7CgogICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHRpbWVzKSB8fCAhQXJyYXkuaXNBcnJheSh2YWx1ZXMpKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBSaWdNYW5hZ2VyOiBJbnZhbGlkIGRhdGEgZm9yIGJvbmUgJHt0cmFja0RhdGEuYm9uZX1gKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gRW5zdXJlIEZsb2F0MzIgYW5kIGZsYXQgYXJyYXlzCiAgICAgICAgICAgICAgICB0aW1lcyA9IG5ldyBGbG9hdDMyQXJyYXkodGltZXMpOwogICAgICAgICAgICAgICAgdmFsdWVzID0gbmV3IEZsb2F0MzJBcnJheSh2YWx1ZXMuZmxhdCgpKTsKCiAgICAgICAgICAgICAgICAvLyBWYWxpZGF0aW9uOiBWYWx1ZSBjb3VudAogICAgICAgICAgICAgICAgY29uc3Qgc3RyaWRlID0gdHJhY2tEYXRhLnR5cGUgPT09ICd2ZWN0b3InID8gMyA6IDQ7CiAgICAgICAgICAgICAgICBpZiAodmFsdWVzLmxlbmd0aCAhPT0gdGltZXMubGVuZ3RoICogc3RyaWRlKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBSaWdNYW5hZ2VyOiBNaXNtYXRjaCBpbiB0aW1lcy92YWx1ZXMgZm9yICR7dHJhY2tEYXRhLmJvbmV9LiBFeHBlY3RlZCAke3RpbWVzLmxlbmd0aCAqIHN0cmlkZX0gdmFsdWVzLCBnb3QgJHt2YWx1ZXMubGVuZ3RofS4gVHJpbW1pbmcvUGFkZGluZy5gKTsKICAgICAgICAgICAgICAgICAgICAvLyBTaW1wbGUgZml4OiB0cnVuY2F0ZSB0byBtYXRjaCBzaG9ydGVzdAogICAgICAgICAgICAgICAgICAgIGNvbnN0IG1pbkxlbiA9IE1hdGgubWluKHRpbWVzLmxlbmd0aCwgTWF0aC5mbG9vcih2YWx1ZXMubGVuZ3RoIC8gc3RyaWRlKSk7CiAgICAgICAgICAgICAgICAgICAgdGltZXMgPSB0aW1lcy5zbGljZSgwLCBtaW5MZW4pOwogICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHZhbHVlcy5zbGljZSgwLCBtaW5MZW4gKiBzdHJpZGUpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBtYXggdGltZQogICAgICAgICAgICAgICAgaWYgKHRpbWVzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICBtYXhUaW1lID0gTWF0aC5tYXgobWF4VGltZSwgdGltZXNbdGltZXMubGVuZ3RoIC0gMV0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBUcmFjawogICAgICAgICAgICAgICAgbGV0IHRyYWNrOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBpZiAodHJhY2tEYXRhLnR5cGUgPT09ICd2ZWN0b3InKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrID0gbmV3IFRIUkVFLlZlY3RvcktleWZyYW1lVHJhY2sodHJhY2tOYW1lLCBBcnJheS5mcm9tKHRpbWVzKSwgQXJyYXkuZnJvbSh2YWx1ZXMpKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICB0cmFjayA9IG5ldyBUSFJFRS5RdWF0ZXJuaW9uS2V5ZnJhbWVUcmFjayh0cmFja05hbWUsIEFycmF5LmZyb20odGltZXMpLCBBcnJheS5mcm9tKHZhbHVlcykpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0cmFja3MucHVzaCh0cmFjayk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBSaWdNYW5hZ2VyOiBGYWlsZWQgdG8gY3JlYXRlIHRyYWNrIGZvciAke3RyYWNrRGF0YS5ib25lfWAsIGVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYgKHRyYWNrcy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIlJpZ01hbmFnZXI6IE5vIHZhbGlkIHRyYWNrcyBnZW5lcmF0ZWQuIik7CiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgZHVyYXRpb24gPSBkYXRhLmR1cmF0aW9uIHx8IG1heFRpbWU7CiAgICAgICAgICAgIC8vIEdlbmVyYXRlIHVuaXF1ZSBuYW1lCiAgICAgICAgICAgIGNvbnN0IGFuaW1OYW1lID0gKGRhdGEubmFtZSB8fCAnQUlfQW5pbScpICsgJ18nICsgRGF0ZS5ub3coKS50b1N0cmluZygpLnNsaWNlKC00KTsKICAgICAgICAgICAgY29uc3QgY2xpcCA9IG5ldyBUSFJFRS5BbmltYXRpb25DbGlwKGFuaW1OYW1lLCBkdXJhdGlvbiwgdHJhY2tzKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIEFkZCB0byBsaXN0CiAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9ucy5wdXNoKGNsaXApOwogICAgICAgICAgICBjb25zb2xlLmxvZyhgUmlnTWFuYWdlcjogQ3JlYXRlZCBhbmltYXRpb24gJyR7YW5pbU5hbWV9JyB3aXRoICR7dHJhY2tzLmxlbmd0aH0gdHJhY2tzLiBEdXJhdGlvbjogJHtkdXJhdGlvbn1zYCk7CiAgICAgICAgICAgIHJldHVybiBjbGlwOwp9CiAgICB9CgogICAgLy8gRXhwb3J0IGluc3RhbmNlCiAgICB3aW5kb3cuZmx1eC5yaWdNYW5hZ2VyID0gbmV3IFJpZ01hbmFnZXIoKTsKfSkoKTs=","js/loader.js":"data:text/javascript;base64,LyoqCiAqIExvYWRlclNlcnZpY2UKICogSGFuZGxlcyBGaWxlIElucHV0LCBEcmFnLWFuZC1Ecm9wLCBhbmQgR0xCIFBhcnNpbmcKICovCgp3aW5kb3cuZmx1eCA9IHdpbmRvdy5mbHV4IHx8IHt9OwoKKGZ1bmN0aW9uKCkgewogICAgLy8gUHJpdmF0ZSBsb2FkZXIgaW5zdGFuY2UKICAgIGNvbnN0IF9nbHRmTG9hZGVyID0gbmV3IFRIUkVFLkdMVEZMb2FkZXIoKTsKCiAgICBjbGFzcyBMb2FkZXJTZXJ2aWNlIHsKICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgICAgdGhpcy5maWxlSW5wdXQgPSBudWxsOwogICAgICAgIH0KCiAgICAgICAgaW5pdCgpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIkZsdXg6IEluaXRpYWxpemluZyBMb2FkZXIgU2VydmljZS4uLiIpOwogICAgICAgICAgICB0aGlzLmNyZWF0ZUZpbGVJbnB1dCgpOwogICAgICAgICAgICB0aGlzLnNldHVwRHJhZ0Ryb3AoKTsKICAgICAgICAgICAgdGhpcy5zZXR1cFVJSG9va3MoKTsKICAgICAgICB9CgogICAgICAgIGNyZWF0ZUZpbGVJbnB1dCgpIHsKICAgICAgICAgICAgdGhpcy5maWxlSW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOwogICAgICAgICAgICB0aGlzLmZpbGVJbnB1dC50eXBlID0gJ2ZpbGUnOwogICAgICAgICAgICB0aGlzLmZpbGVJbnB1dC5hY2NlcHQgPSAnLmdsYiwgLmdsdGYnOwogICAgICAgICAgICB0aGlzLmZpbGVJbnB1dC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuZmlsZUlucHV0KTsKCiAgICAgICAgICAgIHRoaXMuZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoZS50YXJnZXQuZmlsZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZEZyb21GaWxlKGUudGFyZ2V0LmZpbGVzWzBdKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBzZXR1cFVJSG9va3MoKSB7CiAgICAgICAgICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4taW1wb3J0Jyk7CiAgICAgICAgICAgIGlmIChidG4pIHsKICAgICAgICAgICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVJbnB1dC5jbGljaygpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHNldHVwRHJhZ0Ryb3AoKSB7CiAgICAgICAgICAgIGNvbnN0IGRyb3Bab25lID0gZG9jdW1lbnQuYm9keTsKCiAgICAgICAgICAgIC8vIFByZXZlbnQgZGVmYXVsdCBiZWhhdmlvcnMKICAgICAgICAgICAgWydkcmFnZW50ZXInLCAnZHJhZ292ZXInLCAnZHJhZ2xlYXZlJywgJ2Ryb3AnXS5mb3JFYWNoKGV2ZW50TmFtZSA9PiB7CiAgICAgICAgICAgICAgICBkcm9wWm9uZS5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgKGUpID0+IHsKICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgICAgIH0sIGZhbHNlKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvLyBWaXN1YWwgZmVlZGJhY2sKICAgICAgICAgICAgZHJvcFpvbmUuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VudGVyJywgKCkgPT4gZHJvcFpvbmUuY2xhc3NMaXN0LmFkZCgnZHJhZy1hY3RpdmUnKSwgZmFsc2UpOwogICAgICAgICAgICBkcm9wWm9uZS5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCAoKSA9PiBkcm9wWm9uZS5jbGFzc0xpc3QucmVtb3ZlKCdkcmFnLWFjdGl2ZScpLCBmYWxzZSk7CiAgICAgICAgICAgIGRyb3Bab25lLmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgZHJvcFpvbmUuY2xhc3NMaXN0LnJlbW92ZSgnZHJhZy1hY3RpdmUnKTsKICAgICAgICAgICAgICAgIGNvbnN0IGR0ID0gZS5kYXRhVHJhbnNmZXI7CiAgICAgICAgICAgICAgICBjb25zdCBmaWxlcyA9IGR0LmZpbGVzOwogICAgICAgICAgICAgICAgaWYgKGZpbGVzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRGcm9tRmlsZShmaWxlc1swXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIGZhbHNlKTsKICAgICAgICB9CgogICAgICAgIGxvYWRGcm9tRmlsZShmaWxlKSB7CiAgICAgICAgICAgIC8vIEJhc2ljIHZhbGlkYXRpb24KICAgICAgICAgICAgaWYgKCFmaWxlLm5hbWUubWF0Y2goL1wuKGdsYnxnbHRmKSQvaSkpIHsKICAgICAgICAgICAgICAgIGFsZXJ0KCJPbmx5IC5nbGIgb3IgLmdsdGYgZmlsZXMgYXJlIHN1cHBvcnRlZC4iKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlKTsKICAgICAgICAgICAgdGhpcy5sb2FkRnJvbVVybCh1cmwsIGZpbGUubmFtZSk7CiAgICAgICAgfQoKICAgICAgICBsb2FkRnJvbVVybCh1cmwsIGZpbGVuYW1lKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBMb2FkZXI6IExvYWRpbmcgJHtmaWxlbmFtZX0uLi5gKTsKICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyh0cnVlKTsKCiAgICAgICAgICAgIF9nbHRmTG9hZGVyLmxvYWQodXJsLCAoZ2x0ZikgPT4gewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkxvYWRlcjogU3VjY2VzcyIsIGdsdGYpOwogICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVNb2RlbExvYWRlZChnbHRmKTsKICAgICAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTsKICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcoZmFsc2UpOwogICAgICAgICAgICB9LCAoeGhyKSA9PiB7CiAgICAgICAgICAgICAgICAvLyBQcm9ncmVzcyAob3B0aW9uYWwpCiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygoeGhyLmxvYWRlZCAvIHhoci50b3RhbCAqIDEwMCkgKyAnJSBsb2FkZWQnKTsKICAgICAgICAgICAgfSwgKGVycm9yKSA9PiB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCJMb2FkZXI6IEVycm9yIiwgZXJyb3IpOwogICAgICAgICAgICAgICAgYWxlcnQoIkZhaWxlZCB0byBsb2FkIG1vZGVsLiIpOwogICAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyhmYWxzZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgaGFuZGxlTW9kZWxMb2FkZWQoZ2x0ZikgewogICAgICAgICAgICBjb25zdCBzY2VuZSA9IHdpbmRvdy5mbHV4LnNjZW5lOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gMS4gQ2xlYW51cCBleGlzdGluZyBtb2RlbAogICAgICAgICAgICBpZiAod2luZG93LmZsdXguY3VycmVudE1vZGVsKSB7CiAgICAgICAgICAgICAgICBzY2VuZS5yZW1vdmUod2luZG93LmZsdXguY3VycmVudE1vZGVsKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gMi4gQWRkIG5ldyBtb2RlbAogICAgICAgICAgICBjb25zdCBtb2RlbCA9IGdsdGYuc2NlbmU7CiAgICAgICAgICAgIHdpbmRvdy5mbHV4LmN1cnJlbnRNb2RlbCA9IG1vZGVsOwogICAgICAgICAgICBzY2VuZS5hZGQobW9kZWwpOwoKICAgICAgICAgICAgLy8gMy4gQW5hbHl6ZSBSaWcKICAgICAgICAgICAgaWYgKHdpbmRvdy5mbHV4LnJpZ01hbmFnZXIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGhhc1JpZyA9IHdpbmRvdy5mbHV4LnJpZ01hbmFnZXIuYW5hbHl6ZShtb2RlbCwgZ2x0Zi5hbmltYXRpb25zKTsKICAgICAgICAgICAgICAgIGlmIChoYXNSaWcpIHsKICAgICAgICAgICAgICAgICAgICAvLyBQbGF5IGRlZmF1bHQgYW5pbWF0aW9uIGlmIGV4aXN0cwogICAgICAgICAgICAgICAgICAgIGlmIChnbHRmLmFuaW1hdGlvbnMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZmx1eC5yaWdNYW5hZ2VyLnBsYXlBbmltYXRpb24oMCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oIkxvYWRlcjogTW9kZWwgbG9hZGVkIGJ1dCBubyByaWcgZGV0ZWN0ZWQuIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIDQuIEZpdCBDYW1lcmEKdGhpcy5maXRDYW1lcmEobW9kZWwpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gNS4gVXBkYXRlIFVJCiAgICAgICAgICAgIGlmICh3aW5kb3cuZmx1eC51aSkgewogICAgICAgICAgICAgICAgd2luZG93LmZsdXgudWkub25Nb2RlbExvYWRlZCgpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmaXRDYW1lcmEob2JqZWN0KSB7CiAgICAgICAgICAgIGNvbnN0IGJveCA9IG5ldyBUSFJFRS5Cb3gzKCkuc2V0RnJvbU9iamVjdChvYmplY3QpOwogICAgICAgICAgICBjb25zdCBzaXplID0gYm94LmdldFNpemUobmV3IFRIUkVFLlZlY3RvcjMoKSkubGVuZ3RoKCk7CiAgICAgICAgICAgIGNvbnN0IGNlbnRlciA9IGJveC5nZXRDZW50ZXIobmV3IFRIUkVFLlZlY3RvcjMoKSk7CgogICAgICAgICAgICAvLyBBZGp1c3QgY29udHJvbHMKICAgICAgICAgICAgY29uc3QgY29udHJvbHMgPSB3aW5kb3cuZmx1eC5jb250cm9sczsKICAgICAgICAgICAgY29udHJvbHMudGFyZ2V0LmNvcHkoY2VudGVyKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIEFkanVzdCBjYW1lcmEgcG9zaXRpb24KICAgICAgICAgICAgY29uc3QgY2FtZXJhID0gd2luZG93LmZsdXguY2FtZXJhOwogICAgICAgICAgICBjb25zdCBkaXJlY3Rpb24gPSBuZXcgVEhSRUUuVmVjdG9yMygwLCAwLCAxKTsgLy8gRnJvbnQgdmlldwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGRpc3RhbmNlIHRvIGZpdAogICAgICAgICAgICBjb25zdCBmb3YgPSBjYW1lcmEuZm92ICogKE1hdGguUEkgLyAxODApOwogICAgICAgICAgICBsZXQgZGlzdGFuY2UgPSBNYXRoLmFicyhzaXplIC8gTWF0aC5zaW4oZm92IC8gMikpOwogICAgICAgICAgICBkaXN0YW5jZSAqPSAwLjg7IC8vIFpvb20gb3V0IHNsaWdodGx5CgogICAgICAgICAgICBjb25zdCBvZmZzZXQgPSBkaXJlY3Rpb24ubXVsdGlwbHlTY2FsYXIoZGlzdGFuY2UpOwogICAgICAgICAgICBjYW1lcmEucG9zaXRpb24uY29weShjZW50ZXIpLmFkZChvZmZzZXQpOwogICAgICAgICAgICBjYW1lcmEucG9zaXRpb24ueSArPSBzaXplICogMC4yOyAvLyBTbGlnaHQgbGlmdAogICAgICAgICAgICAKICAgICAgICAgICAgY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTsKICAgICAgICAgICAgY29udHJvbHMudXBkYXRlKCk7CiAgICAgICAgfQoKICAgICAgICBzaG93TG9hZGluZyhpc0xvYWRpbmcpIHsKICAgICAgICAgICAgY29uc3Qgb3ZlcmxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nLW92ZXJsYXknKTsKICAgICAgICAgICAgY29uc3QgdGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nLXRleHQnKTsKICAgICAgICAgICAgaWYgKG92ZXJsYXkgJiYgdGV4dCkgewogICAgICAgICAgICAgICAgb3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gaXNMb2FkaW5nID8gJ2ZsZXgnIDogJ25vbmUnOwogICAgICAgICAgICAgICAgdGV4dC5pbm5lclRleHQgPSBpc0xvYWRpbmcgPyAnSW1wb3J0aW5nIE1vZGVsLi4uJyA6ICdSZWFkeSc7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgd2luZG93LmZsdXgubG9hZGVyID0gbmV3IExvYWRlclNlcnZpY2UoKTsKfSkoKTs=","./js/loader.js":"data:text/javascript;base64,LyoqCiAqIExvYWRlclNlcnZpY2UKICogSGFuZGxlcyBGaWxlIElucHV0LCBEcmFnLWFuZC1Ecm9wLCBhbmQgR0xCIFBhcnNpbmcKICovCgp3aW5kb3cuZmx1eCA9IHdpbmRvdy5mbHV4IHx8IHt9OwoKKGZ1bmN0aW9uKCkgewogICAgLy8gUHJpdmF0ZSBsb2FkZXIgaW5zdGFuY2UKICAgIGNvbnN0IF9nbHRmTG9hZGVyID0gbmV3IFRIUkVFLkdMVEZMb2FkZXIoKTsKCiAgICBjbGFzcyBMb2FkZXJTZXJ2aWNlIHsKICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgICAgdGhpcy5maWxlSW5wdXQgPSBudWxsOwogICAgICAgIH0KCiAgICAgICAgaW5pdCgpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIkZsdXg6IEluaXRpYWxpemluZyBMb2FkZXIgU2VydmljZS4uLiIpOwogICAgICAgICAgICB0aGlzLmNyZWF0ZUZpbGVJbnB1dCgpOwogICAgICAgICAgICB0aGlzLnNldHVwRHJhZ0Ryb3AoKTsKICAgICAgICAgICAgdGhpcy5zZXR1cFVJSG9va3MoKTsKICAgICAgICB9CgogICAgICAgIGNyZWF0ZUZpbGVJbnB1dCgpIHsKICAgICAgICAgICAgdGhpcy5maWxlSW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOwogICAgICAgICAgICB0aGlzLmZpbGVJbnB1dC50eXBlID0gJ2ZpbGUnOwogICAgICAgICAgICB0aGlzLmZpbGVJbnB1dC5hY2NlcHQgPSAnLmdsYiwgLmdsdGYnOwogICAgICAgICAgICB0aGlzLmZpbGVJbnB1dC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuZmlsZUlucHV0KTsKCiAgICAgICAgICAgIHRoaXMuZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoZS50YXJnZXQuZmlsZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZEZyb21GaWxlKGUudGFyZ2V0LmZpbGVzWzBdKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBzZXR1cFVJSG9va3MoKSB7CiAgICAgICAgICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4taW1wb3J0Jyk7CiAgICAgICAgICAgIGlmIChidG4pIHsKICAgICAgICAgICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVJbnB1dC5jbGljaygpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHNldHVwRHJhZ0Ryb3AoKSB7CiAgICAgICAgICAgIGNvbnN0IGRyb3Bab25lID0gZG9jdW1lbnQuYm9keTsKCiAgICAgICAgICAgIC8vIFByZXZlbnQgZGVmYXVsdCBiZWhhdmlvcnMKICAgICAgICAgICAgWydkcmFnZW50ZXInLCAnZHJhZ292ZXInLCAnZHJhZ2xlYXZlJywgJ2Ryb3AnXS5mb3JFYWNoKGV2ZW50TmFtZSA9PiB7CiAgICAgICAgICAgICAgICBkcm9wWm9uZS5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgKGUpID0+IHsKICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgICAgIH0sIGZhbHNlKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvLyBWaXN1YWwgZmVlZGJhY2sKICAgICAgICAgICAgZHJvcFpvbmUuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VudGVyJywgKCkgPT4gZHJvcFpvbmUuY2xhc3NMaXN0LmFkZCgnZHJhZy1hY3RpdmUnKSwgZmFsc2UpOwogICAgICAgICAgICBkcm9wWm9uZS5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCAoKSA9PiBkcm9wWm9uZS5jbGFzc0xpc3QucmVtb3ZlKCdkcmFnLWFjdGl2ZScpLCBmYWxzZSk7CiAgICAgICAgICAgIGRyb3Bab25lLmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgZHJvcFpvbmUuY2xhc3NMaXN0LnJlbW92ZSgnZHJhZy1hY3RpdmUnKTsKICAgICAgICAgICAgICAgIGNvbnN0IGR0ID0gZS5kYXRhVHJhbnNmZXI7CiAgICAgICAgICAgICAgICBjb25zdCBmaWxlcyA9IGR0LmZpbGVzOwogICAgICAgICAgICAgICAgaWYgKGZpbGVzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRGcm9tRmlsZShmaWxlc1swXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIGZhbHNlKTsKICAgICAgICB9CgogICAgICAgIGxvYWRGcm9tRmlsZShmaWxlKSB7CiAgICAgICAgICAgIC8vIEJhc2ljIHZhbGlkYXRpb24KICAgICAgICAgICAgaWYgKCFmaWxlLm5hbWUubWF0Y2goL1wuKGdsYnxnbHRmKSQvaSkpIHsKICAgICAgICAgICAgICAgIGFsZXJ0KCJPbmx5IC5nbGIgb3IgLmdsdGYgZmlsZXMgYXJlIHN1cHBvcnRlZC4iKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlKTsKICAgICAgICAgICAgdGhpcy5sb2FkRnJvbVVybCh1cmwsIGZpbGUubmFtZSk7CiAgICAgICAgfQoKICAgICAgICBsb2FkRnJvbVVybCh1cmwsIGZpbGVuYW1lKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBMb2FkZXI6IExvYWRpbmcgJHtmaWxlbmFtZX0uLi5gKTsKICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyh0cnVlKTsKCiAgICAgICAgICAgIF9nbHRmTG9hZGVyLmxvYWQodXJsLCAoZ2x0ZikgPT4gewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkxvYWRlcjogU3VjY2VzcyIsIGdsdGYpOwogICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVNb2RlbExvYWRlZChnbHRmKTsKICAgICAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTsKICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcoZmFsc2UpOwogICAgICAgICAgICB9LCAoeGhyKSA9PiB7CiAgICAgICAgICAgICAgICAvLyBQcm9ncmVzcyAob3B0aW9uYWwpCiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygoeGhyLmxvYWRlZCAvIHhoci50b3RhbCAqIDEwMCkgKyAnJSBsb2FkZWQnKTsKICAgICAgICAgICAgfSwgKGVycm9yKSA9PiB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCJMb2FkZXI6IEVycm9yIiwgZXJyb3IpOwogICAgICAgICAgICAgICAgYWxlcnQoIkZhaWxlZCB0byBsb2FkIG1vZGVsLiIpOwogICAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyhmYWxzZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgaGFuZGxlTW9kZWxMb2FkZWQoZ2x0ZikgewogICAgICAgICAgICBjb25zdCBzY2VuZSA9IHdpbmRvdy5mbHV4LnNjZW5lOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gMS4gQ2xlYW51cCBleGlzdGluZyBtb2RlbAogICAgICAgICAgICBpZiAod2luZG93LmZsdXguY3VycmVudE1vZGVsKSB7CiAgICAgICAgICAgICAgICBzY2VuZS5yZW1vdmUod2luZG93LmZsdXguY3VycmVudE1vZGVsKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gMi4gQWRkIG5ldyBtb2RlbAogICAgICAgICAgICBjb25zdCBtb2RlbCA9IGdsdGYuc2NlbmU7CiAgICAgICAgICAgIHdpbmRvdy5mbHV4LmN1cnJlbnRNb2RlbCA9IG1vZGVsOwogICAgICAgICAgICBzY2VuZS5hZGQobW9kZWwpOwoKICAgICAgICAgICAgLy8gMy4gQW5hbHl6ZSBSaWcKICAgICAgICAgICAgaWYgKHdpbmRvdy5mbHV4LnJpZ01hbmFnZXIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGhhc1JpZyA9IHdpbmRvdy5mbHV4LnJpZ01hbmFnZXIuYW5hbHl6ZShtb2RlbCwgZ2x0Zi5hbmltYXRpb25zKTsKICAgICAgICAgICAgICAgIGlmIChoYXNSaWcpIHsKICAgICAgICAgICAgICAgICAgICAvLyBQbGF5IGRlZmF1bHQgYW5pbWF0aW9uIGlmIGV4aXN0cwogICAgICAgICAgICAgICAgICAgIGlmIChnbHRmLmFuaW1hdGlvbnMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZmx1eC5yaWdNYW5hZ2VyLnBsYXlBbmltYXRpb24oMCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oIkxvYWRlcjogTW9kZWwgbG9hZGVkIGJ1dCBubyByaWcgZGV0ZWN0ZWQuIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIDQuIEZpdCBDYW1lcmEKdGhpcy5maXRDYW1lcmEobW9kZWwpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gNS4gVXBkYXRlIFVJCiAgICAgICAgICAgIGlmICh3aW5kb3cuZmx1eC51aSkgewogICAgICAgICAgICAgICAgd2luZG93LmZsdXgudWkub25Nb2RlbExvYWRlZCgpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmaXRDYW1lcmEob2JqZWN0KSB7CiAgICAgICAgICAgIGNvbnN0IGJveCA9IG5ldyBUSFJFRS5Cb3gzKCkuc2V0RnJvbU9iamVjdChvYmplY3QpOwogICAgICAgICAgICBjb25zdCBzaXplID0gYm94LmdldFNpemUobmV3IFRIUkVFLlZlY3RvcjMoKSkubGVuZ3RoKCk7CiAgICAgICAgICAgIGNvbnN0IGNlbnRlciA9IGJveC5nZXRDZW50ZXIobmV3IFRIUkVFLlZlY3RvcjMoKSk7CgogICAgICAgICAgICAvLyBBZGp1c3QgY29udHJvbHMKICAgICAgICAgICAgY29uc3QgY29udHJvbHMgPSB3aW5kb3cuZmx1eC5jb250cm9sczsKICAgICAgICAgICAgY29udHJvbHMudGFyZ2V0LmNvcHkoY2VudGVyKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIEFkanVzdCBjYW1lcmEgcG9zaXRpb24KICAgICAgICAgICAgY29uc3QgY2FtZXJhID0gd2luZG93LmZsdXguY2FtZXJhOwogICAgICAgICAgICBjb25zdCBkaXJlY3Rpb24gPSBuZXcgVEhSRUUuVmVjdG9yMygwLCAwLCAxKTsgLy8gRnJvbnQgdmlldwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGRpc3RhbmNlIHRvIGZpdAogICAgICAgICAgICBjb25zdCBmb3YgPSBjYW1lcmEuZm92ICogKE1hdGguUEkgLyAxODApOwogICAgICAgICAgICBsZXQgZGlzdGFuY2UgPSBNYXRoLmFicyhzaXplIC8gTWF0aC5zaW4oZm92IC8gMikpOwogICAgICAgICAgICBkaXN0YW5jZSAqPSAwLjg7IC8vIFpvb20gb3V0IHNsaWdodGx5CgogICAgICAgICAgICBjb25zdCBvZmZzZXQgPSBkaXJlY3Rpb24ubXVsdGlwbHlTY2FsYXIoZGlzdGFuY2UpOwogICAgICAgICAgICBjYW1lcmEucG9zaXRpb24uY29weShjZW50ZXIpLmFkZChvZmZzZXQpOwogICAgICAgICAgICBjYW1lcmEucG9zaXRpb24ueSArPSBzaXplICogMC4yOyAvLyBTbGlnaHQgbGlmdAogICAgICAgICAgICAKICAgICAgICAgICAgY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTsKICAgICAgICAgICAgY29udHJvbHMudXBkYXRlKCk7CiAgICAgICAgfQoKICAgICAgICBzaG93TG9hZGluZyhpc0xvYWRpbmcpIHsKICAgICAgICAgICAgY29uc3Qgb3ZlcmxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nLW92ZXJsYXknKTsKICAgICAgICAgICAgY29uc3QgdGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nLXRleHQnKTsKICAgICAgICAgICAgaWYgKG92ZXJsYXkgJiYgdGV4dCkgewogICAgICAgICAgICAgICAgb3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gaXNMb2FkaW5nID8gJ2ZsZXgnIDogJ25vbmUnOwogICAgICAgICAgICAgICAgdGV4dC5pbm5lclRleHQgPSBpc0xvYWRpbmcgPyAnSW1wb3J0aW5nIE1vZGVsLi4uJyA6ICdSZWFkeSc7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgd2luZG93LmZsdXgubG9hZGVyID0gbmV3IExvYWRlclNlcnZpY2UoKTsKfSkoKTs=","/js/loader.js":"data:text/javascript;base64,LyoqCiAqIExvYWRlclNlcnZpY2UKICogSGFuZGxlcyBGaWxlIElucHV0LCBEcmFnLWFuZC1Ecm9wLCBhbmQgR0xCIFBhcnNpbmcKICovCgp3aW5kb3cuZmx1eCA9IHdpbmRvdy5mbHV4IHx8IHt9OwoKKGZ1bmN0aW9uKCkgewogICAgLy8gUHJpdmF0ZSBsb2FkZXIgaW5zdGFuY2UKICAgIGNvbnN0IF9nbHRmTG9hZGVyID0gbmV3IFRIUkVFLkdMVEZMb2FkZXIoKTsKCiAgICBjbGFzcyBMb2FkZXJTZXJ2aWNlIHsKICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgICAgdGhpcy5maWxlSW5wdXQgPSBudWxsOwogICAgICAgIH0KCiAgICAgICAgaW5pdCgpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIkZsdXg6IEluaXRpYWxpemluZyBMb2FkZXIgU2VydmljZS4uLiIpOwogICAgICAgICAgICB0aGlzLmNyZWF0ZUZpbGVJbnB1dCgpOwogICAgICAgICAgICB0aGlzLnNldHVwRHJhZ0Ryb3AoKTsKICAgICAgICAgICAgdGhpcy5zZXR1cFVJSG9va3MoKTsKICAgICAgICB9CgogICAgICAgIGNyZWF0ZUZpbGVJbnB1dCgpIHsKICAgICAgICAgICAgdGhpcy5maWxlSW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOwogICAgICAgICAgICB0aGlzLmZpbGVJbnB1dC50eXBlID0gJ2ZpbGUnOwogICAgICAgICAgICB0aGlzLmZpbGVJbnB1dC5hY2NlcHQgPSAnLmdsYiwgLmdsdGYnOwogICAgICAgICAgICB0aGlzLmZpbGVJbnB1dC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuZmlsZUlucHV0KTsKCiAgICAgICAgICAgIHRoaXMuZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoZS50YXJnZXQuZmlsZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZEZyb21GaWxlKGUudGFyZ2V0LmZpbGVzWzBdKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBzZXR1cFVJSG9va3MoKSB7CiAgICAgICAgICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4taW1wb3J0Jyk7CiAgICAgICAgICAgIGlmIChidG4pIHsKICAgICAgICAgICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVJbnB1dC5jbGljaygpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHNldHVwRHJhZ0Ryb3AoKSB7CiAgICAgICAgICAgIGNvbnN0IGRyb3Bab25lID0gZG9jdW1lbnQuYm9keTsKCiAgICAgICAgICAgIC8vIFByZXZlbnQgZGVmYXVsdCBiZWhhdmlvcnMKICAgICAgICAgICAgWydkcmFnZW50ZXInLCAnZHJhZ292ZXInLCAnZHJhZ2xlYXZlJywgJ2Ryb3AnXS5mb3JFYWNoKGV2ZW50TmFtZSA9PiB7CiAgICAgICAgICAgICAgICBkcm9wWm9uZS5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgKGUpID0+IHsKICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgICAgIH0sIGZhbHNlKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvLyBWaXN1YWwgZmVlZGJhY2sKICAgICAgICAgICAgZHJvcFpvbmUuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VudGVyJywgKCkgPT4gZHJvcFpvbmUuY2xhc3NMaXN0LmFkZCgnZHJhZy1hY3RpdmUnKSwgZmFsc2UpOwogICAgICAgICAgICBkcm9wWm9uZS5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCAoKSA9PiBkcm9wWm9uZS5jbGFzc0xpc3QucmVtb3ZlKCdkcmFnLWFjdGl2ZScpLCBmYWxzZSk7CiAgICAgICAgICAgIGRyb3Bab25lLmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgZHJvcFpvbmUuY2xhc3NMaXN0LnJlbW92ZSgnZHJhZy1hY3RpdmUnKTsKICAgICAgICAgICAgICAgIGNvbnN0IGR0ID0gZS5kYXRhVHJhbnNmZXI7CiAgICAgICAgICAgICAgICBjb25zdCBmaWxlcyA9IGR0LmZpbGVzOwogICAgICAgICAgICAgICAgaWYgKGZpbGVzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRGcm9tRmlsZShmaWxlc1swXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIGZhbHNlKTsKICAgICAgICB9CgogICAgICAgIGxvYWRGcm9tRmlsZShmaWxlKSB7CiAgICAgICAgICAgIC8vIEJhc2ljIHZhbGlkYXRpb24KICAgICAgICAgICAgaWYgKCFmaWxlLm5hbWUubWF0Y2goL1wuKGdsYnxnbHRmKSQvaSkpIHsKICAgICAgICAgICAgICAgIGFsZXJ0KCJPbmx5IC5nbGIgb3IgLmdsdGYgZmlsZXMgYXJlIHN1cHBvcnRlZC4iKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlKTsKICAgICAgICAgICAgdGhpcy5sb2FkRnJvbVVybCh1cmwsIGZpbGUubmFtZSk7CiAgICAgICAgfQoKICAgICAgICBsb2FkRnJvbVVybCh1cmwsIGZpbGVuYW1lKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBMb2FkZXI6IExvYWRpbmcgJHtmaWxlbmFtZX0uLi5gKTsKICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyh0cnVlKTsKCiAgICAgICAgICAgIF9nbHRmTG9hZGVyLmxvYWQodXJsLCAoZ2x0ZikgPT4gewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkxvYWRlcjogU3VjY2VzcyIsIGdsdGYpOwogICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVNb2RlbExvYWRlZChnbHRmKTsKICAgICAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTsKICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcoZmFsc2UpOwogICAgICAgICAgICB9LCAoeGhyKSA9PiB7CiAgICAgICAgICAgICAgICAvLyBQcm9ncmVzcyAob3B0aW9uYWwpCiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygoeGhyLmxvYWRlZCAvIHhoci50b3RhbCAqIDEwMCkgKyAnJSBsb2FkZWQnKTsKICAgICAgICAgICAgfSwgKGVycm9yKSA9PiB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCJMb2FkZXI6IEVycm9yIiwgZXJyb3IpOwogICAgICAgICAgICAgICAgYWxlcnQoIkZhaWxlZCB0byBsb2FkIG1vZGVsLiIpOwogICAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyhmYWxzZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgaGFuZGxlTW9kZWxMb2FkZWQoZ2x0ZikgewogICAgICAgICAgICBjb25zdCBzY2VuZSA9IHdpbmRvdy5mbHV4LnNjZW5lOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gMS4gQ2xlYW51cCBleGlzdGluZyBtb2RlbAogICAgICAgICAgICBpZiAod2luZG93LmZsdXguY3VycmVudE1vZGVsKSB7CiAgICAgICAgICAgICAgICBzY2VuZS5yZW1vdmUod2luZG93LmZsdXguY3VycmVudE1vZGVsKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gMi4gQWRkIG5ldyBtb2RlbAogICAgICAgICAgICBjb25zdCBtb2RlbCA9IGdsdGYuc2NlbmU7CiAgICAgICAgICAgIHdpbmRvdy5mbHV4LmN1cnJlbnRNb2RlbCA9IG1vZGVsOwogICAgICAgICAgICBzY2VuZS5hZGQobW9kZWwpOwoKICAgICAgICAgICAgLy8gMy4gQW5hbHl6ZSBSaWcKICAgICAgICAgICAgaWYgKHdpbmRvdy5mbHV4LnJpZ01hbmFnZXIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGhhc1JpZyA9IHdpbmRvdy5mbHV4LnJpZ01hbmFnZXIuYW5hbHl6ZShtb2RlbCwgZ2x0Zi5hbmltYXRpb25zKTsKICAgICAgICAgICAgICAgIGlmIChoYXNSaWcpIHsKICAgICAgICAgICAgICAgICAgICAvLyBQbGF5IGRlZmF1bHQgYW5pbWF0aW9uIGlmIGV4aXN0cwogICAgICAgICAgICAgICAgICAgIGlmIChnbHRmLmFuaW1hdGlvbnMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZmx1eC5yaWdNYW5hZ2VyLnBsYXlBbmltYXRpb24oMCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oIkxvYWRlcjogTW9kZWwgbG9hZGVkIGJ1dCBubyByaWcgZGV0ZWN0ZWQuIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIDQuIEZpdCBDYW1lcmEKdGhpcy5maXRDYW1lcmEobW9kZWwpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gNS4gVXBkYXRlIFVJCiAgICAgICAgICAgIGlmICh3aW5kb3cuZmx1eC51aSkgewogICAgICAgICAgICAgICAgd2luZG93LmZsdXgudWkub25Nb2RlbExvYWRlZCgpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmaXRDYW1lcmEob2JqZWN0KSB7CiAgICAgICAgICAgIGNvbnN0IGJveCA9IG5ldyBUSFJFRS5Cb3gzKCkuc2V0RnJvbU9iamVjdChvYmplY3QpOwogICAgICAgICAgICBjb25zdCBzaXplID0gYm94LmdldFNpemUobmV3IFRIUkVFLlZlY3RvcjMoKSkubGVuZ3RoKCk7CiAgICAgICAgICAgIGNvbnN0IGNlbnRlciA9IGJveC5nZXRDZW50ZXIobmV3IFRIUkVFLlZlY3RvcjMoKSk7CgogICAgICAgICAgICAvLyBBZGp1c3QgY29udHJvbHMKICAgICAgICAgICAgY29uc3QgY29udHJvbHMgPSB3aW5kb3cuZmx1eC5jb250cm9sczsKICAgICAgICAgICAgY29udHJvbHMudGFyZ2V0LmNvcHkoY2VudGVyKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIEFkanVzdCBjYW1lcmEgcG9zaXRpb24KICAgICAgICAgICAgY29uc3QgY2FtZXJhID0gd2luZG93LmZsdXguY2FtZXJhOwogICAgICAgICAgICBjb25zdCBkaXJlY3Rpb24gPSBuZXcgVEhSRUUuVmVjdG9yMygwLCAwLCAxKTsgLy8gRnJvbnQgdmlldwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGRpc3RhbmNlIHRvIGZpdAogICAgICAgICAgICBjb25zdCBmb3YgPSBjYW1lcmEuZm92ICogKE1hdGguUEkgLyAxODApOwogICAgICAgICAgICBsZXQgZGlzdGFuY2UgPSBNYXRoLmFicyhzaXplIC8gTWF0aC5zaW4oZm92IC8gMikpOwogICAgICAgICAgICBkaXN0YW5jZSAqPSAwLjg7IC8vIFpvb20gb3V0IHNsaWdodGx5CgogICAgICAgICAgICBjb25zdCBvZmZzZXQgPSBkaXJlY3Rpb24ubXVsdGlwbHlTY2FsYXIoZGlzdGFuY2UpOwogICAgICAgICAgICBjYW1lcmEucG9zaXRpb24uY29weShjZW50ZXIpLmFkZChvZmZzZXQpOwogICAgICAgICAgICBjYW1lcmEucG9zaXRpb24ueSArPSBzaXplICogMC4yOyAvLyBTbGlnaHQgbGlmdAogICAgICAgICAgICAKICAgICAgICAgICAgY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTsKICAgICAgICAgICAgY29udHJvbHMudXBkYXRlKCk7CiAgICAgICAgfQoKICAgICAgICBzaG93TG9hZGluZyhpc0xvYWRpbmcpIHsKICAgICAgICAgICAgY29uc3Qgb3ZlcmxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nLW92ZXJsYXknKTsKICAgICAgICAgICAgY29uc3QgdGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nLXRleHQnKTsKICAgICAgICAgICAgaWYgKG92ZXJsYXkgJiYgdGV4dCkgewogICAgICAgICAgICAgICAgb3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gaXNMb2FkaW5nID8gJ2ZsZXgnIDogJ25vbmUnOwogICAgICAgICAgICAgICAgdGV4dC5pbm5lclRleHQgPSBpc0xvYWRpbmcgPyAnSW1wb3J0aW5nIE1vZGVsLi4uJyA6ICdSZWFkeSc7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgd2luZG93LmZsdXgubG9hZGVyID0gbmV3IExvYWRlclNlcnZpY2UoKTsKfSkoKTs=","js/ui-controller.js":"data:text/javascript;base64,LyoqCiAqIFVJIENvbnRyb2xsZXIKICogTWFuYWdlcyBBbmltYXRpb24gTGlzdCwgUGxheWJhY2sgQ29udHJvbHMsIGFuZCBTY3J1YmJpbmcKICovCndpbmRvdy5mbHV4ID0gd2luZG93LmZsdXggfHwge307CgooZnVuY3Rpb24oKSB7CmNsYXNzIFVJQ29udHJvbGxlciB7CiAgICAgICAgY29uc3RydWN0b3IoKSB7CnRoaXMuZG9tID0gewogICAgICAgICAgICAgICAgYW5pbUxpc3Q6IG51bGwsCiAgICAgICAgICAgICAgICBwbGF5UGF1c2VCdG46IG51bGwsCiAgICAgICAgICAgICAgICBzdG9wQnRuOiBudWxsLAogICAgICAgICAgICAgICAgc2xpZGVyOiBudWxsLAogICAgICAgICAgICAgICAgdGltZUN1cnJlbnQ6IG51bGwsCiAgICAgICAgICAgICAgICB0aW1lVG90YWw6IG51bGwsCiAgICAgICAgICAgICAgICBzZXR0aW5nc01vZGFsOiBudWxsLAogICAgICAgICAgICAgICAgYXBpS2V5SW5wdXQ6IG51bGwsCiAgICAgICAgICAgICAgICBtb2RlbFNlbGVjdDogbnVsbCwKICAgICAgICAgICAgICAgIGdlblByb21wdDogbnVsbCwKICAgICAgICAgICAgICAgIGdlbkJ0bjogbnVsbCwKICAgICAgICAgICAgICAgIGV4cG9ydEJ0bjogbnVsbAogICAgICAgICAgICB9OwogICAgICAgICAgICB0aGlzLmlzRHJhZ2dpbmcgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGluaXQoKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJGbHV4OiBJbml0aWFsaXppbmcgVUkgQ29udHJvbGxlci4uLiIpOwogICAgICAgICAgICB0aGlzLmNhY2hlRE9NKCk7CiAgICAgICAgICAgIHRoaXMuYmluZEV2ZW50cygpOwogICAgICAgIH0KCmNhY2hlRE9NKCkgewogICAgICAgICAgICB0aGlzLmRvbS5hbmltTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhbmltLWxpc3QnKTsKICAgICAgICAgICAgdGhpcy5kb20ucGxheVBhdXNlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1wbGF5LXBhdXNlJyk7CiAgICAgICAgICAgIHRoaXMuZG9tLnN0b3BCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuLXN0b3AnKTsKICAgICAgICAgICAgdGhpcy5kb20uc2xpZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FuaW0tc2xpZGVyJyk7CiAgICAgICAgICAgIHRoaXMuZG9tLnRpbWVDdXJyZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RpbWUtY3VycmVudCcpOwogICAgICAgICAgICB0aGlzLmRvbS50aW1lVG90YWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGltZS10b3RhbCcpOwogICAgICAgICAgICB0aGlzLmRvbS5zZXR0aW5nc01vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NldHRpbmdzLW1vZGFsJyk7CiAgICAgICAgICAgIHRoaXMuZG9tLmFwaUtleUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwaS1rZXktaW5wdXQnKTsKICAgICAgICAgICAgdGhpcy5kb20ubW9kZWxTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kZWwtc2VsZWN0Jyk7CiAgICAgICAgICAgIHRoaXMuZG9tLmdlblByb21wdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnZW4tcHJvbXB0Jyk7CiAgICAgICAgICAgIHRoaXMuZG9tLmdlbkJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4tZ2VuZXJhdGUnKTsKICAgICAgICAgICAgdGhpcy5kb20uZXhwb3J0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1leHBvcnQnKTsKICAgICAgICB9CgogICAgICAgIGJpbmRFdmVudHMoKSB7CiAgICAgICAgICAgIC8vIFBsYXkvUGF1c2UKICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnBsYXlQYXVzZUJ0bikgewogICAgICAgICAgICAgICAgdGhpcy5kb20ucGxheVBhdXNlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHJpZyA9IHdpbmRvdy5mbHV4LnJpZ01hbmFnZXI7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhdHVzID0gcmlnLmdldFN0YXR1cygpOwogICAgICAgICAgICAgICAgICAgIGlmIChzdGF0dXMucGxheWluZykgewogICAgICAgICAgICAgICAgICAgICAgICByaWcucGF1c2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kb20ucGxheVBhdXNlQnRuLnRleHRDb250ZW50ID0gJ+KWtic7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmlnLnJlc3VtZSgpOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbS5wbGF5UGF1c2VCdG4udGV4dENvbnRlbnQgPSAn4p2a4p2aJzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gU3RvcAogICAgICAgICAgICBpZiAodGhpcy5kb20uc3RvcEJ0bikgewogICAgICAgICAgICAgICAgdGhpcy5kb20uc3RvcEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZmx1eC5yaWdNYW5hZ2VyLnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbS5wbGF5UGF1c2VCdG4udGV4dENvbnRlbnQgPSAn4pa2JzsKICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNsaWRlcigwLCAwKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBTbGlkZXIgU2NydWJiaW5nCiAgICAgICAgICAgIGlmICh0aGlzLmRvbS5zbGlkZXIpIHsKICAgICAgICAgICAgICAgIHRoaXMuZG9tLnNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIChlKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0RyYWdnaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWwgPSBwYXJzZUZsb2F0KGUudGFyZ2V0LnZhbHVlKSAvIDEwMDsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZmx1eC5yaWdNYW5hZ2VyLnNjcnViKHZhbCk7CiAgICAgICAgICAgICAgICAgICAgd2luZG93LmZsdXgucmlnTWFuYWdlci5wYXVzZSgpOyAvLyBQYXVzZSB3aGlsZSBzY3J1YmJpbmcKICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbS5wbGF5UGF1c2VCdG4udGV4dENvbnRlbnQgPSAn4pa2JzsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIHRoaXMuZG9tLnNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMuaXNEcmFnZ2luZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgfSk7Cn0KCiAgICAgICAgICAgIC8vIFNldHRpbmdzIE1vZGFsCiAgICAgICAgICAgIGNvbnN0IGJ0blNldHRpbmdzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1zZXR0aW5ncycpOwogICAgICAgICAgICBjb25zdCBidG5TYXZlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1zYXZlLXNldHRpbmdzJyk7CiAgICAgICAgICAgIGNvbnN0IGJ0bkNhbmNlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4tY2FuY2VsLXNldHRpbmdzJyk7CgogICAgICAgICAgICBpZiAoYnRuU2V0dGluZ3MpIHsKICAgICAgICAgICAgICAgIGJ0blNldHRpbmdzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewp0aGlzLmRvbS5hcGlLZXlJbnB1dC52YWx1ZSA9IHdpbmRvdy5mbHV4LmdlbWluaS5nZXRBcGlLZXlzUmF3KCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZG9tLm1vZGVsU2VsZWN0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZG9tLm1vZGVsU2VsZWN0LnZhbHVlID0gd2luZG93LmZsdXguZ2VtaW5pLmdldE1vZGVsKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHRoaXMuZG9tLnNldHRpbmdzTW9kYWwuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoYnRuU2F2ZSkgewogICAgICAgICAgICAgICAgYnRuU2F2ZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKd2luZG93LmZsdXguZ2VtaW5pLnNldEFwaUtleXModGhpcy5kb20uYXBpS2V5SW5wdXQudmFsdWUpOwogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRvbS5tb2RlbFNlbGVjdCkgewogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZmx1eC5nZW1pbmkuc2V0TW9kZWwodGhpcy5kb20ubW9kZWxTZWxlY3QudmFsdWUpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbS5zZXR0aW5nc01vZGFsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGJ0bkNhbmNlbCkgewogICAgICAgICAgICAgICAgYnRuQ2FuY2VsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMuZG9tLnNldHRpbmdzTW9kYWwuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBHZW5lcmF0aW9uCiAgICAgICAgICAgIGlmICh0aGlzLmRvbS5nZW5CdG4pIHsKICAgICAgICAgICAgICAgIHRoaXMuZG9tLmdlbkJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHsKICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZUdlbmVyYXRpb24oKTsKICAgICAgICAgICAgICAgIH0pOwp9CgogICAgICAgICAgICAvLyBFeHBvcnQKICAgICAgICAgICAgaWYgKHRoaXMuZG9tLmV4cG9ydEJ0bikgewogICAgICAgICAgICAgICAgdGhpcy5kb20uZXhwb3J0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMuZXhwb3J0R0xCKCk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgIH0KCmFzeW5jIGhhbmRsZUdlbmVyYXRpb24oKSB7CiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuZG9tLmdlblByb21wdC52YWx1ZTsKICAgICAgICAgICAgaWYgKCFwcm9tcHQpIHJldHVybjsKCiAgICAgICAgICAgIGlmICghd2luZG93LmZsdXguZ2VtaW5pLmhhc0tleSgpKSB7CiAgICAgICAgICAgICAgICBhbGVydCgiUGxlYXNlIHNldCB5b3VyIEdlbWluaSBBUEkgS2V5IGluIFNldHRpbmdzIGZpcnN0LiIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zdCByaWcgPSB3aW5kb3cuZmx1eC5yaWdNYW5hZ2VyOwogICAgICAgICAgICBpZiAoIXJpZy5tb2RlbCkgewogICAgICAgICAgICAgICAgYWxlcnQoIlBsZWFzZSBpbXBvcnQgYSBtb2RlbCBmaXJzdC4iKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gU2hvdyBMb2FkaW5nIE92ZXJsYXkKICAgICAgICAgICAgd2luZG93LmZsdXgubG9hZGVyLnNob3dMb2FkaW5nKHRydWUpOwogICAgICAgICAgICBjb25zdCBsb2FkaW5nVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nLXRleHQnKTsKICAgICAgICAgICAgaWYgKGxvYWRpbmdUZXh0KSBsb2FkaW5nVGV4dC5pbm5lclRleHQgPSAiR2VuZXJhdGluZyBBbmltYXRpb24uLi4iOwoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGNvbnN0IGJvbmVzID0gcmlnLmdldFNrZWxldG9uU3RydWN0dXJlKCk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRmx1eDogUmVxdWVzdGluZyBhbmltYXRpb24gZm9yOiIsIHByb21wdCk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNvbnN0IGFuaW1EYXRhID0gYXdhaXQgd2luZG93LmZsdXguZ2VtaW5pLmdlbmVyYXRlQW5pbWF0aW9uKHByb21wdCwgYm9uZXMpOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkZsdXg6IFJlY2VpdmVkIERhdGEiLCBhbmltRGF0YSk7CgogICAgICAgICAgICAgICAgY29uc3QgY2xpcCA9IHJpZy5jcmVhdGVBbmltYXRpb25Gcm9tSlNPTihhbmltRGF0YSk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIChjbGlwKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoQW5pbWF0aW9uTGlzdCgpOwogICAgICAgICAgICAgICAgICAgIHJpZy5wbGF5QW5pbWF0aW9uKGNsaXAubmFtZSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnBsYXlQYXVzZUJ0bikgdGhpcy5kb20ucGxheVBhdXNlQnRuLnRleHRDb250ZW50ID0gJ+KdmuKdmic7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGFsZXJ0KCJGYWlsZWQgdG8gY3JlYXRlIGFuaW1hdGlvbiBmcm9tIEFJIHJlc3BvbnNlLiIpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTsKICAgICAgICAgICAgICAgIGFsZXJ0KCJHZW5lcmF0aW9uIEZhaWxlZDogIiArIGUubWVzc2FnZSk7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAvLyBIaWRlIExvYWRpbmcgT3ZlcmxheQogICAgICAgICAgICAgICAgd2luZG93LmZsdXgubG9hZGVyLnNob3dMb2FkaW5nKGZhbHNlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZXhwb3J0R0xCKCkgewogICAgICAgICAgICBjb25zdCBtb2RlbCA9IHdpbmRvdy5mbHV4LmN1cnJlbnRNb2RlbDsKICAgICAgICAgICAgY29uc3QgYW5pbWF0aW9ucyA9IHdpbmRvdy5mbHV4LnJpZ01hbmFnZXIuYW5pbWF0aW9uczsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmICh3aW5kb3cuZmx1eC5leHBvcnRlcikgewogICAgICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxUZXh0ID0gdGhpcy5kb20uZXhwb3J0QnRuLnRleHRDb250ZW50OwogICAgICAgICAgICAgICAgdGhpcy5kb20uZXhwb3J0QnRuLnRleHRDb250ZW50ID0gIkV4cG9ydGluZy4uLiI7CiAgICAgICAgICAgICAgICB0aGlzLmRvbS5leHBvcnRCdG4uZGlzYWJsZWQgPSB0cnVlOwoKICAgICAgICAgICAgICAgIC8vIFNtYWxsIGRlbGF5IHRvIHJlbmRlciBVSSBjaGFuZ2UKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5mbHV4LmV4cG9ydGVyLmV4cG9ydE1vZGVsKG1vZGVsLCBhbmltYXRpb25zLCAnZmx1eF9jaGFyYWN0ZXIuZ2xiJyk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5kb20uZXhwb3J0QnRuLnRleHRDb250ZW50ID0gb3JpZ2luYWxUZXh0OwogICAgICAgICAgICAgICAgICAgIHRoaXMuZG9tLmV4cG9ydEJ0bi5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgfSwgNTApOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiRXhwb3J0ZXIgc2VydmljZSBub3QgYXZhaWxhYmxlIik7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIG9uTW9kZWxMb2FkZWQoKSB7CiAgICAgICAgICAgIHRoaXMucmVmcmVzaEFuaW1hdGlvbkxpc3QoKTsKICAgICAgICAgICAgLy8gUmVzZXQgY29udHJvbHMKICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnBsYXlQYXVzZUJ0bikgdGhpcy5kb20ucGxheVBhdXNlQnRuLnRleHRDb250ZW50ID0gJ+KWtic7CiAgICAgICAgICAgIHRoaXMudXBkYXRlU2xpZGVyKDAsIDApOwogICAgICAgIH0KCiAgICAgICAgcmVmcmVzaEFuaW1hdGlvbkxpc3QoKSB7CiAgICAgICAgICAgIGNvbnN0IGxpc3QgPSB0aGlzLmRvbS5hbmltTGlzdDsKICAgICAgICAgICAgaWYgKCFsaXN0KSByZXR1cm47CgogICAgICAgICAgICBsaXN0LmlubmVySFRNTCA9ICcnOwogICAgICAgICAgICBjb25zdCBhbmltcyA9IHdpbmRvdy5mbHV4LnJpZ01hbmFnZXIuZ2V0QW5pbWF0aW9uTGlzdCgpOwoKICAgICAgICAgICAgaWYgKGFuaW1zLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgbGlzdC5pbm5lckhUTUwgPSAnPGRpdiBjbGFzcz0iZW1wdHktc3RhdGUiPk5vIGFuaW1hdGlvbnMgZm91bmQ8L2Rpdj4nOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBhbmltcy5mb3JFYWNoKGFuaW0gPT4gewogICAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgaXRlbS5jbGFzc05hbWUgPSAnYW5pbS1pdGVtJzsKICAgICAgICAgICAgICAgIGl0ZW0udGV4dENvbnRlbnQgPSBhbmltLm5hbWU7CiAgICAgICAgICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgICAgIC8vIEhpZ2hsaWdodCBsb2dpYwogICAgICAgICAgICAgICAgICAgIEFycmF5LmZyb20obGlzdC5jaGlsZHJlbikuZm9yRWFjaChjID0+IGMuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykpOwogICAgICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gUGxheQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5mbHV4LnJpZ01hbmFnZXIucGxheUFuaW1hdGlvbihhbmltLm5hbWUpOwogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRvbS5wbGF5UGF1c2VCdG4pIHRoaXMuZG9tLnBsYXlQYXVzZUJ0bi50ZXh0Q29udGVudCA9ICfinZrinZonOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBsaXN0LmFwcGVuZENoaWxkKGl0ZW0pOwogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHVwZGF0ZSgpIHsKICAgICAgICAgICAgLy8gQ2FsbGVkIGV2ZXJ5IGZyYW1lCiAgICAgICAgICAgIGlmICh0aGlzLmlzRHJhZ2dpbmcpIHJldHVybjsgLy8gRG9uJ3QgZmlnaHQgdXNlciBpbnB1dAoKICAgICAgICAgICAgY29uc3QgcmlnID0gd2luZG93LmZsdXgucmlnTWFuYWdlcjsKICAgICAgICAgICAgaWYgKCFyaWcpIHJldHVybjsKCiAgICAgICAgICAgIGNvbnN0IHN0YXR1cyA9IHJpZy5nZXRTdGF0dXMoKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFVwZGF0ZSBUaW1lIERpc3BsYXlzCiAgICAgICAgICAgIGlmICh0aGlzLmRvbS50aW1lQ3VycmVudCkgdGhpcy5kb20udGltZUN1cnJlbnQudGV4dENvbnRlbnQgPSBzdGF0dXMudGltZS50b0ZpeGVkKDEpICsgJ3MnOwogICAgICAgICAgICBpZiAodGhpcy5kb20udGltZVRvdGFsKSB0aGlzLmRvbS50aW1lVG90YWwudGV4dENvbnRlbnQgPSBzdGF0dXMuZHVyYXRpb24udG9GaXhlZCgxKSArICdzJzsKCiAgICAgICAgICAgIC8vIFVwZGF0ZSBTbGlkZXIKICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnNsaWRlciAmJiBzdGF0dXMuZHVyYXRpb24gPiAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLmRvbS5zbGlkZXIudmFsdWUgPSBzdGF0dXMucHJvZ3Jlc3MgKiAxMDA7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFN5bmMgUGxheSBCdXR0b24gaWYgc3RhdGUgY2hhbmdlZCBleHRlcm5hbGx5IChlLmcuIGZpbmlzaCkKICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnBsYXlQYXVzZUJ0bikgewogICAgICAgICAgICAgICAgY29uc3Qgc3ltYm9sID0gc3RhdHVzLnBsYXlpbmcgPyAn4p2a4p2aJyA6ICfilrYnOwogICAgICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnBsYXlQYXVzZUJ0bi50ZXh0Q29udGVudCAhPT0gc3ltYm9sKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5kb20ucGxheVBhdXNlQnRuLnRleHRDb250ZW50ID0gc3ltYm9sOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHVwZGF0ZVNsaWRlcih0aW1lLCBkdXJhdGlvbikgewogICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnRpbWVDdXJyZW50KSB0aGlzLmRvbS50aW1lQ3VycmVudC50ZXh0Q29udGVudCA9IHRpbWUudG9GaXhlZCgxKSArICdzJzsKICAgICAgICAgICAgIGlmICh0aGlzLmRvbS50aW1lVG90YWwpIHRoaXMuZG9tLnRpbWVUb3RhbC50ZXh0Q29udGVudCA9IGR1cmF0aW9uLnRvRml4ZWQoMSkgKyAncyc7CiAgICAgICAgICAgICBpZiAodGhpcy5kb20uc2xpZGVyKSB0aGlzLmRvbS5zbGlkZXIudmFsdWUgPSAoZHVyYXRpb24gPiAwID8gKHRpbWUvZHVyYXRpb24pKjEwMCA6IDApOwogICAgICAgIH0KICAgIH0KCiAgICB3aW5kb3cuZmx1eC51aSA9IG5ldyBVSUNvbnRyb2xsZXIoKTsKICAgIAogICAgLy8gSW5pdCBpbW1lZGlhdGVseSBpZiBkb2N1bWVudCByZWFkeSwgb3Igd2FpdAogICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdjb21wbGV0ZScgfHwgZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2ludGVyYWN0aXZlJykgewogICAgICAgIHdpbmRvdy5mbHV4LnVpLmluaXQoKTsKICAgIH0gZWxzZSB7CiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB3aW5kb3cuZmx1eC51aS5pbml0KCkpOwogICAgfQp9KSgpOw==","./js/ui-controller.js":"data:text/javascript;base64,LyoqCiAqIFVJIENvbnRyb2xsZXIKICogTWFuYWdlcyBBbmltYXRpb24gTGlzdCwgUGxheWJhY2sgQ29udHJvbHMsIGFuZCBTY3J1YmJpbmcKICovCndpbmRvdy5mbHV4ID0gd2luZG93LmZsdXggfHwge307CgooZnVuY3Rpb24oKSB7CmNsYXNzIFVJQ29udHJvbGxlciB7CiAgICAgICAgY29uc3RydWN0b3IoKSB7CnRoaXMuZG9tID0gewogICAgICAgICAgICAgICAgYW5pbUxpc3Q6IG51bGwsCiAgICAgICAgICAgICAgICBwbGF5UGF1c2VCdG46IG51bGwsCiAgICAgICAgICAgICAgICBzdG9wQnRuOiBudWxsLAogICAgICAgICAgICAgICAgc2xpZGVyOiBudWxsLAogICAgICAgICAgICAgICAgdGltZUN1cnJlbnQ6IG51bGwsCiAgICAgICAgICAgICAgICB0aW1lVG90YWw6IG51bGwsCiAgICAgICAgICAgICAgICBzZXR0aW5nc01vZGFsOiBudWxsLAogICAgICAgICAgICAgICAgYXBpS2V5SW5wdXQ6IG51bGwsCiAgICAgICAgICAgICAgICBtb2RlbFNlbGVjdDogbnVsbCwKICAgICAgICAgICAgICAgIGdlblByb21wdDogbnVsbCwKICAgICAgICAgICAgICAgIGdlbkJ0bjogbnVsbCwKICAgICAgICAgICAgICAgIGV4cG9ydEJ0bjogbnVsbAogICAgICAgICAgICB9OwogICAgICAgICAgICB0aGlzLmlzRHJhZ2dpbmcgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGluaXQoKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJGbHV4OiBJbml0aWFsaXppbmcgVUkgQ29udHJvbGxlci4uLiIpOwogICAgICAgICAgICB0aGlzLmNhY2hlRE9NKCk7CiAgICAgICAgICAgIHRoaXMuYmluZEV2ZW50cygpOwogICAgICAgIH0KCmNhY2hlRE9NKCkgewogICAgICAgICAgICB0aGlzLmRvbS5hbmltTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhbmltLWxpc3QnKTsKICAgICAgICAgICAgdGhpcy5kb20ucGxheVBhdXNlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1wbGF5LXBhdXNlJyk7CiAgICAgICAgICAgIHRoaXMuZG9tLnN0b3BCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuLXN0b3AnKTsKICAgICAgICAgICAgdGhpcy5kb20uc2xpZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FuaW0tc2xpZGVyJyk7CiAgICAgICAgICAgIHRoaXMuZG9tLnRpbWVDdXJyZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RpbWUtY3VycmVudCcpOwogICAgICAgICAgICB0aGlzLmRvbS50aW1lVG90YWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGltZS10b3RhbCcpOwogICAgICAgICAgICB0aGlzLmRvbS5zZXR0aW5nc01vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NldHRpbmdzLW1vZGFsJyk7CiAgICAgICAgICAgIHRoaXMuZG9tLmFwaUtleUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwaS1rZXktaW5wdXQnKTsKICAgICAgICAgICAgdGhpcy5kb20ubW9kZWxTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kZWwtc2VsZWN0Jyk7CiAgICAgICAgICAgIHRoaXMuZG9tLmdlblByb21wdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnZW4tcHJvbXB0Jyk7CiAgICAgICAgICAgIHRoaXMuZG9tLmdlbkJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4tZ2VuZXJhdGUnKTsKICAgICAgICAgICAgdGhpcy5kb20uZXhwb3J0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1leHBvcnQnKTsKICAgICAgICB9CgogICAgICAgIGJpbmRFdmVudHMoKSB7CiAgICAgICAgICAgIC8vIFBsYXkvUGF1c2UKICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnBsYXlQYXVzZUJ0bikgewogICAgICAgICAgICAgICAgdGhpcy5kb20ucGxheVBhdXNlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHJpZyA9IHdpbmRvdy5mbHV4LnJpZ01hbmFnZXI7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhdHVzID0gcmlnLmdldFN0YXR1cygpOwogICAgICAgICAgICAgICAgICAgIGlmIChzdGF0dXMucGxheWluZykgewogICAgICAgICAgICAgICAgICAgICAgICByaWcucGF1c2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kb20ucGxheVBhdXNlQnRuLnRleHRDb250ZW50ID0gJ+KWtic7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmlnLnJlc3VtZSgpOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbS5wbGF5UGF1c2VCdG4udGV4dENvbnRlbnQgPSAn4p2a4p2aJzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gU3RvcAogICAgICAgICAgICBpZiAodGhpcy5kb20uc3RvcEJ0bikgewogICAgICAgICAgICAgICAgdGhpcy5kb20uc3RvcEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZmx1eC5yaWdNYW5hZ2VyLnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbS5wbGF5UGF1c2VCdG4udGV4dENvbnRlbnQgPSAn4pa2JzsKICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNsaWRlcigwLCAwKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBTbGlkZXIgU2NydWJiaW5nCiAgICAgICAgICAgIGlmICh0aGlzLmRvbS5zbGlkZXIpIHsKICAgICAgICAgICAgICAgIHRoaXMuZG9tLnNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIChlKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0RyYWdnaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWwgPSBwYXJzZUZsb2F0KGUudGFyZ2V0LnZhbHVlKSAvIDEwMDsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZmx1eC5yaWdNYW5hZ2VyLnNjcnViKHZhbCk7CiAgICAgICAgICAgICAgICAgICAgd2luZG93LmZsdXgucmlnTWFuYWdlci5wYXVzZSgpOyAvLyBQYXVzZSB3aGlsZSBzY3J1YmJpbmcKICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbS5wbGF5UGF1c2VCdG4udGV4dENvbnRlbnQgPSAn4pa2JzsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIHRoaXMuZG9tLnNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMuaXNEcmFnZ2luZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgfSk7Cn0KCiAgICAgICAgICAgIC8vIFNldHRpbmdzIE1vZGFsCiAgICAgICAgICAgIGNvbnN0IGJ0blNldHRpbmdzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1zZXR0aW5ncycpOwogICAgICAgICAgICBjb25zdCBidG5TYXZlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1zYXZlLXNldHRpbmdzJyk7CiAgICAgICAgICAgIGNvbnN0IGJ0bkNhbmNlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4tY2FuY2VsLXNldHRpbmdzJyk7CgogICAgICAgICAgICBpZiAoYnRuU2V0dGluZ3MpIHsKICAgICAgICAgICAgICAgIGJ0blNldHRpbmdzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewp0aGlzLmRvbS5hcGlLZXlJbnB1dC52YWx1ZSA9IHdpbmRvdy5mbHV4LmdlbWluaS5nZXRBcGlLZXlzUmF3KCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZG9tLm1vZGVsU2VsZWN0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZG9tLm1vZGVsU2VsZWN0LnZhbHVlID0gd2luZG93LmZsdXguZ2VtaW5pLmdldE1vZGVsKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHRoaXMuZG9tLnNldHRpbmdzTW9kYWwuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoYnRuU2F2ZSkgewogICAgICAgICAgICAgICAgYnRuU2F2ZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKd2luZG93LmZsdXguZ2VtaW5pLnNldEFwaUtleXModGhpcy5kb20uYXBpS2V5SW5wdXQudmFsdWUpOwogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRvbS5tb2RlbFNlbGVjdCkgewogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZmx1eC5nZW1pbmkuc2V0TW9kZWwodGhpcy5kb20ubW9kZWxTZWxlY3QudmFsdWUpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbS5zZXR0aW5nc01vZGFsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGJ0bkNhbmNlbCkgewogICAgICAgICAgICAgICAgYnRuQ2FuY2VsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMuZG9tLnNldHRpbmdzTW9kYWwuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBHZW5lcmF0aW9uCiAgICAgICAgICAgIGlmICh0aGlzLmRvbS5nZW5CdG4pIHsKICAgICAgICAgICAgICAgIHRoaXMuZG9tLmdlbkJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHsKICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZUdlbmVyYXRpb24oKTsKICAgICAgICAgICAgICAgIH0pOwp9CgogICAgICAgICAgICAvLyBFeHBvcnQKICAgICAgICAgICAgaWYgKHRoaXMuZG9tLmV4cG9ydEJ0bikgewogICAgICAgICAgICAgICAgdGhpcy5kb20uZXhwb3J0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMuZXhwb3J0R0xCKCk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgIH0KCmFzeW5jIGhhbmRsZUdlbmVyYXRpb24oKSB7CiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuZG9tLmdlblByb21wdC52YWx1ZTsKICAgICAgICAgICAgaWYgKCFwcm9tcHQpIHJldHVybjsKCiAgICAgICAgICAgIGlmICghd2luZG93LmZsdXguZ2VtaW5pLmhhc0tleSgpKSB7CiAgICAgICAgICAgICAgICBhbGVydCgiUGxlYXNlIHNldCB5b3VyIEdlbWluaSBBUEkgS2V5IGluIFNldHRpbmdzIGZpcnN0LiIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zdCByaWcgPSB3aW5kb3cuZmx1eC5yaWdNYW5hZ2VyOwogICAgICAgICAgICBpZiAoIXJpZy5tb2RlbCkgewogICAgICAgICAgICAgICAgYWxlcnQoIlBsZWFzZSBpbXBvcnQgYSBtb2RlbCBmaXJzdC4iKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gU2hvdyBMb2FkaW5nIE92ZXJsYXkKICAgICAgICAgICAgd2luZG93LmZsdXgubG9hZGVyLnNob3dMb2FkaW5nKHRydWUpOwogICAgICAgICAgICBjb25zdCBsb2FkaW5nVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nLXRleHQnKTsKICAgICAgICAgICAgaWYgKGxvYWRpbmdUZXh0KSBsb2FkaW5nVGV4dC5pbm5lclRleHQgPSAiR2VuZXJhdGluZyBBbmltYXRpb24uLi4iOwoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGNvbnN0IGJvbmVzID0gcmlnLmdldFNrZWxldG9uU3RydWN0dXJlKCk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRmx1eDogUmVxdWVzdGluZyBhbmltYXRpb24gZm9yOiIsIHByb21wdCk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNvbnN0IGFuaW1EYXRhID0gYXdhaXQgd2luZG93LmZsdXguZ2VtaW5pLmdlbmVyYXRlQW5pbWF0aW9uKHByb21wdCwgYm9uZXMpOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkZsdXg6IFJlY2VpdmVkIERhdGEiLCBhbmltRGF0YSk7CgogICAgICAgICAgICAgICAgY29uc3QgY2xpcCA9IHJpZy5jcmVhdGVBbmltYXRpb25Gcm9tSlNPTihhbmltRGF0YSk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIChjbGlwKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoQW5pbWF0aW9uTGlzdCgpOwogICAgICAgICAgICAgICAgICAgIHJpZy5wbGF5QW5pbWF0aW9uKGNsaXAubmFtZSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnBsYXlQYXVzZUJ0bikgdGhpcy5kb20ucGxheVBhdXNlQnRuLnRleHRDb250ZW50ID0gJ+KdmuKdmic7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGFsZXJ0KCJGYWlsZWQgdG8gY3JlYXRlIGFuaW1hdGlvbiBmcm9tIEFJIHJlc3BvbnNlLiIpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTsKICAgICAgICAgICAgICAgIGFsZXJ0KCJHZW5lcmF0aW9uIEZhaWxlZDogIiArIGUubWVzc2FnZSk7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAvLyBIaWRlIExvYWRpbmcgT3ZlcmxheQogICAgICAgICAgICAgICAgd2luZG93LmZsdXgubG9hZGVyLnNob3dMb2FkaW5nKGZhbHNlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZXhwb3J0R0xCKCkgewogICAgICAgICAgICBjb25zdCBtb2RlbCA9IHdpbmRvdy5mbHV4LmN1cnJlbnRNb2RlbDsKICAgICAgICAgICAgY29uc3QgYW5pbWF0aW9ucyA9IHdpbmRvdy5mbHV4LnJpZ01hbmFnZXIuYW5pbWF0aW9uczsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmICh3aW5kb3cuZmx1eC5leHBvcnRlcikgewogICAgICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxUZXh0ID0gdGhpcy5kb20uZXhwb3J0QnRuLnRleHRDb250ZW50OwogICAgICAgICAgICAgICAgdGhpcy5kb20uZXhwb3J0QnRuLnRleHRDb250ZW50ID0gIkV4cG9ydGluZy4uLiI7CiAgICAgICAgICAgICAgICB0aGlzLmRvbS5leHBvcnRCdG4uZGlzYWJsZWQgPSB0cnVlOwoKICAgICAgICAgICAgICAgIC8vIFNtYWxsIGRlbGF5IHRvIHJlbmRlciBVSSBjaGFuZ2UKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5mbHV4LmV4cG9ydGVyLmV4cG9ydE1vZGVsKG1vZGVsLCBhbmltYXRpb25zLCAnZmx1eF9jaGFyYWN0ZXIuZ2xiJyk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5kb20uZXhwb3J0QnRuLnRleHRDb250ZW50ID0gb3JpZ2luYWxUZXh0OwogICAgICAgICAgICAgICAgICAgIHRoaXMuZG9tLmV4cG9ydEJ0bi5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgfSwgNTApOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiRXhwb3J0ZXIgc2VydmljZSBub3QgYXZhaWxhYmxlIik7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIG9uTW9kZWxMb2FkZWQoKSB7CiAgICAgICAgICAgIHRoaXMucmVmcmVzaEFuaW1hdGlvbkxpc3QoKTsKICAgICAgICAgICAgLy8gUmVzZXQgY29udHJvbHMKICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnBsYXlQYXVzZUJ0bikgdGhpcy5kb20ucGxheVBhdXNlQnRuLnRleHRDb250ZW50ID0gJ+KWtic7CiAgICAgICAgICAgIHRoaXMudXBkYXRlU2xpZGVyKDAsIDApOwogICAgICAgIH0KCiAgICAgICAgcmVmcmVzaEFuaW1hdGlvbkxpc3QoKSB7CiAgICAgICAgICAgIGNvbnN0IGxpc3QgPSB0aGlzLmRvbS5hbmltTGlzdDsKICAgICAgICAgICAgaWYgKCFsaXN0KSByZXR1cm47CgogICAgICAgICAgICBsaXN0LmlubmVySFRNTCA9ICcnOwogICAgICAgICAgICBjb25zdCBhbmltcyA9IHdpbmRvdy5mbHV4LnJpZ01hbmFnZXIuZ2V0QW5pbWF0aW9uTGlzdCgpOwoKICAgICAgICAgICAgaWYgKGFuaW1zLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgbGlzdC5pbm5lckhUTUwgPSAnPGRpdiBjbGFzcz0iZW1wdHktc3RhdGUiPk5vIGFuaW1hdGlvbnMgZm91bmQ8L2Rpdj4nOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBhbmltcy5mb3JFYWNoKGFuaW0gPT4gewogICAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgaXRlbS5jbGFzc05hbWUgPSAnYW5pbS1pdGVtJzsKICAgICAgICAgICAgICAgIGl0ZW0udGV4dENvbnRlbnQgPSBhbmltLm5hbWU7CiAgICAgICAgICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgICAgIC8vIEhpZ2hsaWdodCBsb2dpYwogICAgICAgICAgICAgICAgICAgIEFycmF5LmZyb20obGlzdC5jaGlsZHJlbikuZm9yRWFjaChjID0+IGMuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykpOwogICAgICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gUGxheQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5mbHV4LnJpZ01hbmFnZXIucGxheUFuaW1hdGlvbihhbmltLm5hbWUpOwogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRvbS5wbGF5UGF1c2VCdG4pIHRoaXMuZG9tLnBsYXlQYXVzZUJ0bi50ZXh0Q29udGVudCA9ICfinZrinZonOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBsaXN0LmFwcGVuZENoaWxkKGl0ZW0pOwogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHVwZGF0ZSgpIHsKICAgICAgICAgICAgLy8gQ2FsbGVkIGV2ZXJ5IGZyYW1lCiAgICAgICAgICAgIGlmICh0aGlzLmlzRHJhZ2dpbmcpIHJldHVybjsgLy8gRG9uJ3QgZmlnaHQgdXNlciBpbnB1dAoKICAgICAgICAgICAgY29uc3QgcmlnID0gd2luZG93LmZsdXgucmlnTWFuYWdlcjsKICAgICAgICAgICAgaWYgKCFyaWcpIHJldHVybjsKCiAgICAgICAgICAgIGNvbnN0IHN0YXR1cyA9IHJpZy5nZXRTdGF0dXMoKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFVwZGF0ZSBUaW1lIERpc3BsYXlzCiAgICAgICAgICAgIGlmICh0aGlzLmRvbS50aW1lQ3VycmVudCkgdGhpcy5kb20udGltZUN1cnJlbnQudGV4dENvbnRlbnQgPSBzdGF0dXMudGltZS50b0ZpeGVkKDEpICsgJ3MnOwogICAgICAgICAgICBpZiAodGhpcy5kb20udGltZVRvdGFsKSB0aGlzLmRvbS50aW1lVG90YWwudGV4dENvbnRlbnQgPSBzdGF0dXMuZHVyYXRpb24udG9GaXhlZCgxKSArICdzJzsKCiAgICAgICAgICAgIC8vIFVwZGF0ZSBTbGlkZXIKICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnNsaWRlciAmJiBzdGF0dXMuZHVyYXRpb24gPiAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLmRvbS5zbGlkZXIudmFsdWUgPSBzdGF0dXMucHJvZ3Jlc3MgKiAxMDA7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFN5bmMgUGxheSBCdXR0b24gaWYgc3RhdGUgY2hhbmdlZCBleHRlcm5hbGx5IChlLmcuIGZpbmlzaCkKICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnBsYXlQYXVzZUJ0bikgewogICAgICAgICAgICAgICAgY29uc3Qgc3ltYm9sID0gc3RhdHVzLnBsYXlpbmcgPyAn4p2a4p2aJyA6ICfilrYnOwogICAgICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnBsYXlQYXVzZUJ0bi50ZXh0Q29udGVudCAhPT0gc3ltYm9sKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5kb20ucGxheVBhdXNlQnRuLnRleHRDb250ZW50ID0gc3ltYm9sOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHVwZGF0ZVNsaWRlcih0aW1lLCBkdXJhdGlvbikgewogICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnRpbWVDdXJyZW50KSB0aGlzLmRvbS50aW1lQ3VycmVudC50ZXh0Q29udGVudCA9IHRpbWUudG9GaXhlZCgxKSArICdzJzsKICAgICAgICAgICAgIGlmICh0aGlzLmRvbS50aW1lVG90YWwpIHRoaXMuZG9tLnRpbWVUb3RhbC50ZXh0Q29udGVudCA9IGR1cmF0aW9uLnRvRml4ZWQoMSkgKyAncyc7CiAgICAgICAgICAgICBpZiAodGhpcy5kb20uc2xpZGVyKSB0aGlzLmRvbS5zbGlkZXIudmFsdWUgPSAoZHVyYXRpb24gPiAwID8gKHRpbWUvZHVyYXRpb24pKjEwMCA6IDApOwogICAgICAgIH0KICAgIH0KCiAgICB3aW5kb3cuZmx1eC51aSA9IG5ldyBVSUNvbnRyb2xsZXIoKTsKICAgIAogICAgLy8gSW5pdCBpbW1lZGlhdGVseSBpZiBkb2N1bWVudCByZWFkeSwgb3Igd2FpdAogICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdjb21wbGV0ZScgfHwgZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2ludGVyYWN0aXZlJykgewogICAgICAgIHdpbmRvdy5mbHV4LnVpLmluaXQoKTsKICAgIH0gZWxzZSB7CiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB3aW5kb3cuZmx1eC51aS5pbml0KCkpOwogICAgfQp9KSgpOw==","/js/ui-controller.js":"data:text/javascript;base64,LyoqCiAqIFVJIENvbnRyb2xsZXIKICogTWFuYWdlcyBBbmltYXRpb24gTGlzdCwgUGxheWJhY2sgQ29udHJvbHMsIGFuZCBTY3J1YmJpbmcKICovCndpbmRvdy5mbHV4ID0gd2luZG93LmZsdXggfHwge307CgooZnVuY3Rpb24oKSB7CmNsYXNzIFVJQ29udHJvbGxlciB7CiAgICAgICAgY29uc3RydWN0b3IoKSB7CnRoaXMuZG9tID0gewogICAgICAgICAgICAgICAgYW5pbUxpc3Q6IG51bGwsCiAgICAgICAgICAgICAgICBwbGF5UGF1c2VCdG46IG51bGwsCiAgICAgICAgICAgICAgICBzdG9wQnRuOiBudWxsLAogICAgICAgICAgICAgICAgc2xpZGVyOiBudWxsLAogICAgICAgICAgICAgICAgdGltZUN1cnJlbnQ6IG51bGwsCiAgICAgICAgICAgICAgICB0aW1lVG90YWw6IG51bGwsCiAgICAgICAgICAgICAgICBzZXR0aW5nc01vZGFsOiBudWxsLAogICAgICAgICAgICAgICAgYXBpS2V5SW5wdXQ6IG51bGwsCiAgICAgICAgICAgICAgICBtb2RlbFNlbGVjdDogbnVsbCwKICAgICAgICAgICAgICAgIGdlblByb21wdDogbnVsbCwKICAgICAgICAgICAgICAgIGdlbkJ0bjogbnVsbCwKICAgICAgICAgICAgICAgIGV4cG9ydEJ0bjogbnVsbAogICAgICAgICAgICB9OwogICAgICAgICAgICB0aGlzLmlzRHJhZ2dpbmcgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGluaXQoKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJGbHV4OiBJbml0aWFsaXppbmcgVUkgQ29udHJvbGxlci4uLiIpOwogICAgICAgICAgICB0aGlzLmNhY2hlRE9NKCk7CiAgICAgICAgICAgIHRoaXMuYmluZEV2ZW50cygpOwogICAgICAgIH0KCmNhY2hlRE9NKCkgewogICAgICAgICAgICB0aGlzLmRvbS5hbmltTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhbmltLWxpc3QnKTsKICAgICAgICAgICAgdGhpcy5kb20ucGxheVBhdXNlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1wbGF5LXBhdXNlJyk7CiAgICAgICAgICAgIHRoaXMuZG9tLnN0b3BCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuLXN0b3AnKTsKICAgICAgICAgICAgdGhpcy5kb20uc2xpZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FuaW0tc2xpZGVyJyk7CiAgICAgICAgICAgIHRoaXMuZG9tLnRpbWVDdXJyZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RpbWUtY3VycmVudCcpOwogICAgICAgICAgICB0aGlzLmRvbS50aW1lVG90YWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGltZS10b3RhbCcpOwogICAgICAgICAgICB0aGlzLmRvbS5zZXR0aW5nc01vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NldHRpbmdzLW1vZGFsJyk7CiAgICAgICAgICAgIHRoaXMuZG9tLmFwaUtleUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwaS1rZXktaW5wdXQnKTsKICAgICAgICAgICAgdGhpcy5kb20ubW9kZWxTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kZWwtc2VsZWN0Jyk7CiAgICAgICAgICAgIHRoaXMuZG9tLmdlblByb21wdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnZW4tcHJvbXB0Jyk7CiAgICAgICAgICAgIHRoaXMuZG9tLmdlbkJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4tZ2VuZXJhdGUnKTsKICAgICAgICAgICAgdGhpcy5kb20uZXhwb3J0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1leHBvcnQnKTsKICAgICAgICB9CgogICAgICAgIGJpbmRFdmVudHMoKSB7CiAgICAgICAgICAgIC8vIFBsYXkvUGF1c2UKICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnBsYXlQYXVzZUJ0bikgewogICAgICAgICAgICAgICAgdGhpcy5kb20ucGxheVBhdXNlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHJpZyA9IHdpbmRvdy5mbHV4LnJpZ01hbmFnZXI7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhdHVzID0gcmlnLmdldFN0YXR1cygpOwogICAgICAgICAgICAgICAgICAgIGlmIChzdGF0dXMucGxheWluZykgewogICAgICAgICAgICAgICAgICAgICAgICByaWcucGF1c2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kb20ucGxheVBhdXNlQnRuLnRleHRDb250ZW50ID0gJ+KWtic7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmlnLnJlc3VtZSgpOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbS5wbGF5UGF1c2VCdG4udGV4dENvbnRlbnQgPSAn4p2a4p2aJzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gU3RvcAogICAgICAgICAgICBpZiAodGhpcy5kb20uc3RvcEJ0bikgewogICAgICAgICAgICAgICAgdGhpcy5kb20uc3RvcEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZmx1eC5yaWdNYW5hZ2VyLnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbS5wbGF5UGF1c2VCdG4udGV4dENvbnRlbnQgPSAn4pa2JzsKICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNsaWRlcigwLCAwKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBTbGlkZXIgU2NydWJiaW5nCiAgICAgICAgICAgIGlmICh0aGlzLmRvbS5zbGlkZXIpIHsKICAgICAgICAgICAgICAgIHRoaXMuZG9tLnNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIChlKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0RyYWdnaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWwgPSBwYXJzZUZsb2F0KGUudGFyZ2V0LnZhbHVlKSAvIDEwMDsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZmx1eC5yaWdNYW5hZ2VyLnNjcnViKHZhbCk7CiAgICAgICAgICAgICAgICAgICAgd2luZG93LmZsdXgucmlnTWFuYWdlci5wYXVzZSgpOyAvLyBQYXVzZSB3aGlsZSBzY3J1YmJpbmcKICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbS5wbGF5UGF1c2VCdG4udGV4dENvbnRlbnQgPSAn4pa2JzsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIHRoaXMuZG9tLnNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMuaXNEcmFnZ2luZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgfSk7Cn0KCiAgICAgICAgICAgIC8vIFNldHRpbmdzIE1vZGFsCiAgICAgICAgICAgIGNvbnN0IGJ0blNldHRpbmdzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1zZXR0aW5ncycpOwogICAgICAgICAgICBjb25zdCBidG5TYXZlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1zYXZlLXNldHRpbmdzJyk7CiAgICAgICAgICAgIGNvbnN0IGJ0bkNhbmNlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4tY2FuY2VsLXNldHRpbmdzJyk7CgogICAgICAgICAgICBpZiAoYnRuU2V0dGluZ3MpIHsKICAgICAgICAgICAgICAgIGJ0blNldHRpbmdzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewp0aGlzLmRvbS5hcGlLZXlJbnB1dC52YWx1ZSA9IHdpbmRvdy5mbHV4LmdlbWluaS5nZXRBcGlLZXlzUmF3KCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZG9tLm1vZGVsU2VsZWN0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZG9tLm1vZGVsU2VsZWN0LnZhbHVlID0gd2luZG93LmZsdXguZ2VtaW5pLmdldE1vZGVsKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHRoaXMuZG9tLnNldHRpbmdzTW9kYWwuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoYnRuU2F2ZSkgewogICAgICAgICAgICAgICAgYnRuU2F2ZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKd2luZG93LmZsdXguZ2VtaW5pLnNldEFwaUtleXModGhpcy5kb20uYXBpS2V5SW5wdXQudmFsdWUpOwogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRvbS5tb2RlbFNlbGVjdCkgewogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZmx1eC5nZW1pbmkuc2V0TW9kZWwodGhpcy5kb20ubW9kZWxTZWxlY3QudmFsdWUpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbS5zZXR0aW5nc01vZGFsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGJ0bkNhbmNlbCkgewogICAgICAgICAgICAgICAgYnRuQ2FuY2VsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMuZG9tLnNldHRpbmdzTW9kYWwuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBHZW5lcmF0aW9uCiAgICAgICAgICAgIGlmICh0aGlzLmRvbS5nZW5CdG4pIHsKICAgICAgICAgICAgICAgIHRoaXMuZG9tLmdlbkJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHsKICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZUdlbmVyYXRpb24oKTsKICAgICAgICAgICAgICAgIH0pOwp9CgogICAgICAgICAgICAvLyBFeHBvcnQKICAgICAgICAgICAgaWYgKHRoaXMuZG9tLmV4cG9ydEJ0bikgewogICAgICAgICAgICAgICAgdGhpcy5kb20uZXhwb3J0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMuZXhwb3J0R0xCKCk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgIH0KCmFzeW5jIGhhbmRsZUdlbmVyYXRpb24oKSB7CiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuZG9tLmdlblByb21wdC52YWx1ZTsKICAgICAgICAgICAgaWYgKCFwcm9tcHQpIHJldHVybjsKCiAgICAgICAgICAgIGlmICghd2luZG93LmZsdXguZ2VtaW5pLmhhc0tleSgpKSB7CiAgICAgICAgICAgICAgICBhbGVydCgiUGxlYXNlIHNldCB5b3VyIEdlbWluaSBBUEkgS2V5IGluIFNldHRpbmdzIGZpcnN0LiIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zdCByaWcgPSB3aW5kb3cuZmx1eC5yaWdNYW5hZ2VyOwogICAgICAgICAgICBpZiAoIXJpZy5tb2RlbCkgewogICAgICAgICAgICAgICAgYWxlcnQoIlBsZWFzZSBpbXBvcnQgYSBtb2RlbCBmaXJzdC4iKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gU2hvdyBMb2FkaW5nIE92ZXJsYXkKICAgICAgICAgICAgd2luZG93LmZsdXgubG9hZGVyLnNob3dMb2FkaW5nKHRydWUpOwogICAgICAgICAgICBjb25zdCBsb2FkaW5nVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nLXRleHQnKTsKICAgICAgICAgICAgaWYgKGxvYWRpbmdUZXh0KSBsb2FkaW5nVGV4dC5pbm5lclRleHQgPSAiR2VuZXJhdGluZyBBbmltYXRpb24uLi4iOwoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGNvbnN0IGJvbmVzID0gcmlnLmdldFNrZWxldG9uU3RydWN0dXJlKCk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRmx1eDogUmVxdWVzdGluZyBhbmltYXRpb24gZm9yOiIsIHByb21wdCk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNvbnN0IGFuaW1EYXRhID0gYXdhaXQgd2luZG93LmZsdXguZ2VtaW5pLmdlbmVyYXRlQW5pbWF0aW9uKHByb21wdCwgYm9uZXMpOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkZsdXg6IFJlY2VpdmVkIERhdGEiLCBhbmltRGF0YSk7CgogICAgICAgICAgICAgICAgY29uc3QgY2xpcCA9IHJpZy5jcmVhdGVBbmltYXRpb25Gcm9tSlNPTihhbmltRGF0YSk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIChjbGlwKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoQW5pbWF0aW9uTGlzdCgpOwogICAgICAgICAgICAgICAgICAgIHJpZy5wbGF5QW5pbWF0aW9uKGNsaXAubmFtZSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnBsYXlQYXVzZUJ0bikgdGhpcy5kb20ucGxheVBhdXNlQnRuLnRleHRDb250ZW50ID0gJ+KdmuKdmic7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGFsZXJ0KCJGYWlsZWQgdG8gY3JlYXRlIGFuaW1hdGlvbiBmcm9tIEFJIHJlc3BvbnNlLiIpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTsKICAgICAgICAgICAgICAgIGFsZXJ0KCJHZW5lcmF0aW9uIEZhaWxlZDogIiArIGUubWVzc2FnZSk7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAvLyBIaWRlIExvYWRpbmcgT3ZlcmxheQogICAgICAgICAgICAgICAgd2luZG93LmZsdXgubG9hZGVyLnNob3dMb2FkaW5nKGZhbHNlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZXhwb3J0R0xCKCkgewogICAgICAgICAgICBjb25zdCBtb2RlbCA9IHdpbmRvdy5mbHV4LmN1cnJlbnRNb2RlbDsKICAgICAgICAgICAgY29uc3QgYW5pbWF0aW9ucyA9IHdpbmRvdy5mbHV4LnJpZ01hbmFnZXIuYW5pbWF0aW9uczsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmICh3aW5kb3cuZmx1eC5leHBvcnRlcikgewogICAgICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxUZXh0ID0gdGhpcy5kb20uZXhwb3J0QnRuLnRleHRDb250ZW50OwogICAgICAgICAgICAgICAgdGhpcy5kb20uZXhwb3J0QnRuLnRleHRDb250ZW50ID0gIkV4cG9ydGluZy4uLiI7CiAgICAgICAgICAgICAgICB0aGlzLmRvbS5leHBvcnRCdG4uZGlzYWJsZWQgPSB0cnVlOwoKICAgICAgICAgICAgICAgIC8vIFNtYWxsIGRlbGF5IHRvIHJlbmRlciBVSSBjaGFuZ2UKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5mbHV4LmV4cG9ydGVyLmV4cG9ydE1vZGVsKG1vZGVsLCBhbmltYXRpb25zLCAnZmx1eF9jaGFyYWN0ZXIuZ2xiJyk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5kb20uZXhwb3J0QnRuLnRleHRDb250ZW50ID0gb3JpZ2luYWxUZXh0OwogICAgICAgICAgICAgICAgICAgIHRoaXMuZG9tLmV4cG9ydEJ0bi5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgfSwgNTApOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiRXhwb3J0ZXIgc2VydmljZSBub3QgYXZhaWxhYmxlIik7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIG9uTW9kZWxMb2FkZWQoKSB7CiAgICAgICAgICAgIHRoaXMucmVmcmVzaEFuaW1hdGlvbkxpc3QoKTsKICAgICAgICAgICAgLy8gUmVzZXQgY29udHJvbHMKICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnBsYXlQYXVzZUJ0bikgdGhpcy5kb20ucGxheVBhdXNlQnRuLnRleHRDb250ZW50ID0gJ+KWtic7CiAgICAgICAgICAgIHRoaXMudXBkYXRlU2xpZGVyKDAsIDApOwogICAgICAgIH0KCiAgICAgICAgcmVmcmVzaEFuaW1hdGlvbkxpc3QoKSB7CiAgICAgICAgICAgIGNvbnN0IGxpc3QgPSB0aGlzLmRvbS5hbmltTGlzdDsKICAgICAgICAgICAgaWYgKCFsaXN0KSByZXR1cm47CgogICAgICAgICAgICBsaXN0LmlubmVySFRNTCA9ICcnOwogICAgICAgICAgICBjb25zdCBhbmltcyA9IHdpbmRvdy5mbHV4LnJpZ01hbmFnZXIuZ2V0QW5pbWF0aW9uTGlzdCgpOwoKICAgICAgICAgICAgaWYgKGFuaW1zLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgbGlzdC5pbm5lckhUTUwgPSAnPGRpdiBjbGFzcz0iZW1wdHktc3RhdGUiPk5vIGFuaW1hdGlvbnMgZm91bmQ8L2Rpdj4nOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBhbmltcy5mb3JFYWNoKGFuaW0gPT4gewogICAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgaXRlbS5jbGFzc05hbWUgPSAnYW5pbS1pdGVtJzsKICAgICAgICAgICAgICAgIGl0ZW0udGV4dENvbnRlbnQgPSBhbmltLm5hbWU7CiAgICAgICAgICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgICAgIC8vIEhpZ2hsaWdodCBsb2dpYwogICAgICAgICAgICAgICAgICAgIEFycmF5LmZyb20obGlzdC5jaGlsZHJlbikuZm9yRWFjaChjID0+IGMuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykpOwogICAgICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gUGxheQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5mbHV4LnJpZ01hbmFnZXIucGxheUFuaW1hdGlvbihhbmltLm5hbWUpOwogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRvbS5wbGF5UGF1c2VCdG4pIHRoaXMuZG9tLnBsYXlQYXVzZUJ0bi50ZXh0Q29udGVudCA9ICfinZrinZonOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBsaXN0LmFwcGVuZENoaWxkKGl0ZW0pOwogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHVwZGF0ZSgpIHsKICAgICAgICAgICAgLy8gQ2FsbGVkIGV2ZXJ5IGZyYW1lCiAgICAgICAgICAgIGlmICh0aGlzLmlzRHJhZ2dpbmcpIHJldHVybjsgLy8gRG9uJ3QgZmlnaHQgdXNlciBpbnB1dAoKICAgICAgICAgICAgY29uc3QgcmlnID0gd2luZG93LmZsdXgucmlnTWFuYWdlcjsKICAgICAgICAgICAgaWYgKCFyaWcpIHJldHVybjsKCiAgICAgICAgICAgIGNvbnN0IHN0YXR1cyA9IHJpZy5nZXRTdGF0dXMoKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFVwZGF0ZSBUaW1lIERpc3BsYXlzCiAgICAgICAgICAgIGlmICh0aGlzLmRvbS50aW1lQ3VycmVudCkgdGhpcy5kb20udGltZUN1cnJlbnQudGV4dENvbnRlbnQgPSBzdGF0dXMudGltZS50b0ZpeGVkKDEpICsgJ3MnOwogICAgICAgICAgICBpZiAodGhpcy5kb20udGltZVRvdGFsKSB0aGlzLmRvbS50aW1lVG90YWwudGV4dENvbnRlbnQgPSBzdGF0dXMuZHVyYXRpb24udG9GaXhlZCgxKSArICdzJzsKCiAgICAgICAgICAgIC8vIFVwZGF0ZSBTbGlkZXIKICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnNsaWRlciAmJiBzdGF0dXMuZHVyYXRpb24gPiAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLmRvbS5zbGlkZXIudmFsdWUgPSBzdGF0dXMucHJvZ3Jlc3MgKiAxMDA7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFN5bmMgUGxheSBCdXR0b24gaWYgc3RhdGUgY2hhbmdlZCBleHRlcm5hbGx5IChlLmcuIGZpbmlzaCkKICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnBsYXlQYXVzZUJ0bikgewogICAgICAgICAgICAgICAgY29uc3Qgc3ltYm9sID0gc3RhdHVzLnBsYXlpbmcgPyAn4p2a4p2aJyA6ICfilrYnOwogICAgICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnBsYXlQYXVzZUJ0bi50ZXh0Q29udGVudCAhPT0gc3ltYm9sKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5kb20ucGxheVBhdXNlQnRuLnRleHRDb250ZW50ID0gc3ltYm9sOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHVwZGF0ZVNsaWRlcih0aW1lLCBkdXJhdGlvbikgewogICAgICAgICAgICAgaWYgKHRoaXMuZG9tLnRpbWVDdXJyZW50KSB0aGlzLmRvbS50aW1lQ3VycmVudC50ZXh0Q29udGVudCA9IHRpbWUudG9GaXhlZCgxKSArICdzJzsKICAgICAgICAgICAgIGlmICh0aGlzLmRvbS50aW1lVG90YWwpIHRoaXMuZG9tLnRpbWVUb3RhbC50ZXh0Q29udGVudCA9IGR1cmF0aW9uLnRvRml4ZWQoMSkgKyAncyc7CiAgICAgICAgICAgICBpZiAodGhpcy5kb20uc2xpZGVyKSB0aGlzLmRvbS5zbGlkZXIudmFsdWUgPSAoZHVyYXRpb24gPiAwID8gKHRpbWUvZHVyYXRpb24pKjEwMCA6IDApOwogICAgICAgIH0KICAgIH0KCiAgICB3aW5kb3cuZmx1eC51aSA9IG5ldyBVSUNvbnRyb2xsZXIoKTsKICAgIAogICAgLy8gSW5pdCBpbW1lZGlhdGVseSBpZiBkb2N1bWVudCByZWFkeSwgb3Igd2FpdAogICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdjb21wbGV0ZScgfHwgZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2ludGVyYWN0aXZlJykgewogICAgICAgIHdpbmRvdy5mbHV4LnVpLmluaXQoKTsKICAgIH0gZWxzZSB7CiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB3aW5kb3cuZmx1eC51aS5pbml0KCkpOwogICAgfQp9KSgpOw==","js/gemini-service.js":"data:text/javascript;base64,LyoqCiAqIEdlbWluaVNlcnZpY2UKICogSGFuZGxlcyBjb21tdW5pY2F0aW9uIHdpdGggR29vZ2xlIEdlbWluaSBBUEkgZm9yIEFuaW1hdGlvbiBHZW5lcmF0aW9uCiAqLwp3aW5kb3cuZmx1eCA9IHdpbmRvdy5mbHV4IHx8IHt9OwoKKGZ1bmN0aW9uKCkgewpjb25zdCBfQkFTRV9VUkwgPSAiaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscy8iOwoKLy8gRW52aXJvbm1lbnQgQ29uZmlndXJhdGlvbgogICAgLy8gVGhlIHN5c3RlbSBleHBlY3RzIHdpbmRvdy5HRU1JTklfQVBJX0tFWSB0byBiZSBhdmFpbGFibGUgaW4gdGhlIGdsb2JhbCBzY29wZS4KICAgIAogICAgY2xhc3MgR2VtaW5pU2VydmljZSB7CiAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICAgIHRoaXMuYXBpS2V5cyA9IFtdOwogICAgICAgICAgICB0aGlzLmN1cnJlbnRJbmRleCA9IDA7CiAgICAgICAgICAgIHRoaXMubW9kZWwgPSAiZ2VtaW5pLTIuNS1mbGFzaCI7IC8vIERlZmF1bHQKICAgICAgICAgICAgdGhpcy5sb2FkS2V5cygpOwogICAgICAgIH0KCiAgICAgICAgbG9hZEtleXMoKSB7CiAgICAgICAgICAgIC8vIDEuIFByaW9yaXR5OiBFbnZpcm9ubWVudCBWYXJpYWJsZSAoaW5qZWN0ZWQgYnkgaG9zdCkKICAgICAgICAgICAgLy8gV2UgY2hlY2sgZm9yIGNvbW1vbiBlbnZpcm9ubWVudCB2YXJpYWJsZSBwYXR0ZXJucwogICAgICAgICAgICBjb25zdCBlbnZLZXkgPSB3aW5kb3cuR0VNSU5JX0FQSV9LRVkgfHwgd2luZG93LkdPT0dMRV9BUElfS0VZOwogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKGVudktleSkgewogICAgICAgICAgICAgICAgdGhpcy5hcGlLZXlzID0gW2VudktleV07CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiR2VtaW5pOiBVc2luZyBFbnZpcm9ubWVudCBBUEkgS2V5LiIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyAyLiBGYWxsYmFjazogTG9jYWxTdG9yYWdlCiAgICAgICAgICAgIGNvbnN0IHN0b3JlZEtleXMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZmx1eF9nZW1pbmlfYXBpX2tleXMnKTsKICAgICAgICAgICAgLy8gRmFsbGJhY2sgdG8gb2xkIHNpbmdsZSBrZXkKICAgICAgICAgICAgY29uc3Qgb2xkS2V5ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2ZsdXhfZ2VtaW5pX2FwaV9rZXknKTsKCiAgICAgICAgICAgIGlmIChzdG9yZWRLZXlzKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuYXBpS2V5cyA9IEpTT04ucGFyc2Uoc3RvcmVkS2V5cyk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcGlLZXlzID0gW107CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAob2xkS2V5KSB7CiAgICAgICAgICAgICAgICB0aGlzLmFwaUtleXMgPSBbb2xkS2V5XTsKICAgICAgICAgICAgICAgIC8vIE1pZ3JhdGUgaW1tZWRpYXRlbHkKICAgICAgICAgICAgICAgIHRoaXMuc2F2ZUtleXMoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gTG9hZCBpbmRleAogICAgICAgICAgICBjb25zdCBzdG9yZWRJbmRleCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdmbHV4X2dlbWluaV9rZXlfaW5kZXgnKTsKdGhpcy5jdXJyZW50SW5kZXggPSBzdG9yZWRJbmRleCA/IHBhcnNlSW50KHN0b3JlZEluZGV4LCAxMCkgOiAwOwoKICAgICAgICAgICAgLy8gTG9hZCBNb2RlbAogICAgICAgICAgICBjb25zdCBzdG9yZWRNb2RlbCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdmbHV4X2dlbWluaV9tb2RlbCcpOwogICAgICAgICAgICBpZiAoc3RvcmVkTW9kZWwpIHsKICAgICAgICAgICAgICAgIHRoaXMubW9kZWwgPSBzdG9yZWRNb2RlbDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gVmFsaWRhdGlvbgogICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodGhpcy5hcGlLZXlzKSkgdGhpcy5hcGlLZXlzID0gW107CiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRJbmRleCA+PSB0aGlzLmFwaUtleXMubGVuZ3RoIHx8IHRoaXMuY3VycmVudEluZGV4IDwgMCkgewogICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50SW5kZXggPSAwOwogICAgICAgICAgICB9CiAgICAgICAgfQoKc2F2ZUtleXMoKSB7CiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdmbHV4X2dlbWluaV9hcGlfa2V5cycsIEpTT04uc3RyaW5naWZ5KHRoaXMuYXBpS2V5cykpOwogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZmx1eF9nZW1pbmlfa2V5X2luZGV4JywgdGhpcy5jdXJyZW50SW5kZXgpOwogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZmx1eF9nZW1pbmlfbW9kZWwnLCB0aGlzLm1vZGVsKTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFNldCBrZXlzIGZyb20gYSByYXcgc3RyaW5nIChuZXdsaW5lIG9yIGNvbW1hIHNlcGFyYXRlZCkKICAgICAgICAgKi8KICAgICAgICBzZXRBcGlLZXlzKGlucHV0U3RyaW5nKSB7CiAgICAgICAgICAgIGlmICghaW5wdXRTdHJpbmcpIHsKICAgICAgICAgICAgICAgIHRoaXMuYXBpS2V5cyA9IFtdOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gU3BsaXQgYnkgbmV3bGluZSBvciBjb21tYSwgdHJpbSwgYW5kIHJlbW92ZSBlbXB0eQogICAgICAgICAgICAgICAgdGhpcy5hcGlLZXlzID0gaW5wdXRTdHJpbmcuc3BsaXQoL1tcbixdKy8pCiAgICAgICAgICAgICAgICAgICAgLm1hcChrID0+IGsudHJpbSgpKQogICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoayA9PiBrLmxlbmd0aCA+IDApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBSZXNldCBpbmRleCB0byAwIHdoZW4ga2V5cyBjaGFuZ2UgdG8gZW5zdXJlIHdlIHN0YXJ0IGZyZXNoCiAgICAgICAgICAgIHRoaXMuY3VycmVudEluZGV4ID0gMDsKICAgICAgICAgICAgdGhpcy5zYXZlS2V5cygpOwogICAgICAgIH0KCmdldEFwaUtleXNSYXcoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmFwaUtleXMuam9pbignXG4nKTsKICAgICAgICB9CgogICAgICAgIHNldE1vZGVsKG1vZGVsTmFtZSkgewogICAgICAgICAgICB0aGlzLm1vZGVsID0gbW9kZWxOYW1lOwogICAgICAgICAgICB0aGlzLnNhdmVLZXlzKCk7IC8vIFJldXNpbmcgc2F2ZUtleXMgdG8gc2F2ZSBhbGwgY29uZmlnCiAgICAgICAgfQoKICAgICAgICBnZXRNb2RlbCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMubW9kZWw7CiAgICAgICAgfQoKICAgICAgICBoYXNLZXkoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmFwaUtleXMubGVuZ3RoID4gMDsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEdlbmVyYXRlIGFuaW1hdGlvbiBkYXRhIGJhc2VkIG9uIHByb21wdCBhbmQgc2tlbGV0b24KICAgICAgICAgKiBDeWNsZXMgdGhyb3VnaCBrZXlzIGlmIG9uZSBmYWlscy4KICAgICAgICAgKi8KYXN5bmMgZ2VuZXJhdGVBbmltYXRpb24odXNlclByb21wdCwgYm9uZUxpc3QpIHsKICAgICAgICAgICAgaWYgKHRoaXMuYXBpS2V5cy5sZW5ndGggPT09IDApIHRocm93IG5ldyBFcnJvcigiTm8gQVBJIEtleXMgZm91bmQuIFBsZWFzZSBjaGVjayBTZXR0aW5ncy4iKTsKCiAgICAgICAgICAgIGxldCBsYXN0RXJyb3IgPSBudWxsOwogICAgICAgICAgICBjb25zdCBjb3VudCA9IHRoaXMuYXBpS2V5cy5sZW5ndGg7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBTdGFydCBmcm9tIHRoZSByZW1lbWJlcmVkIGluZGV4CiAgICAgICAgICAgIGNvbnN0IHN0YXJ0SW5kZXggPSB0aGlzLmN1cnJlbnRJbmRleDsKCiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBHZW1pbmk6IFN0YXJ0aW5nIGdlbmVyYXRpb24uIEhhdmUgJHtjb3VudH0ga2V5cy4gU3RhcnRpbmcgYXQgaW5kZXggJHtzdGFydEluZGV4fS5gKTsKCiAgICAgICAgICAgIC8vIFRyeSBlYWNoIGtleSBleGFjdGx5IG9uY2UKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgICAgICAgICAvLyBXcmFwIGFyb3VuZCBsb2dpYwogICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSAoc3RhcnRJbmRleCArIGkpICUgY291bnQ7CiAgICAgICAgICAgICAgICBjb25zdCBhcGlLZXkgPSB0aGlzLmFwaUtleXNbaW5kZXhdOwoKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5fbWFrZVJlcXVlc3QoYXBpS2V5LCB1c2VyUHJvbXB0LCBib25lTGlzdCk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gU3VjY2VzcyEgCiAgICAgICAgICAgICAgICAgICAgLy8gSWYgd2UgZHJpZnRlZCB0byBhIG5ldyBrZXksIHNhdmUgaXQgYXMgdGhlIG5ldyBkZWZhdWx0CiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ICE9PSB0aGlzLmN1cnJlbnRJbmRleCkgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgR2VtaW5pOiBTd2l0Y2hpbmcgcHJlZmVycmVkIGtleSBpbmRleCBmcm9tICR7dGhpcy5jdXJyZW50SW5kZXh9IHRvICR7aW5kZXh9YCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEluZGV4ID0gaW5kZXg7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZUtleXMoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKCiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBHZW1pbmk6IEtleSBpbmRleCAke2luZGV4fSBmYWlsZWQgW1N0YXR1czogJHtlLnN0YXR1cyB8fCAnTi9BJ31dOiAke2UubWVzc2FnZX1gKTsKICAgICAgICAgICAgICAgICAgICBsYXN0RXJyb3IgPSBlOwoKICAgICAgICAgICAgICAgICAgICAvLyBGT1JDRSBSRVRSWTogV2UgaWdub3JlIHRoZSBlcnJvciB0eXBlIGFuZCB0cnkgdGhlIG5leHQga2V5LgogICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgZml4ZXMgaXNzdWVzIHdoZXJlIGEgc2luZ2xlIG1hbGZvcm1lZCBrZXkgKDQwMCkgb3IgcGVybWlzc2lvbiBpc3N1ZSAoNDAzKQogICAgICAgICAgICAgICAgICAgIC8vIHdvdWxkIHByZXZpb3VzbHkgaGFsdCB0aGUgZW50aXJlIHByb2Nlc3MuCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gRGVsYXkgdG8gcHJldmVudCBicm93c2VyIHRocm90dGxpbmcgYW5kIGdpdmUgYSBzbGlnaHQgYnJlYXRoZXIgdG8gdGhlIEFQSQogICAgICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MDApKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBbGwgJHtjb3VudH0gQVBJIGtleXMgZmFpbGVkLiBMYXN0IGVycm9yOiAke2xhc3RFcnJvciA/IGxhc3RFcnJvci5tZXNzYWdlIDogJ1Vua25vd24nfWApOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogSW50ZXJuYWwgcmVxdWVzdCBoZWxwZXIKICAgICAgICAgKi8KYXN5bmMgX21ha2VSZXF1ZXN0KGFwaUtleSwgdXNlclByb21wdCwgYm9uZUxpc3QpIHsKICAgICAgICAgICAgLy8gQ29uc3RydWN0IHRoZSBwcm9tcHQKICAgICAgICAgICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gYApZb3UgYXJlIGFuIGV4cGVydCAzRCBUZWNobmljYWwgQW5pbWF0b3IgdXNpbmcgdGhlIGFkdmFuY2VkIEdlbWluaSAyLjUgRmxhc2ggZW5naW5lLgpUYXJnZXQgU2tlbGV0b24gQm9uZXM6ICR7SlNPTi5zdHJpbmdpZnkoYm9uZUxpc3QpfQoKVGFzazogR2VuZXJhdGUgYSBKU09OIGFuaW1hdGlvbiBmb3IgdGhlIHByb21wdDogIiR7dXNlclByb21wdH0iCgpSZXF1aXJlbWVudHM6CjEuIE91dHB1dCBPTkxZIHZhbGlkIEpTT04uIE5vIG1hcmtkb3duIGZvcm1hdHRpbmcuCjIuIFN0cnVjdHVyZToKewogICJuYW1lIjogImFpX2dlbmVyYXRlZCIsCiAgImZwcyI6IDMwLAogICJkdXJhdGlvbiI6IDxmbG9hdF90b3RhbF9zZWNvbmRzPiwKICAidHJhY2tzIjogWwogICAgewogICAgICAiYm9uZSI6ICI8Qm9uZU5hbWVGcm9tTGlzdD4iLAogICAgICAidHlwZSI6ICJxdWF0ZXJuaW9uIiwgCiAgICAgICJ0aW1lcyI6IFswLjAsIDAuMDMzLCAuLi5dLCAvLyBUaW1lIGluIFNFQ09ORFMKICAgICAgInZhbHVlcyI6IFt4LHkseix3LCAuLi5dIC8vIEZsYXQgYXJyYXkgb2Yga2V5ZnJhbWVzCiAgICB9LAogICAgewogICAgICAiYm9uZSI6ICJIaXBzIiwgCiAgICAgICJ0eXBlIjogInZlY3RvciIsIAogICAgICAidGltZXMiOiBbMC4wLCAuLi5dLCAKICAgICAgInZhbHVlcyI6IFt4LHkseiwgLi4uXSAKICAgIH0KICBdCn0KMy4gIkhpcHMiIGlzIHRoZSByb290LiBNb3ZlIGl0IGlmIHRoZSBhY3Rpb24gcmVxdWlyZXMgKGUuZy4sIGp1bXBpbmcsIHdhbGtpbmcpLgo0LiBVc2UgInF1YXRlcm5pb24iIGZvciByb3RhdGlvbnMgKHgseSx6LHcpLiBFbnN1cmUgdGhleSBhcmUgbm9ybWFsaXplZC4KNS4gVGltZXMgTVVTVCBiZSBpbiBTRUNPTkRTLCBub3QgZnJhbWVzLgo2LiBMaW1pdCBwcmVjaXNpb24gdG8gNCBkZWNpbWFsIHBsYWNlcyB0byBzYXZlIHNwYWNlLgo3LiBFbnN1cmUgdGhlIGFuaW1hdGlvbiBsb29wcyBzZWFtbGVzc2x5IGlmIGl0J3MgYSBjeWNsZSAod2FsaywgcnVuKS4KYDsKCiAgICAgICAgICAgIGNvbnN0IHBheWxvYWQgPSB7CiAgICAgICAgICAgICAgICBjb250ZW50czogW3sKICAgICAgICAgICAgICAgICAgICBwYXJ0czogW3sgdGV4dDogc3lzdGVtUHJvbXB0IH1dCiAgICAgICAgICAgICAgICB9XSwKICAgICAgICAgICAgICAgIGdlbmVyYXRpb25Db25maWc6IHsKICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogMS4wLCAvLyBTbGlnaHRseSBoaWdoZXIgZm9yIEZsYXNoIHRvIGVuY291cmFnZSBtb3Rpb24KICAgICAgICAgICAgICAgICAgICBtYXhPdXRwdXRUb2tlbnM6IDgxOTIsCiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2VNaW1lVHlwZTogImFwcGxpY2F0aW9uL2pzb24iCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CgovLyBGSVg6IERlZmF1bHQgdG8gZ2VtaW5pLTEuNS1mbGFzaCBmb3IgYmV0dGVyIHF1b3RhcyBhbmQgc3BlZWQuIAogICAgICAgICAgICAvLyBnZW1pbmktMi41LXBybyB3YXMgbGlrZWx5IGEgaGFsbHVjaW5hdGlvbiBvciBwbGFjZWhvbGRlci4KY29uc3QgbW9kZWwgPSB0aGlzLm1vZGVsIHx8ICJnZW1pbmktMi41LWZsYXNoIjsKICAgICAgICAgICAgY29uc3QgdXJsID0gYCR7X0JBU0VfVVJMfSR7bW9kZWx9OmdlbmVyYXRlQ29udGVudD9rZXk9JHthcGlLZXl9YDsKCiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBHZW1pbmk6IFJlcXVlc3RpbmcgdmlhICR7bW9kZWx9Li4uYCk7CgogICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwgewogICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsCiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSwKICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHBheWxvYWQpCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykgewogICAgICAgICAgICAgICAgY29uc3QgZXJyRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKS5jYXRjaCgoKSA9PiAoe30pKTsKICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKGVyckRhdGEuZXJyb3I/Lm1lc3NhZ2UgfHwgcmVzcG9uc2Uuc3RhdHVzVGV4dCk7CiAgICAgICAgICAgICAgICBlcnJvci5zdGF0dXMgPSByZXNwb25zZS5zdGF0dXM7CiAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFBhcnNlIEdlbWluaSBSZXNwb25zZQogICAgICAgICAgICBpZiAoIWRhdGEuY2FuZGlkYXRlcyB8fCBkYXRhLmNhbmRpZGF0ZXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIk5vIHJlc3BvbnNlIGNhbmRpZGF0ZXMgZnJvbSBHZW1pbmkuIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IHRleHQgPSBkYXRhLmNhbmRpZGF0ZXNbMF0uY29udGVudC5wYXJ0c1swXS50ZXh0OwogICAgICAgICAgICAvLyBDbGVhbnVwIHBvdGVudGlhbCBtYXJrZG93biBjb2RlIGJsb2NrcyBpZiB0aGUgbW9kZWwgaWdub3JlcyB0aGUgTUlNRSB0eXBlCiAgICAgICAgICAgIC8vIEZsYXNoIHNvbWV0aW1lcyBhZGRzIGBgYGpzb24gLi4uIGBgYCBkZXNwaXRlIHRoZSBtaW1lIHR5cGUKICAgICAgICAgICAgY29uc3QgY2xlYW5Kc29uID0gdGV4dC5yZXBsYWNlKC9gYGBqc29uL2dpLCAnJykucmVwbGFjZSgvYGBgL2csICcnKS50cmltKCk7CiAgICAgICAgICAgIAogICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShjbGVhbkpzb24pOwogICAgICAgIH0KICAgIH0KCiAgICB3aW5kb3cuZmx1eC5nZW1pbmkgPSBuZXcgR2VtaW5pU2VydmljZSgpOwp9KSgpOw==","./js/gemini-service.js":"data:text/javascript;base64,LyoqCiAqIEdlbWluaVNlcnZpY2UKICogSGFuZGxlcyBjb21tdW5pY2F0aW9uIHdpdGggR29vZ2xlIEdlbWluaSBBUEkgZm9yIEFuaW1hdGlvbiBHZW5lcmF0aW9uCiAqLwp3aW5kb3cuZmx1eCA9IHdpbmRvdy5mbHV4IHx8IHt9OwoKKGZ1bmN0aW9uKCkgewpjb25zdCBfQkFTRV9VUkwgPSAiaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscy8iOwoKLy8gRW52aXJvbm1lbnQgQ29uZmlndXJhdGlvbgogICAgLy8gVGhlIHN5c3RlbSBleHBlY3RzIHdpbmRvdy5HRU1JTklfQVBJX0tFWSB0byBiZSBhdmFpbGFibGUgaW4gdGhlIGdsb2JhbCBzY29wZS4KICAgIAogICAgY2xhc3MgR2VtaW5pU2VydmljZSB7CiAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICAgIHRoaXMuYXBpS2V5cyA9IFtdOwogICAgICAgICAgICB0aGlzLmN1cnJlbnRJbmRleCA9IDA7CiAgICAgICAgICAgIHRoaXMubW9kZWwgPSAiZ2VtaW5pLTIuNS1mbGFzaCI7IC8vIERlZmF1bHQKICAgICAgICAgICAgdGhpcy5sb2FkS2V5cygpOwogICAgICAgIH0KCiAgICAgICAgbG9hZEtleXMoKSB7CiAgICAgICAgICAgIC8vIDEuIFByaW9yaXR5OiBFbnZpcm9ubWVudCBWYXJpYWJsZSAoaW5qZWN0ZWQgYnkgaG9zdCkKICAgICAgICAgICAgLy8gV2UgY2hlY2sgZm9yIGNvbW1vbiBlbnZpcm9ubWVudCB2YXJpYWJsZSBwYXR0ZXJucwogICAgICAgICAgICBjb25zdCBlbnZLZXkgPSB3aW5kb3cuR0VNSU5JX0FQSV9LRVkgfHwgd2luZG93LkdPT0dMRV9BUElfS0VZOwogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKGVudktleSkgewogICAgICAgICAgICAgICAgdGhpcy5hcGlLZXlzID0gW2VudktleV07CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiR2VtaW5pOiBVc2luZyBFbnZpcm9ubWVudCBBUEkgS2V5LiIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyAyLiBGYWxsYmFjazogTG9jYWxTdG9yYWdlCiAgICAgICAgICAgIGNvbnN0IHN0b3JlZEtleXMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZmx1eF9nZW1pbmlfYXBpX2tleXMnKTsKICAgICAgICAgICAgLy8gRmFsbGJhY2sgdG8gb2xkIHNpbmdsZSBrZXkKICAgICAgICAgICAgY29uc3Qgb2xkS2V5ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2ZsdXhfZ2VtaW5pX2FwaV9rZXknKTsKCiAgICAgICAgICAgIGlmIChzdG9yZWRLZXlzKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuYXBpS2V5cyA9IEpTT04ucGFyc2Uoc3RvcmVkS2V5cyk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcGlLZXlzID0gW107CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAob2xkS2V5KSB7CiAgICAgICAgICAgICAgICB0aGlzLmFwaUtleXMgPSBbb2xkS2V5XTsKICAgICAgICAgICAgICAgIC8vIE1pZ3JhdGUgaW1tZWRpYXRlbHkKICAgICAgICAgICAgICAgIHRoaXMuc2F2ZUtleXMoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gTG9hZCBpbmRleAogICAgICAgICAgICBjb25zdCBzdG9yZWRJbmRleCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdmbHV4X2dlbWluaV9rZXlfaW5kZXgnKTsKdGhpcy5jdXJyZW50SW5kZXggPSBzdG9yZWRJbmRleCA/IHBhcnNlSW50KHN0b3JlZEluZGV4LCAxMCkgOiAwOwoKICAgICAgICAgICAgLy8gTG9hZCBNb2RlbAogICAgICAgICAgICBjb25zdCBzdG9yZWRNb2RlbCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdmbHV4X2dlbWluaV9tb2RlbCcpOwogICAgICAgICAgICBpZiAoc3RvcmVkTW9kZWwpIHsKICAgICAgICAgICAgICAgIHRoaXMubW9kZWwgPSBzdG9yZWRNb2RlbDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gVmFsaWRhdGlvbgogICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodGhpcy5hcGlLZXlzKSkgdGhpcy5hcGlLZXlzID0gW107CiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRJbmRleCA+PSB0aGlzLmFwaUtleXMubGVuZ3RoIHx8IHRoaXMuY3VycmVudEluZGV4IDwgMCkgewogICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50SW5kZXggPSAwOwogICAgICAgICAgICB9CiAgICAgICAgfQoKc2F2ZUtleXMoKSB7CiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdmbHV4X2dlbWluaV9hcGlfa2V5cycsIEpTT04uc3RyaW5naWZ5KHRoaXMuYXBpS2V5cykpOwogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZmx1eF9nZW1pbmlfa2V5X2luZGV4JywgdGhpcy5jdXJyZW50SW5kZXgpOwogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZmx1eF9nZW1pbmlfbW9kZWwnLCB0aGlzLm1vZGVsKTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFNldCBrZXlzIGZyb20gYSByYXcgc3RyaW5nIChuZXdsaW5lIG9yIGNvbW1hIHNlcGFyYXRlZCkKICAgICAgICAgKi8KICAgICAgICBzZXRBcGlLZXlzKGlucHV0U3RyaW5nKSB7CiAgICAgICAgICAgIGlmICghaW5wdXRTdHJpbmcpIHsKICAgICAgICAgICAgICAgIHRoaXMuYXBpS2V5cyA9IFtdOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gU3BsaXQgYnkgbmV3bGluZSBvciBjb21tYSwgdHJpbSwgYW5kIHJlbW92ZSBlbXB0eQogICAgICAgICAgICAgICAgdGhpcy5hcGlLZXlzID0gaW5wdXRTdHJpbmcuc3BsaXQoL1tcbixdKy8pCiAgICAgICAgICAgICAgICAgICAgLm1hcChrID0+IGsudHJpbSgpKQogICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoayA9PiBrLmxlbmd0aCA+IDApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBSZXNldCBpbmRleCB0byAwIHdoZW4ga2V5cyBjaGFuZ2UgdG8gZW5zdXJlIHdlIHN0YXJ0IGZyZXNoCiAgICAgICAgICAgIHRoaXMuY3VycmVudEluZGV4ID0gMDsKICAgICAgICAgICAgdGhpcy5zYXZlS2V5cygpOwogICAgICAgIH0KCmdldEFwaUtleXNSYXcoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmFwaUtleXMuam9pbignXG4nKTsKICAgICAgICB9CgogICAgICAgIHNldE1vZGVsKG1vZGVsTmFtZSkgewogICAgICAgICAgICB0aGlzLm1vZGVsID0gbW9kZWxOYW1lOwogICAgICAgICAgICB0aGlzLnNhdmVLZXlzKCk7IC8vIFJldXNpbmcgc2F2ZUtleXMgdG8gc2F2ZSBhbGwgY29uZmlnCiAgICAgICAgfQoKICAgICAgICBnZXRNb2RlbCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMubW9kZWw7CiAgICAgICAgfQoKICAgICAgICBoYXNLZXkoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmFwaUtleXMubGVuZ3RoID4gMDsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEdlbmVyYXRlIGFuaW1hdGlvbiBkYXRhIGJhc2VkIG9uIHByb21wdCBhbmQgc2tlbGV0b24KICAgICAgICAgKiBDeWNsZXMgdGhyb3VnaCBrZXlzIGlmIG9uZSBmYWlscy4KICAgICAgICAgKi8KYXN5bmMgZ2VuZXJhdGVBbmltYXRpb24odXNlclByb21wdCwgYm9uZUxpc3QpIHsKICAgICAgICAgICAgaWYgKHRoaXMuYXBpS2V5cy5sZW5ndGggPT09IDApIHRocm93IG5ldyBFcnJvcigiTm8gQVBJIEtleXMgZm91bmQuIFBsZWFzZSBjaGVjayBTZXR0aW5ncy4iKTsKCiAgICAgICAgICAgIGxldCBsYXN0RXJyb3IgPSBudWxsOwogICAgICAgICAgICBjb25zdCBjb3VudCA9IHRoaXMuYXBpS2V5cy5sZW5ndGg7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBTdGFydCBmcm9tIHRoZSByZW1lbWJlcmVkIGluZGV4CiAgICAgICAgICAgIGNvbnN0IHN0YXJ0SW5kZXggPSB0aGlzLmN1cnJlbnRJbmRleDsKCiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBHZW1pbmk6IFN0YXJ0aW5nIGdlbmVyYXRpb24uIEhhdmUgJHtjb3VudH0ga2V5cy4gU3RhcnRpbmcgYXQgaW5kZXggJHtzdGFydEluZGV4fS5gKTsKCiAgICAgICAgICAgIC8vIFRyeSBlYWNoIGtleSBleGFjdGx5IG9uY2UKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgICAgICAgICAvLyBXcmFwIGFyb3VuZCBsb2dpYwogICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSAoc3RhcnRJbmRleCArIGkpICUgY291bnQ7CiAgICAgICAgICAgICAgICBjb25zdCBhcGlLZXkgPSB0aGlzLmFwaUtleXNbaW5kZXhdOwoKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5fbWFrZVJlcXVlc3QoYXBpS2V5LCB1c2VyUHJvbXB0LCBib25lTGlzdCk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gU3VjY2VzcyEgCiAgICAgICAgICAgICAgICAgICAgLy8gSWYgd2UgZHJpZnRlZCB0byBhIG5ldyBrZXksIHNhdmUgaXQgYXMgdGhlIG5ldyBkZWZhdWx0CiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ICE9PSB0aGlzLmN1cnJlbnRJbmRleCkgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgR2VtaW5pOiBTd2l0Y2hpbmcgcHJlZmVycmVkIGtleSBpbmRleCBmcm9tICR7dGhpcy5jdXJyZW50SW5kZXh9IHRvICR7aW5kZXh9YCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEluZGV4ID0gaW5kZXg7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZUtleXMoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKCiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBHZW1pbmk6IEtleSBpbmRleCAke2luZGV4fSBmYWlsZWQgW1N0YXR1czogJHtlLnN0YXR1cyB8fCAnTi9BJ31dOiAke2UubWVzc2FnZX1gKTsKICAgICAgICAgICAgICAgICAgICBsYXN0RXJyb3IgPSBlOwoKICAgICAgICAgICAgICAgICAgICAvLyBGT1JDRSBSRVRSWTogV2UgaWdub3JlIHRoZSBlcnJvciB0eXBlIGFuZCB0cnkgdGhlIG5leHQga2V5LgogICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgZml4ZXMgaXNzdWVzIHdoZXJlIGEgc2luZ2xlIG1hbGZvcm1lZCBrZXkgKDQwMCkgb3IgcGVybWlzc2lvbiBpc3N1ZSAoNDAzKQogICAgICAgICAgICAgICAgICAgIC8vIHdvdWxkIHByZXZpb3VzbHkgaGFsdCB0aGUgZW50aXJlIHByb2Nlc3MuCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gRGVsYXkgdG8gcHJldmVudCBicm93c2VyIHRocm90dGxpbmcgYW5kIGdpdmUgYSBzbGlnaHQgYnJlYXRoZXIgdG8gdGhlIEFQSQogICAgICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MDApKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBbGwgJHtjb3VudH0gQVBJIGtleXMgZmFpbGVkLiBMYXN0IGVycm9yOiAke2xhc3RFcnJvciA/IGxhc3RFcnJvci5tZXNzYWdlIDogJ1Vua25vd24nfWApOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogSW50ZXJuYWwgcmVxdWVzdCBoZWxwZXIKICAgICAgICAgKi8KYXN5bmMgX21ha2VSZXF1ZXN0KGFwaUtleSwgdXNlclByb21wdCwgYm9uZUxpc3QpIHsKICAgICAgICAgICAgLy8gQ29uc3RydWN0IHRoZSBwcm9tcHQKICAgICAgICAgICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gYApZb3UgYXJlIGFuIGV4cGVydCAzRCBUZWNobmljYWwgQW5pbWF0b3IgdXNpbmcgdGhlIGFkdmFuY2VkIEdlbWluaSAyLjUgRmxhc2ggZW5naW5lLgpUYXJnZXQgU2tlbGV0b24gQm9uZXM6ICR7SlNPTi5zdHJpbmdpZnkoYm9uZUxpc3QpfQoKVGFzazogR2VuZXJhdGUgYSBKU09OIGFuaW1hdGlvbiBmb3IgdGhlIHByb21wdDogIiR7dXNlclByb21wdH0iCgpSZXF1aXJlbWVudHM6CjEuIE91dHB1dCBPTkxZIHZhbGlkIEpTT04uIE5vIG1hcmtkb3duIGZvcm1hdHRpbmcuCjIuIFN0cnVjdHVyZToKewogICJuYW1lIjogImFpX2dlbmVyYXRlZCIsCiAgImZwcyI6IDMwLAogICJkdXJhdGlvbiI6IDxmbG9hdF90b3RhbF9zZWNvbmRzPiwKICAidHJhY2tzIjogWwogICAgewogICAgICAiYm9uZSI6ICI8Qm9uZU5hbWVGcm9tTGlzdD4iLAogICAgICAidHlwZSI6ICJxdWF0ZXJuaW9uIiwgCiAgICAgICJ0aW1lcyI6IFswLjAsIDAuMDMzLCAuLi5dLCAvLyBUaW1lIGluIFNFQ09ORFMKICAgICAgInZhbHVlcyI6IFt4LHkseix3LCAuLi5dIC8vIEZsYXQgYXJyYXkgb2Yga2V5ZnJhbWVzCiAgICB9LAogICAgewogICAgICAiYm9uZSI6ICJIaXBzIiwgCiAgICAgICJ0eXBlIjogInZlY3RvciIsIAogICAgICAidGltZXMiOiBbMC4wLCAuLi5dLCAKICAgICAgInZhbHVlcyI6IFt4LHkseiwgLi4uXSAKICAgIH0KICBdCn0KMy4gIkhpcHMiIGlzIHRoZSByb290LiBNb3ZlIGl0IGlmIHRoZSBhY3Rpb24gcmVxdWlyZXMgKGUuZy4sIGp1bXBpbmcsIHdhbGtpbmcpLgo0LiBVc2UgInF1YXRlcm5pb24iIGZvciByb3RhdGlvbnMgKHgseSx6LHcpLiBFbnN1cmUgdGhleSBhcmUgbm9ybWFsaXplZC4KNS4gVGltZXMgTVVTVCBiZSBpbiBTRUNPTkRTLCBub3QgZnJhbWVzLgo2LiBMaW1pdCBwcmVjaXNpb24gdG8gNCBkZWNpbWFsIHBsYWNlcyB0byBzYXZlIHNwYWNlLgo3LiBFbnN1cmUgdGhlIGFuaW1hdGlvbiBsb29wcyBzZWFtbGVzc2x5IGlmIGl0J3MgYSBjeWNsZSAod2FsaywgcnVuKS4KYDsKCiAgICAgICAgICAgIGNvbnN0IHBheWxvYWQgPSB7CiAgICAgICAgICAgICAgICBjb250ZW50czogW3sKICAgICAgICAgICAgICAgICAgICBwYXJ0czogW3sgdGV4dDogc3lzdGVtUHJvbXB0IH1dCiAgICAgICAgICAgICAgICB9XSwKICAgICAgICAgICAgICAgIGdlbmVyYXRpb25Db25maWc6IHsKICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogMS4wLCAvLyBTbGlnaHRseSBoaWdoZXIgZm9yIEZsYXNoIHRvIGVuY291cmFnZSBtb3Rpb24KICAgICAgICAgICAgICAgICAgICBtYXhPdXRwdXRUb2tlbnM6IDgxOTIsCiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2VNaW1lVHlwZTogImFwcGxpY2F0aW9uL2pzb24iCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CgovLyBGSVg6IERlZmF1bHQgdG8gZ2VtaW5pLTEuNS1mbGFzaCBmb3IgYmV0dGVyIHF1b3RhcyBhbmQgc3BlZWQuIAogICAgICAgICAgICAvLyBnZW1pbmktMi41LXBybyB3YXMgbGlrZWx5IGEgaGFsbHVjaW5hdGlvbiBvciBwbGFjZWhvbGRlci4KY29uc3QgbW9kZWwgPSB0aGlzLm1vZGVsIHx8ICJnZW1pbmktMi41LWZsYXNoIjsKICAgICAgICAgICAgY29uc3QgdXJsID0gYCR7X0JBU0VfVVJMfSR7bW9kZWx9OmdlbmVyYXRlQ29udGVudD9rZXk9JHthcGlLZXl9YDsKCiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBHZW1pbmk6IFJlcXVlc3RpbmcgdmlhICR7bW9kZWx9Li4uYCk7CgogICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwgewogICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsCiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSwKICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHBheWxvYWQpCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykgewogICAgICAgICAgICAgICAgY29uc3QgZXJyRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKS5jYXRjaCgoKSA9PiAoe30pKTsKICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKGVyckRhdGEuZXJyb3I/Lm1lc3NhZ2UgfHwgcmVzcG9uc2Uuc3RhdHVzVGV4dCk7CiAgICAgICAgICAgICAgICBlcnJvci5zdGF0dXMgPSByZXNwb25zZS5zdGF0dXM7CiAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFBhcnNlIEdlbWluaSBSZXNwb25zZQogICAgICAgICAgICBpZiAoIWRhdGEuY2FuZGlkYXRlcyB8fCBkYXRhLmNhbmRpZGF0ZXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIk5vIHJlc3BvbnNlIGNhbmRpZGF0ZXMgZnJvbSBHZW1pbmkuIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IHRleHQgPSBkYXRhLmNhbmRpZGF0ZXNbMF0uY29udGVudC5wYXJ0c1swXS50ZXh0OwogICAgICAgICAgICAvLyBDbGVhbnVwIHBvdGVudGlhbCBtYXJrZG93biBjb2RlIGJsb2NrcyBpZiB0aGUgbW9kZWwgaWdub3JlcyB0aGUgTUlNRSB0eXBlCiAgICAgICAgICAgIC8vIEZsYXNoIHNvbWV0aW1lcyBhZGRzIGBgYGpzb24gLi4uIGBgYCBkZXNwaXRlIHRoZSBtaW1lIHR5cGUKICAgICAgICAgICAgY29uc3QgY2xlYW5Kc29uID0gdGV4dC5yZXBsYWNlKC9gYGBqc29uL2dpLCAnJykucmVwbGFjZSgvYGBgL2csICcnKS50cmltKCk7CiAgICAgICAgICAgIAogICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShjbGVhbkpzb24pOwogICAgICAgIH0KICAgIH0KCiAgICB3aW5kb3cuZmx1eC5nZW1pbmkgPSBuZXcgR2VtaW5pU2VydmljZSgpOwp9KSgpOw==","/js/gemini-service.js":"data:text/javascript;base64,LyoqCiAqIEdlbWluaVNlcnZpY2UKICogSGFuZGxlcyBjb21tdW5pY2F0aW9uIHdpdGggR29vZ2xlIEdlbWluaSBBUEkgZm9yIEFuaW1hdGlvbiBHZW5lcmF0aW9uCiAqLwp3aW5kb3cuZmx1eCA9IHdpbmRvdy5mbHV4IHx8IHt9OwoKKGZ1bmN0aW9uKCkgewpjb25zdCBfQkFTRV9VUkwgPSAiaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscy8iOwoKLy8gRW52aXJvbm1lbnQgQ29uZmlndXJhdGlvbgogICAgLy8gVGhlIHN5c3RlbSBleHBlY3RzIHdpbmRvdy5HRU1JTklfQVBJX0tFWSB0byBiZSBhdmFpbGFibGUgaW4gdGhlIGdsb2JhbCBzY29wZS4KICAgIAogICAgY2xhc3MgR2VtaW5pU2VydmljZSB7CiAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICAgIHRoaXMuYXBpS2V5cyA9IFtdOwogICAgICAgICAgICB0aGlzLmN1cnJlbnRJbmRleCA9IDA7CiAgICAgICAgICAgIHRoaXMubW9kZWwgPSAiZ2VtaW5pLTIuNS1mbGFzaCI7IC8vIERlZmF1bHQKICAgICAgICAgICAgdGhpcy5sb2FkS2V5cygpOwogICAgICAgIH0KCiAgICAgICAgbG9hZEtleXMoKSB7CiAgICAgICAgICAgIC8vIDEuIFByaW9yaXR5OiBFbnZpcm9ubWVudCBWYXJpYWJsZSAoaW5qZWN0ZWQgYnkgaG9zdCkKICAgICAgICAgICAgLy8gV2UgY2hlY2sgZm9yIGNvbW1vbiBlbnZpcm9ubWVudCB2YXJpYWJsZSBwYXR0ZXJucwogICAgICAgICAgICBjb25zdCBlbnZLZXkgPSB3aW5kb3cuR0VNSU5JX0FQSV9LRVkgfHwgd2luZG93LkdPT0dMRV9BUElfS0VZOwogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKGVudktleSkgewogICAgICAgICAgICAgICAgdGhpcy5hcGlLZXlzID0gW2VudktleV07CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiR2VtaW5pOiBVc2luZyBFbnZpcm9ubWVudCBBUEkgS2V5LiIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyAyLiBGYWxsYmFjazogTG9jYWxTdG9yYWdlCiAgICAgICAgICAgIGNvbnN0IHN0b3JlZEtleXMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZmx1eF9nZW1pbmlfYXBpX2tleXMnKTsKICAgICAgICAgICAgLy8gRmFsbGJhY2sgdG8gb2xkIHNpbmdsZSBrZXkKICAgICAgICAgICAgY29uc3Qgb2xkS2V5ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2ZsdXhfZ2VtaW5pX2FwaV9rZXknKTsKCiAgICAgICAgICAgIGlmIChzdG9yZWRLZXlzKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuYXBpS2V5cyA9IEpTT04ucGFyc2Uoc3RvcmVkS2V5cyk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcGlLZXlzID0gW107CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAob2xkS2V5KSB7CiAgICAgICAgICAgICAgICB0aGlzLmFwaUtleXMgPSBbb2xkS2V5XTsKICAgICAgICAgICAgICAgIC8vIE1pZ3JhdGUgaW1tZWRpYXRlbHkKICAgICAgICAgICAgICAgIHRoaXMuc2F2ZUtleXMoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gTG9hZCBpbmRleAogICAgICAgICAgICBjb25zdCBzdG9yZWRJbmRleCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdmbHV4X2dlbWluaV9rZXlfaW5kZXgnKTsKdGhpcy5jdXJyZW50SW5kZXggPSBzdG9yZWRJbmRleCA/IHBhcnNlSW50KHN0b3JlZEluZGV4LCAxMCkgOiAwOwoKICAgICAgICAgICAgLy8gTG9hZCBNb2RlbAogICAgICAgICAgICBjb25zdCBzdG9yZWRNb2RlbCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdmbHV4X2dlbWluaV9tb2RlbCcpOwogICAgICAgICAgICBpZiAoc3RvcmVkTW9kZWwpIHsKICAgICAgICAgICAgICAgIHRoaXMubW9kZWwgPSBzdG9yZWRNb2RlbDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gVmFsaWRhdGlvbgogICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodGhpcy5hcGlLZXlzKSkgdGhpcy5hcGlLZXlzID0gW107CiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRJbmRleCA+PSB0aGlzLmFwaUtleXMubGVuZ3RoIHx8IHRoaXMuY3VycmVudEluZGV4IDwgMCkgewogICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50SW5kZXggPSAwOwogICAgICAgICAgICB9CiAgICAgICAgfQoKc2F2ZUtleXMoKSB7CiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdmbHV4X2dlbWluaV9hcGlfa2V5cycsIEpTT04uc3RyaW5naWZ5KHRoaXMuYXBpS2V5cykpOwogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZmx1eF9nZW1pbmlfa2V5X2luZGV4JywgdGhpcy5jdXJyZW50SW5kZXgpOwogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZmx1eF9nZW1pbmlfbW9kZWwnLCB0aGlzLm1vZGVsKTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFNldCBrZXlzIGZyb20gYSByYXcgc3RyaW5nIChuZXdsaW5lIG9yIGNvbW1hIHNlcGFyYXRlZCkKICAgICAgICAgKi8KICAgICAgICBzZXRBcGlLZXlzKGlucHV0U3RyaW5nKSB7CiAgICAgICAgICAgIGlmICghaW5wdXRTdHJpbmcpIHsKICAgICAgICAgICAgICAgIHRoaXMuYXBpS2V5cyA9IFtdOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gU3BsaXQgYnkgbmV3bGluZSBvciBjb21tYSwgdHJpbSwgYW5kIHJlbW92ZSBlbXB0eQogICAgICAgICAgICAgICAgdGhpcy5hcGlLZXlzID0gaW5wdXRTdHJpbmcuc3BsaXQoL1tcbixdKy8pCiAgICAgICAgICAgICAgICAgICAgLm1hcChrID0+IGsudHJpbSgpKQogICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoayA9PiBrLmxlbmd0aCA+IDApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBSZXNldCBpbmRleCB0byAwIHdoZW4ga2V5cyBjaGFuZ2UgdG8gZW5zdXJlIHdlIHN0YXJ0IGZyZXNoCiAgICAgICAgICAgIHRoaXMuY3VycmVudEluZGV4ID0gMDsKICAgICAgICAgICAgdGhpcy5zYXZlS2V5cygpOwogICAgICAgIH0KCmdldEFwaUtleXNSYXcoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmFwaUtleXMuam9pbignXG4nKTsKICAgICAgICB9CgogICAgICAgIHNldE1vZGVsKG1vZGVsTmFtZSkgewogICAgICAgICAgICB0aGlzLm1vZGVsID0gbW9kZWxOYW1lOwogICAgICAgICAgICB0aGlzLnNhdmVLZXlzKCk7IC8vIFJldXNpbmcgc2F2ZUtleXMgdG8gc2F2ZSBhbGwgY29uZmlnCiAgICAgICAgfQoKICAgICAgICBnZXRNb2RlbCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMubW9kZWw7CiAgICAgICAgfQoKICAgICAgICBoYXNLZXkoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmFwaUtleXMubGVuZ3RoID4gMDsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEdlbmVyYXRlIGFuaW1hdGlvbiBkYXRhIGJhc2VkIG9uIHByb21wdCBhbmQgc2tlbGV0b24KICAgICAgICAgKiBDeWNsZXMgdGhyb3VnaCBrZXlzIGlmIG9uZSBmYWlscy4KICAgICAgICAgKi8KYXN5bmMgZ2VuZXJhdGVBbmltYXRpb24odXNlclByb21wdCwgYm9uZUxpc3QpIHsKICAgICAgICAgICAgaWYgKHRoaXMuYXBpS2V5cy5sZW5ndGggPT09IDApIHRocm93IG5ldyBFcnJvcigiTm8gQVBJIEtleXMgZm91bmQuIFBsZWFzZSBjaGVjayBTZXR0aW5ncy4iKTsKCiAgICAgICAgICAgIGxldCBsYXN0RXJyb3IgPSBudWxsOwogICAgICAgICAgICBjb25zdCBjb3VudCA9IHRoaXMuYXBpS2V5cy5sZW5ndGg7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBTdGFydCBmcm9tIHRoZSByZW1lbWJlcmVkIGluZGV4CiAgICAgICAgICAgIGNvbnN0IHN0YXJ0SW5kZXggPSB0aGlzLmN1cnJlbnRJbmRleDsKCiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBHZW1pbmk6IFN0YXJ0aW5nIGdlbmVyYXRpb24uIEhhdmUgJHtjb3VudH0ga2V5cy4gU3RhcnRpbmcgYXQgaW5kZXggJHtzdGFydEluZGV4fS5gKTsKCiAgICAgICAgICAgIC8vIFRyeSBlYWNoIGtleSBleGFjdGx5IG9uY2UKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgICAgICAgICAvLyBXcmFwIGFyb3VuZCBsb2dpYwogICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSAoc3RhcnRJbmRleCArIGkpICUgY291bnQ7CiAgICAgICAgICAgICAgICBjb25zdCBhcGlLZXkgPSB0aGlzLmFwaUtleXNbaW5kZXhdOwoKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5fbWFrZVJlcXVlc3QoYXBpS2V5LCB1c2VyUHJvbXB0LCBib25lTGlzdCk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gU3VjY2VzcyEgCiAgICAgICAgICAgICAgICAgICAgLy8gSWYgd2UgZHJpZnRlZCB0byBhIG5ldyBrZXksIHNhdmUgaXQgYXMgdGhlIG5ldyBkZWZhdWx0CiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ICE9PSB0aGlzLmN1cnJlbnRJbmRleCkgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgR2VtaW5pOiBTd2l0Y2hpbmcgcHJlZmVycmVkIGtleSBpbmRleCBmcm9tICR7dGhpcy5jdXJyZW50SW5kZXh9IHRvICR7aW5kZXh9YCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEluZGV4ID0gaW5kZXg7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZUtleXMoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKCiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBHZW1pbmk6IEtleSBpbmRleCAke2luZGV4fSBmYWlsZWQgW1N0YXR1czogJHtlLnN0YXR1cyB8fCAnTi9BJ31dOiAke2UubWVzc2FnZX1gKTsKICAgICAgICAgICAgICAgICAgICBsYXN0RXJyb3IgPSBlOwoKICAgICAgICAgICAgICAgICAgICAvLyBGT1JDRSBSRVRSWTogV2UgaWdub3JlIHRoZSBlcnJvciB0eXBlIGFuZCB0cnkgdGhlIG5leHQga2V5LgogICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgZml4ZXMgaXNzdWVzIHdoZXJlIGEgc2luZ2xlIG1hbGZvcm1lZCBrZXkgKDQwMCkgb3IgcGVybWlzc2lvbiBpc3N1ZSAoNDAzKQogICAgICAgICAgICAgICAgICAgIC8vIHdvdWxkIHByZXZpb3VzbHkgaGFsdCB0aGUgZW50aXJlIHByb2Nlc3MuCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gRGVsYXkgdG8gcHJldmVudCBicm93c2VyIHRocm90dGxpbmcgYW5kIGdpdmUgYSBzbGlnaHQgYnJlYXRoZXIgdG8gdGhlIEFQSQogICAgICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MDApKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBbGwgJHtjb3VudH0gQVBJIGtleXMgZmFpbGVkLiBMYXN0IGVycm9yOiAke2xhc3RFcnJvciA/IGxhc3RFcnJvci5tZXNzYWdlIDogJ1Vua25vd24nfWApOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogSW50ZXJuYWwgcmVxdWVzdCBoZWxwZXIKICAgICAgICAgKi8KYXN5bmMgX21ha2VSZXF1ZXN0KGFwaUtleSwgdXNlclByb21wdCwgYm9uZUxpc3QpIHsKICAgICAgICAgICAgLy8gQ29uc3RydWN0IHRoZSBwcm9tcHQKICAgICAgICAgICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gYApZb3UgYXJlIGFuIGV4cGVydCAzRCBUZWNobmljYWwgQW5pbWF0b3IgdXNpbmcgdGhlIGFkdmFuY2VkIEdlbWluaSAyLjUgRmxhc2ggZW5naW5lLgpUYXJnZXQgU2tlbGV0b24gQm9uZXM6ICR7SlNPTi5zdHJpbmdpZnkoYm9uZUxpc3QpfQoKVGFzazogR2VuZXJhdGUgYSBKU09OIGFuaW1hdGlvbiBmb3IgdGhlIHByb21wdDogIiR7dXNlclByb21wdH0iCgpSZXF1aXJlbWVudHM6CjEuIE91dHB1dCBPTkxZIHZhbGlkIEpTT04uIE5vIG1hcmtkb3duIGZvcm1hdHRpbmcuCjIuIFN0cnVjdHVyZToKewogICJuYW1lIjogImFpX2dlbmVyYXRlZCIsCiAgImZwcyI6IDMwLAogICJkdXJhdGlvbiI6IDxmbG9hdF90b3RhbF9zZWNvbmRzPiwKICAidHJhY2tzIjogWwogICAgewogICAgICAiYm9uZSI6ICI8Qm9uZU5hbWVGcm9tTGlzdD4iLAogICAgICAidHlwZSI6ICJxdWF0ZXJuaW9uIiwgCiAgICAgICJ0aW1lcyI6IFswLjAsIDAuMDMzLCAuLi5dLCAvLyBUaW1lIGluIFNFQ09ORFMKICAgICAgInZhbHVlcyI6IFt4LHkseix3LCAuLi5dIC8vIEZsYXQgYXJyYXkgb2Yga2V5ZnJhbWVzCiAgICB9LAogICAgewogICAgICAiYm9uZSI6ICJIaXBzIiwgCiAgICAgICJ0eXBlIjogInZlY3RvciIsIAogICAgICAidGltZXMiOiBbMC4wLCAuLi5dLCAKICAgICAgInZhbHVlcyI6IFt4LHkseiwgLi4uXSAKICAgIH0KICBdCn0KMy4gIkhpcHMiIGlzIHRoZSByb290LiBNb3ZlIGl0IGlmIHRoZSBhY3Rpb24gcmVxdWlyZXMgKGUuZy4sIGp1bXBpbmcsIHdhbGtpbmcpLgo0LiBVc2UgInF1YXRlcm5pb24iIGZvciByb3RhdGlvbnMgKHgseSx6LHcpLiBFbnN1cmUgdGhleSBhcmUgbm9ybWFsaXplZC4KNS4gVGltZXMgTVVTVCBiZSBpbiBTRUNPTkRTLCBub3QgZnJhbWVzLgo2LiBMaW1pdCBwcmVjaXNpb24gdG8gNCBkZWNpbWFsIHBsYWNlcyB0byBzYXZlIHNwYWNlLgo3LiBFbnN1cmUgdGhlIGFuaW1hdGlvbiBsb29wcyBzZWFtbGVzc2x5IGlmIGl0J3MgYSBjeWNsZSAod2FsaywgcnVuKS4KYDsKCiAgICAgICAgICAgIGNvbnN0IHBheWxvYWQgPSB7CiAgICAgICAgICAgICAgICBjb250ZW50czogW3sKICAgICAgICAgICAgICAgICAgICBwYXJ0czogW3sgdGV4dDogc3lzdGVtUHJvbXB0IH1dCiAgICAgICAgICAgICAgICB9XSwKICAgICAgICAgICAgICAgIGdlbmVyYXRpb25Db25maWc6IHsKICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogMS4wLCAvLyBTbGlnaHRseSBoaWdoZXIgZm9yIEZsYXNoIHRvIGVuY291cmFnZSBtb3Rpb24KICAgICAgICAgICAgICAgICAgICBtYXhPdXRwdXRUb2tlbnM6IDgxOTIsCiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2VNaW1lVHlwZTogImFwcGxpY2F0aW9uL2pzb24iCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CgovLyBGSVg6IERlZmF1bHQgdG8gZ2VtaW5pLTEuNS1mbGFzaCBmb3IgYmV0dGVyIHF1b3RhcyBhbmQgc3BlZWQuIAogICAgICAgICAgICAvLyBnZW1pbmktMi41LXBybyB3YXMgbGlrZWx5IGEgaGFsbHVjaW5hdGlvbiBvciBwbGFjZWhvbGRlci4KY29uc3QgbW9kZWwgPSB0aGlzLm1vZGVsIHx8ICJnZW1pbmktMi41LWZsYXNoIjsKICAgICAgICAgICAgY29uc3QgdXJsID0gYCR7X0JBU0VfVVJMfSR7bW9kZWx9OmdlbmVyYXRlQ29udGVudD9rZXk9JHthcGlLZXl9YDsKCiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBHZW1pbmk6IFJlcXVlc3RpbmcgdmlhICR7bW9kZWx9Li4uYCk7CgogICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwgewogICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsCiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSwKICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHBheWxvYWQpCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykgewogICAgICAgICAgICAgICAgY29uc3QgZXJyRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKS5jYXRjaCgoKSA9PiAoe30pKTsKICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKGVyckRhdGEuZXJyb3I/Lm1lc3NhZ2UgfHwgcmVzcG9uc2Uuc3RhdHVzVGV4dCk7CiAgICAgICAgICAgICAgICBlcnJvci5zdGF0dXMgPSByZXNwb25zZS5zdGF0dXM7CiAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFBhcnNlIEdlbWluaSBSZXNwb25zZQogICAgICAgICAgICBpZiAoIWRhdGEuY2FuZGlkYXRlcyB8fCBkYXRhLmNhbmRpZGF0ZXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIk5vIHJlc3BvbnNlIGNhbmRpZGF0ZXMgZnJvbSBHZW1pbmkuIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IHRleHQgPSBkYXRhLmNhbmRpZGF0ZXNbMF0uY29udGVudC5wYXJ0c1swXS50ZXh0OwogICAgICAgICAgICAvLyBDbGVhbnVwIHBvdGVudGlhbCBtYXJrZG93biBjb2RlIGJsb2NrcyBpZiB0aGUgbW9kZWwgaWdub3JlcyB0aGUgTUlNRSB0eXBlCiAgICAgICAgICAgIC8vIEZsYXNoIHNvbWV0aW1lcyBhZGRzIGBgYGpzb24gLi4uIGBgYCBkZXNwaXRlIHRoZSBtaW1lIHR5cGUKICAgICAgICAgICAgY29uc3QgY2xlYW5Kc29uID0gdGV4dC5yZXBsYWNlKC9gYGBqc29uL2dpLCAnJykucmVwbGFjZSgvYGBgL2csICcnKS50cmltKCk7CiAgICAgICAgICAgIAogICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShjbGVhbkpzb24pOwogICAgICAgIH0KICAgIH0KCiAgICB3aW5kb3cuZmx1eC5nZW1pbmkgPSBuZXcgR2VtaW5pU2VydmljZSgpOwp9KSgpOw==","js/exporter.js":"data:text/javascript;base64,LyoqCiAqIEV4cG9ydGVyU2VydmljZQogKiBIYW5kbGVzIGV4cG9ydGluZyB0aGUgM0QgbW9kZWwgYW5kIGFuaW1hdGlvbnMgdG8gR0xCCiAqLwp3aW5kb3cuZmx1eCA9IHdpbmRvdy5mbHV4IHx8IHt9OwoKKGZ1bmN0aW9uKCkgewogICAgY2xhc3MgRXhwb3J0ZXJTZXJ2aWNlIHsKICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgICAgLy8gQ2hlY2sgaWYgR0xURkV4cG9ydGVyIGlzIGxvYWRlZAogICAgICAgICAgICBpZiAodHlwZW9mIFRIUkVFLkdMVEZFeHBvcnRlciA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkV4cG9ydGVyU2VydmljZTogVEhSRUUuR0xURkV4cG9ydGVyIGlzIG5vdCBsb2FkZWQuIik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLmV4cG9ydGVyID0gbmV3IFRIUkVFLkdMVEZFeHBvcnRlcigpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBFeHBvcnQgbW9kZWwgd2l0aCBhbmltYXRpb25zCiAgICAgICAgICogQHBhcmFtIHtUSFJFRS5PYmplY3QzRH0gbW9kZWwgCiAgICAgICAgICogQHBhcmFtIHtUSFJFRS5BbmltYXRpb25DbGlwW119IGFuaW1hdGlvbnMgCiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGZpbGVOYW1lIAogICAgICAgICAqLwogICAgICAgIGV4cG9ydE1vZGVsKG1vZGVsLCBhbmltYXRpb25zLCBmaWxlTmFtZSA9ICdmbHV4X2NoYXJhY3Rlci5nbGInKSB7CiAgICAgICAgICAgIGlmICghdGhpcy5leHBvcnRlcikgcmV0dXJuOwogICAgICAgICAgICBpZiAoIW1vZGVsKSB7CiAgICAgICAgICAgICAgICBhbGVydCgiTm8gbW9kZWwgdG8gZXhwb3J0LiIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zb2xlLmxvZygiRXhwb3J0ZXI6IFN0YXJ0aW5nIGV4cG9ydC4uLiIsIHsgbW9kZWwsIGFuaW1hdGlvbnMgfSk7CgogICAgICAgICAgICBjb25zdCBvcHRpb25zID0gewogICAgICAgICAgICAgICAgYmluYXJ5OiB0cnVlLAogICAgICAgICAgICAgICAgYW5pbWF0aW9uczogYW5pbWF0aW9ucyB8fCBbXSwKICAgICAgICAgICAgICAgIHRydW5jYXRlRHJhd1JhbmdlOiB0cnVlCiAgICAgICAgICAgIH07CgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgdGhpcy5leHBvcnRlci5wYXJzZSgKICAgICAgICAgICAgICAgICAgICBtb2RlbCwKICAgICAgICAgICAgICAgICAgICAocmVzdWx0KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZlQXJyYXlCdWZmZXIocmVzdWx0LCBmaWxlTmFtZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvdXRwdXQgPSBKU09OLnN0cmluZ2lmeShyZXN1bHQsIG51bGwsIDIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZlU3RyaW5nKG91dHB1dCwgZmlsZU5hbWUucmVwbGFjZSgnLmdsYicsICcuZ2x0ZicpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgKGVycm9yKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0V4cG9ydGVyOiBFcnJvciBkdXJpbmcgcGFyc2luZycsIGVycm9yKTsKICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoIkV4cG9ydCBmYWlsZWQ6ICIgKyBlcnJvci5tZXNzYWdlKTsKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkV4cG9ydGVyOiBFeGNlcHRpb24iLCBlKTsKICAgICAgICAgICAgICAgIGFsZXJ0KCJFeHBvcnQgZmFpbGVkOiAiICsgZS5tZXNzYWdlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgc2F2ZUFycmF5QnVmZmVyKGJ1ZmZlciwgZmlsZW5hbWUpIHsKICAgICAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtidWZmZXJdLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nIH0pOwogICAgICAgICAgICB0aGlzLnRyaWdnZXJEb3dubG9hZChibG9iLCBmaWxlbmFtZSk7CiAgICAgICAgfQoKICAgICAgICBzYXZlU3RyaW5nKHRleHQsIGZpbGVuYW1lKSB7CiAgICAgICAgICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbdGV4dF0sIHsgdHlwZTogJ3RleHQvcGxhaW4nIH0pOwogICAgICAgICAgICB0aGlzLnRyaWdnZXJEb3dubG9hZChibG9iLCBmaWxlbmFtZSk7CiAgICAgICAgfQoKICAgICAgICB0cmlnZ2VyRG93bmxvYWQoYmxvYiwgZmlsZW5hbWUpIHsKICAgICAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgICAgICAgbGluay5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmspOwogICAgICAgICAgICBsaW5rLmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOwogICAgICAgICAgICBsaW5rLmRvd25sb2FkID0gZmlsZW5hbWU7CiAgICAgICAgICAgIGxpbmsuY2xpY2soKTsKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChsaW5rKTsKICAgICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTChsaW5rLmhyZWYpOwogICAgICAgIH0KICAgIH0KCiAgICB3aW5kb3cuZmx1eC5leHBvcnRlciA9IG5ldyBFeHBvcnRlclNlcnZpY2UoKTsKfSkoKTs=","./js/exporter.js":"data:text/javascript;base64,LyoqCiAqIEV4cG9ydGVyU2VydmljZQogKiBIYW5kbGVzIGV4cG9ydGluZyB0aGUgM0QgbW9kZWwgYW5kIGFuaW1hdGlvbnMgdG8gR0xCCiAqLwp3aW5kb3cuZmx1eCA9IHdpbmRvdy5mbHV4IHx8IHt9OwoKKGZ1bmN0aW9uKCkgewogICAgY2xhc3MgRXhwb3J0ZXJTZXJ2aWNlIHsKICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgICAgLy8gQ2hlY2sgaWYgR0xURkV4cG9ydGVyIGlzIGxvYWRlZAogICAgICAgICAgICBpZiAodHlwZW9mIFRIUkVFLkdMVEZFeHBvcnRlciA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkV4cG9ydGVyU2VydmljZTogVEhSRUUuR0xURkV4cG9ydGVyIGlzIG5vdCBsb2FkZWQuIik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLmV4cG9ydGVyID0gbmV3IFRIUkVFLkdMVEZFeHBvcnRlcigpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBFeHBvcnQgbW9kZWwgd2l0aCBhbmltYXRpb25zCiAgICAgICAgICogQHBhcmFtIHtUSFJFRS5PYmplY3QzRH0gbW9kZWwgCiAgICAgICAgICogQHBhcmFtIHtUSFJFRS5BbmltYXRpb25DbGlwW119IGFuaW1hdGlvbnMgCiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGZpbGVOYW1lIAogICAgICAgICAqLwogICAgICAgIGV4cG9ydE1vZGVsKG1vZGVsLCBhbmltYXRpb25zLCBmaWxlTmFtZSA9ICdmbHV4X2NoYXJhY3Rlci5nbGInKSB7CiAgICAgICAgICAgIGlmICghdGhpcy5leHBvcnRlcikgcmV0dXJuOwogICAgICAgICAgICBpZiAoIW1vZGVsKSB7CiAgICAgICAgICAgICAgICBhbGVydCgiTm8gbW9kZWwgdG8gZXhwb3J0LiIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zb2xlLmxvZygiRXhwb3J0ZXI6IFN0YXJ0aW5nIGV4cG9ydC4uLiIsIHsgbW9kZWwsIGFuaW1hdGlvbnMgfSk7CgogICAgICAgICAgICBjb25zdCBvcHRpb25zID0gewogICAgICAgICAgICAgICAgYmluYXJ5OiB0cnVlLAogICAgICAgICAgICAgICAgYW5pbWF0aW9uczogYW5pbWF0aW9ucyB8fCBbXSwKICAgICAgICAgICAgICAgIHRydW5jYXRlRHJhd1JhbmdlOiB0cnVlCiAgICAgICAgICAgIH07CgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgdGhpcy5leHBvcnRlci5wYXJzZSgKICAgICAgICAgICAgICAgICAgICBtb2RlbCwKICAgICAgICAgICAgICAgICAgICAocmVzdWx0KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZlQXJyYXlCdWZmZXIocmVzdWx0LCBmaWxlTmFtZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvdXRwdXQgPSBKU09OLnN0cmluZ2lmeShyZXN1bHQsIG51bGwsIDIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZlU3RyaW5nKG91dHB1dCwgZmlsZU5hbWUucmVwbGFjZSgnLmdsYicsICcuZ2x0ZicpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgKGVycm9yKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0V4cG9ydGVyOiBFcnJvciBkdXJpbmcgcGFyc2luZycsIGVycm9yKTsKICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoIkV4cG9ydCBmYWlsZWQ6ICIgKyBlcnJvci5tZXNzYWdlKTsKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkV4cG9ydGVyOiBFeGNlcHRpb24iLCBlKTsKICAgICAgICAgICAgICAgIGFsZXJ0KCJFeHBvcnQgZmFpbGVkOiAiICsgZS5tZXNzYWdlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgc2F2ZUFycmF5QnVmZmVyKGJ1ZmZlciwgZmlsZW5hbWUpIHsKICAgICAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtidWZmZXJdLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nIH0pOwogICAgICAgICAgICB0aGlzLnRyaWdnZXJEb3dubG9hZChibG9iLCBmaWxlbmFtZSk7CiAgICAgICAgfQoKICAgICAgICBzYXZlU3RyaW5nKHRleHQsIGZpbGVuYW1lKSB7CiAgICAgICAgICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbdGV4dF0sIHsgdHlwZTogJ3RleHQvcGxhaW4nIH0pOwogICAgICAgICAgICB0aGlzLnRyaWdnZXJEb3dubG9hZChibG9iLCBmaWxlbmFtZSk7CiAgICAgICAgfQoKICAgICAgICB0cmlnZ2VyRG93bmxvYWQoYmxvYiwgZmlsZW5hbWUpIHsKICAgICAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgICAgICAgbGluay5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmspOwogICAgICAgICAgICBsaW5rLmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOwogICAgICAgICAgICBsaW5rLmRvd25sb2FkID0gZmlsZW5hbWU7CiAgICAgICAgICAgIGxpbmsuY2xpY2soKTsKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChsaW5rKTsKICAgICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTChsaW5rLmhyZWYpOwogICAgICAgIH0KICAgIH0KCiAgICB3aW5kb3cuZmx1eC5leHBvcnRlciA9IG5ldyBFeHBvcnRlclNlcnZpY2UoKTsKfSkoKTs=","/js/exporter.js":"data:text/javascript;base64,LyoqCiAqIEV4cG9ydGVyU2VydmljZQogKiBIYW5kbGVzIGV4cG9ydGluZyB0aGUgM0QgbW9kZWwgYW5kIGFuaW1hdGlvbnMgdG8gR0xCCiAqLwp3aW5kb3cuZmx1eCA9IHdpbmRvdy5mbHV4IHx8IHt9OwoKKGZ1bmN0aW9uKCkgewogICAgY2xhc3MgRXhwb3J0ZXJTZXJ2aWNlIHsKICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgICAgLy8gQ2hlY2sgaWYgR0xURkV4cG9ydGVyIGlzIGxvYWRlZAogICAgICAgICAgICBpZiAodHlwZW9mIFRIUkVFLkdMVEZFeHBvcnRlciA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkV4cG9ydGVyU2VydmljZTogVEhSRUUuR0xURkV4cG9ydGVyIGlzIG5vdCBsb2FkZWQuIik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLmV4cG9ydGVyID0gbmV3IFRIUkVFLkdMVEZFeHBvcnRlcigpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBFeHBvcnQgbW9kZWwgd2l0aCBhbmltYXRpb25zCiAgICAgICAgICogQHBhcmFtIHtUSFJFRS5PYmplY3QzRH0gbW9kZWwgCiAgICAgICAgICogQHBhcmFtIHtUSFJFRS5BbmltYXRpb25DbGlwW119IGFuaW1hdGlvbnMgCiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGZpbGVOYW1lIAogICAgICAgICAqLwogICAgICAgIGV4cG9ydE1vZGVsKG1vZGVsLCBhbmltYXRpb25zLCBmaWxlTmFtZSA9ICdmbHV4X2NoYXJhY3Rlci5nbGInKSB7CiAgICAgICAgICAgIGlmICghdGhpcy5leHBvcnRlcikgcmV0dXJuOwogICAgICAgICAgICBpZiAoIW1vZGVsKSB7CiAgICAgICAgICAgICAgICBhbGVydCgiTm8gbW9kZWwgdG8gZXhwb3J0LiIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zb2xlLmxvZygiRXhwb3J0ZXI6IFN0YXJ0aW5nIGV4cG9ydC4uLiIsIHsgbW9kZWwsIGFuaW1hdGlvbnMgfSk7CgogICAgICAgICAgICBjb25zdCBvcHRpb25zID0gewogICAgICAgICAgICAgICAgYmluYXJ5OiB0cnVlLAogICAgICAgICAgICAgICAgYW5pbWF0aW9uczogYW5pbWF0aW9ucyB8fCBbXSwKICAgICAgICAgICAgICAgIHRydW5jYXRlRHJhd1JhbmdlOiB0cnVlCiAgICAgICAgICAgIH07CgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgdGhpcy5leHBvcnRlci5wYXJzZSgKICAgICAgICAgICAgICAgICAgICBtb2RlbCwKICAgICAgICAgICAgICAgICAgICAocmVzdWx0KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZlQXJyYXlCdWZmZXIocmVzdWx0LCBmaWxlTmFtZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvdXRwdXQgPSBKU09OLnN0cmluZ2lmeShyZXN1bHQsIG51bGwsIDIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZlU3RyaW5nKG91dHB1dCwgZmlsZU5hbWUucmVwbGFjZSgnLmdsYicsICcuZ2x0ZicpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgKGVycm9yKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0V4cG9ydGVyOiBFcnJvciBkdXJpbmcgcGFyc2luZycsIGVycm9yKTsKICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoIkV4cG9ydCBmYWlsZWQ6ICIgKyBlcnJvci5tZXNzYWdlKTsKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkV4cG9ydGVyOiBFeGNlcHRpb24iLCBlKTsKICAgICAgICAgICAgICAgIGFsZXJ0KCJFeHBvcnQgZmFpbGVkOiAiICsgZS5tZXNzYWdlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgc2F2ZUFycmF5QnVmZmVyKGJ1ZmZlciwgZmlsZW5hbWUpIHsKICAgICAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtidWZmZXJdLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nIH0pOwogICAgICAgICAgICB0aGlzLnRyaWdnZXJEb3dubG9hZChibG9iLCBmaWxlbmFtZSk7CiAgICAgICAgfQoKICAgICAgICBzYXZlU3RyaW5nKHRleHQsIGZpbGVuYW1lKSB7CiAgICAgICAgICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbdGV4dF0sIHsgdHlwZTogJ3RleHQvcGxhaW4nIH0pOwogICAgICAgICAgICB0aGlzLnRyaWdnZXJEb3dubG9hZChibG9iLCBmaWxlbmFtZSk7CiAgICAgICAgfQoKICAgICAgICB0cmlnZ2VyRG93bmxvYWQoYmxvYiwgZmlsZW5hbWUpIHsKICAgICAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgICAgICAgbGluay5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmspOwogICAgICAgICAgICBsaW5rLmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOwogICAgICAgICAgICBsaW5rLmRvd25sb2FkID0gZmlsZW5hbWU7CiAgICAgICAgICAgIGxpbmsuY2xpY2soKTsKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChsaW5rKTsKICAgICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTChsaW5rLmhyZWYpOwogICAgICAgIH0KICAgIH0KCiAgICB3aW5kb3cuZmx1eC5leHBvcnRlciA9IG5ldyBFeHBvcnRlclNlcnZpY2UoKTsKfSkoKTs="}}</script></head>
<body>

    <!-- 3D Container -->
    <div id="canvas-container"></div>

    <!-- UI Overlay: Loading Screen -->
    <div id="loading-overlay">
        <div class="spinner"></div>
        <div id="loading-text">Initializing Core...</div>
    </div>

    <!-- UI Overlay: Main Interface (Hidden initially) -->
<div id="ui-layer" style="display: none;">
        <!-- Top Left: Main Controls -->
        <div class="panel top-left">
            <h3>Flux Animator</h3>
<button id="btn-import">Import GLB</button>
            <button id="btn-export" style="margin-top: 10px;">Export GLB</button>
            <button id="btn-settings" style="margin-top: 10px;">Settings</button>
        </div>

        <!-- Top Right: Animation List -->
        <div class="panel top-right">
            <h3>Animations</h3>
            <div id="anim-list" class="scrollable-list">
                <div class="empty-state">No animations</div>
            </div>
</div>

        <!-- Bottom Left: Generation Controls -->
        <div class="panel bottom-left">
            <h3>AI Generator</h3>
            <textarea id="gen-prompt" placeholder="Describe animation (e.g. 'Do a backflip')..."></textarea>
            <button id="btn-generate">Generate</button>
        </div>

        <!-- Bottom Center: Playback Controls -->
        <div class="panel bottom-center">
            <div id="animation-controls">
                <div class="control-row">
                    <button id="btn-play-pause" class="icon-btn"></button>
                    <button id="btn-stop" class="icon-btn"></button>
                    <span id="time-current" class="time-display">0.0s</span>
                    <input type="range" id="anim-slider" min="0" max="100" value="0" step="0.1">
                    <span id="time-total" class="time-display">0.0s</span>
                </div>
            </div>
        </div>
</div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <h3>Settings</h3>
            <div class="input-group">
                <label>Gemini API Key</label>
<textarea id="api-key-input" placeholder="Paste API Keys here (one per line)" style="resize: vertical; min-height: 80px;"></textarea>
</div>
            <div class="input-group" style="margin-top: 15px;">
                <label>AI Model</label>
<select id="model-select" style="width: 100%; padding: 12px; background: #151515; border: 1px solid #333; border-radius: 6px; color: white;">
                    <option value="gemini-2.5-flash">Gemini 2.5 Flash (Fastest)</option>
                    <option value="gemini-2.5-pro">Gemini 2.5 Pro (Best Quality)</option>
                    <option value="gemini-2.5-flash-lite">Gemini 2.5 Flash Lite (Lightweight)</option>
                </select>
            </div>
            <div class="modal-actions">
                <button id="btn-save-settings">Save &amp; Close</button>
                <button id="btn-cancel-settings" class="secondary">Cancel</button>
            </div>
            <p class="hint">Get your key from Google AI Studio.</p>
        </div>
    </div>

<!-- Logic Modules -->
    <script>/**
 * RigManager
 * Handles Skeleton Analysis, Bone Mapping, and Animation Mixing
 */

window.flux = window.flux || {};

(function() {
    // Standard Mixamo bone names for validation/mapping
    const _mixamoBones = [
        'Hips', 'Spine', 'Spine1', 'Spine2', 'Neck', 'Head',
        'LeftShoulder', 'LeftArm', 'LeftForeArm', 'LeftHand',
        'RightShoulder', 'RightArm', 'RightForeArm', 'RightHand',
        'LeftUpLeg', 'LeftLeg', 'LeftFoot',
        'RightUpLeg', 'RightLeg', 'RightFoot'
    ];

class RigManager {
        constructor() {
            this.model = null;
            this.skeleton = null;
            this.bones = {}; // Map of cleanName -> Bone Object
            this.animations = [];
            this.mixer = null;
            this.currentAction = null;
            this.isPlaying = false;
        }

        /**
         * Analyze a loaded model for Rigging capabilities
         * @param {THREE.Object3D} model 
         * @param {THREE.AnimationClip[]} animations 
         * @returns {boolean} isRigged
         */
        analyze(model, animations) {
            this.reset();
            this.model = model;
            this.animations = animations || [];

            // 1. Find SkinnedMesh
            let skinnedMesh = null;
            model.traverse((child) => {
                if (child.isSkinnedMesh && !skinnedMesh) {
                    skinnedMesh = child;
                }
            });

            if (!skinnedMesh) {
                console.warn("RigManager: No SkinnedMesh found.");
                return false;
            }

            this.skeleton = skinnedMesh.skeleton;
            console.log("RigManager: Skeleton detected.", this.skeleton);

            // 2. Map Bones
            this.mapBones();

            // 3. Setup Mixer
            this.mixer = new THREE.AnimationMixer(this.model);
            
            // Add to global mixer loop
            if (!window.flux.mixers) window.flux.mixers = [];
            window.flux.mixers.push(this.mixer);

            return true;
        }

        reset() {
            if (this.mixer) {
                this.mixer.stopAllAction();
                // Remove from global loop
                if (window.flux.mixers) {
                    window.flux.mixers = window.flux.mixers.filter(m => m !== this.mixer);
                }
            }
            this.model = null;
            this.skeleton = null;
            this.bones = {};
            this.animations = [];
            this.mixer = null;
            this.currentAction = null;
            this.isPlaying = false;
        }

        mapBones() {
            if (!this.skeleton) return;

            this.skeleton.bones.forEach(bone => {
                // Normalize name: remove "Mixamorig:" prefix, remove spaces/colons
                const cleanName = bone.name.replace(/Mixamorig:|:/g, '');
                this.bones[cleanName] = bone;
            });
        }

        /**
         * Play an animation by index or name
         */
        playAnimation(identifier) {
            if (!this.mixer || this.animations.length === 0) return;

            let clip = null;
            if (typeof identifier === 'number') {
                clip = this.animations[identifier];
            } else if (typeof identifier === 'string') {
                clip = this.animations.find(a => a.name === identifier);
            }

            if (clip) {
                if (this.currentAction) {
                    this.currentAction.fadeOut(0.2);
                }
                const action = this.mixer.clipAction(clip);
                action.reset();
                action.fadeIn(0.2);
                action.play();
                this.currentAction = action;
                this.isPlaying = true;
                console.log(`RigManager: Playing ${clip.name}`);
            }
        }

        pause() {
            if (this.currentAction) {
                this.currentAction.paused = true;
                this.isPlaying = false;
            }
        }

        resume() {
            if (this.currentAction) {
                this.currentAction.paused = false;
                this.isPlaying = true;
            }
        }

        stop() {
            if (this.mixer) {
                this.mixer.stopAllAction();
                this.currentAction = null;
                this.isPlaying = false;
            }
        }

        /**
         * Scrub animation to specific normalized time (0-1)
         */
        scrub(progress) {
            if (this.currentAction) {
                const duration = this.currentAction.getClip().duration;
                this.currentAction.time = duration * progress;
            }
        }

        getAnimationList() {
            return this.animations.map((a, i) => ({ name: a.name, index: i }));
        }

getStatus() {
            if (!this.currentAction) return { playing: false, time: 0, duration: 0, progress: 0 };
            
            const clip = this.currentAction.getClip();
            const duration = clip.duration;
            const time = this.currentAction.time;
            
            return {
                playing: !this.currentAction.paused && this.isPlaying,
                time: time % duration,
                duration: duration,
                progress: (time % duration) / duration
            };
        }

        /**
         * Get list of bone names for AI
         */
        getSkeletonStructure() {
            return Object.keys(this.bones);
        }

        /**
         * Create AnimationClip from Gemini JSON
         */
createAnimationFromJSON(data) {
            console.log("RigManager: Parsing AI Animation Data...", data);

            if (!data.tracks || !Array.isArray(data.tracks)) {
                console.error("RigManager: Invalid animation data format. 'tracks' array missing.");
                return null;
            }

            const tracks = [];
            // Use provided duration or calculate max time
            let maxTime = 0;

            data.tracks.forEach(trackData => {
                // Find the actual bone object
                const bone = this.bones[trackData.bone];
                if (!bone) {
                    // console.warn(`RigManager: Bone '${trackData.bone}' not found in rig. Skipping track.`);
                    return; 
                }

                const trackName = bone.name + (trackData.type === 'vector' ? '.position' : '.quaternion');
                
                // Sanitize Inputs
                let times = trackData.times;
                let values = trackData.values;

                if (!Array.isArray(times) || !Array.isArray(values)) {
                    console.warn(`RigManager: Invalid data for bone ${trackData.bone}`);
                    return;
                }

                // Ensure Float32 and flat arrays
                times = new Float32Array(times);
                values = new Float32Array(values.flat());

                // Validation: Value count
                const stride = trackData.type === 'vector' ? 3 : 4;
                if (values.length !== times.length * stride) {
                    console.warn(`RigManager: Mismatch in times/values for ${trackData.bone}. Expected ${times.length * stride} values, got ${values.length}. Trimming/Padding.`);
                    // Simple fix: truncate to match shortest
                    const minLen = Math.min(times.length, Math.floor(values.length / stride));
                    times = times.slice(0, minLen);
                    values = values.slice(0, minLen * stride);
                }

                // Update max time
                if (times.length > 0) {
                    maxTime = Math.max(maxTime, times[times.length - 1]);
                }

                // Create Track
                let track;
                try {
                    if (trackData.type === 'vector') {
                        track = new THREE.VectorKeyframeTrack(trackName, Array.from(times), Array.from(values));
                    } else {
                        track = new THREE.QuaternionKeyframeTrack(trackName, Array.from(times), Array.from(values));
                    }
                    tracks.push(track);
                } catch (err) {
                    console.error(`RigManager: Failed to create track for ${trackData.bone}`, err);
                }
            });

            if (tracks.length === 0) {
                console.error("RigManager: No valid tracks generated.");
                return null;
            }

            const duration = data.duration || maxTime;
            // Generate unique name
            const animName = (data.name || 'AI_Anim') + '_' + Date.now().toString().slice(-4);
            const clip = new THREE.AnimationClip(animName, duration, tracks);
            
            // Add to list
            this.animations.push(clip);
            console.log(`RigManager: Created animation '${animName}' with ${tracks.length} tracks. Duration: ${duration}s`);
            return clip;
}
    }

    // Export instance
    window.flux.rigManager = new RigManager();
})();</script>
<script>/**
 * LoaderService
 * Handles File Input, Drag-and-Drop, and GLB Parsing
 */

window.flux = window.flux || {};

(function() {
    // Private loader instance
    const _gltfLoader = new THREE.GLTFLoader();

    class LoaderService {
        constructor() {
            this.fileInput = null;
        }

        init() {
            console.log("Flux: Initializing Loader Service...");
            this.createFileInput();
            this.setupDragDrop();
            this.setupUIHooks();
        }

        createFileInput() {
            this.fileInput = document.createElement('input');
            this.fileInput.type = 'file';
            this.fileInput.accept = '.glb, .gltf';
            this.fileInput.style.display = 'none';
            document.body.appendChild(this.fileInput);

            this.fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    this.loadFromFile(e.target.files[0]);
                }
            });
        }

        setupUIHooks() {
            const btn = document.getElementById('btn-import');
            if (btn) {
                btn.addEventListener('click', () => {
                    this.fileInput.click();
                });
            }
        }

        setupDragDrop() {
            const dropZone = document.body;

            // Prevent default behaviors
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                }, false);
            });

            // Visual feedback
            dropZone.addEventListener('dragenter', () => dropZone.classList.add('drag-active'), false);
            dropZone.addEventListener('dragleave', () => dropZone.classList.remove('drag-active'), false);
            dropZone.addEventListener('drop', (e) => {
                dropZone.classList.remove('drag-active');
                const dt = e.dataTransfer;
                const files = dt.files;
                if (files.length > 0) {
                    this.loadFromFile(files[0]);
                }
            }, false);
        }

        loadFromFile(file) {
            // Basic validation
            if (!file.name.match(/\.(glb|gltf)$/i)) {
                alert("Only .glb or .gltf files are supported.");
                return;
            }

            const url = URL.createObjectURL(file);
            this.loadFromUrl(url, file.name);
        }

        loadFromUrl(url, filename) {
            console.log(`Loader: Loading ${filename}...`);
            this.showLoading(true);

            _gltfLoader.load(url, (gltf) => {
                console.log("Loader: Success", gltf);
                this.handleModelLoaded(gltf);
                URL.revokeObjectURL(url);
                this.showLoading(false);
            }, (xhr) => {
                // Progress (optional)
                // console.log((xhr.loaded / xhr.total * 100) + '% loaded');
            }, (error) => {
                console.error("Loader: Error", error);
                alert("Failed to load model.");
                this.showLoading(false);
            });
        }

        handleModelLoaded(gltf) {
            const scene = window.flux.scene;
            
            // 1. Cleanup existing model
            if (window.flux.currentModel) {
                scene.remove(window.flux.currentModel);
            }

            // 2. Add new model
            const model = gltf.scene;
            window.flux.currentModel = model;
            scene.add(model);

            // 3. Analyze Rig
            if (window.flux.rigManager) {
                const hasRig = window.flux.rigManager.analyze(model, gltf.animations);
                if (hasRig) {
                    // Play default animation if exists
                    if (gltf.animations.length > 0) {
                        window.flux.rigManager.playAnimation(0);
                    }
                } else {
                    console.warn("Loader: Model loaded but no rig detected.");
                }
            }

            // 4. Fit Camera
this.fitCamera(model);
            
            // 5. Update UI
            if (window.flux.ui) {
                window.flux.ui.onModelLoaded();
            }
        }

        fitCamera(object) {
            const box = new THREE.Box3().setFromObject(object);
            const size = box.getSize(new THREE.Vector3()).length();
            const center = box.getCenter(new THREE.Vector3());

            // Adjust controls
            const controls = window.flux.controls;
            controls.target.copy(center);
            
            // Adjust camera position
            const camera = window.flux.camera;
            const direction = new THREE.Vector3(0, 0, 1); // Front view
            
            // Calculate distance to fit
            const fov = camera.fov * (Math.PI / 180);
            let distance = Math.abs(size / Math.sin(fov / 2));
            distance *= 0.8; // Zoom out slightly

            const offset = direction.multiplyScalar(distance);
            camera.position.copy(center).add(offset);
            camera.position.y += size * 0.2; // Slight lift
            
            camera.updateProjectionMatrix();
            controls.update();
        }

        showLoading(isLoading) {
            const overlay = document.getElementById('loading-overlay');
            const text = document.getElementById('loading-text');
            if (overlay && text) {
                overlay.style.display = isLoading ? 'flex' : 'none';
                text.innerText = isLoading ? 'Importing Model...' : 'Ready';
            }
        }
    }

    window.flux.loader = new LoaderService();
})();</script>
<script>/**
 * UI Controller
 * Manages Animation List, Playback Controls, and Scrubbing
 */
window.flux = window.flux || {};

(function() {
class UIController {
        constructor() {
this.dom = {
                animList: null,
                playPauseBtn: null,
                stopBtn: null,
                slider: null,
                timeCurrent: null,
                timeTotal: null,
                settingsModal: null,
                apiKeyInput: null,
                modelSelect: null,
                genPrompt: null,
                genBtn: null,
                exportBtn: null
            };
            this.isDragging = false;
        }

        init() {
            console.log("Flux: Initializing UI Controller...");
            this.cacheDOM();
            this.bindEvents();
        }

cacheDOM() {
            this.dom.animList = document.getElementById('anim-list');
            this.dom.playPauseBtn = document.getElementById('btn-play-pause');
            this.dom.stopBtn = document.getElementById('btn-stop');
            this.dom.slider = document.getElementById('anim-slider');
            this.dom.timeCurrent = document.getElementById('time-current');
            this.dom.timeTotal = document.getElementById('time-total');
            this.dom.settingsModal = document.getElementById('settings-modal');
            this.dom.apiKeyInput = document.getElementById('api-key-input');
            this.dom.modelSelect = document.getElementById('model-select');
            this.dom.genPrompt = document.getElementById('gen-prompt');
            this.dom.genBtn = document.getElementById('btn-generate');
            this.dom.exportBtn = document.getElementById('btn-export');
        }

        bindEvents() {
            // Play/Pause
            if (this.dom.playPauseBtn) {
                this.dom.playPauseBtn.addEventListener('click', () => {
                    const rig = window.flux.rigManager;
                    const status = rig.getStatus();
                    if (status.playing) {
                        rig.pause();
                        this.dom.playPauseBtn.textContent = '';
                    } else {
                        rig.resume();
                        this.dom.playPauseBtn.textContent = '';
                    }
                });
            }

            // Stop
            if (this.dom.stopBtn) {
                this.dom.stopBtn.addEventListener('click', () => {
                    window.flux.rigManager.stop();
                    this.dom.playPauseBtn.textContent = '';
                    this.updateSlider(0, 0);
                });
            }

            // Slider Scrubbing
            if (this.dom.slider) {
                this.dom.slider.addEventListener('input', (e) => {
                    this.isDragging = true;
                    const val = parseFloat(e.target.value) / 100;
                    window.flux.rigManager.scrub(val);
                    window.flux.rigManager.pause(); // Pause while scrubbing
                    this.dom.playPauseBtn.textContent = '';
                });

                this.dom.slider.addEventListener('change', (e) => {
                    this.isDragging = false;
                });
}

            // Settings Modal
            const btnSettings = document.getElementById('btn-settings');
            const btnSave = document.getElementById('btn-save-settings');
            const btnCancel = document.getElementById('btn-cancel-settings');

            if (btnSettings) {
                btnSettings.addEventListener('click', () => {
this.dom.apiKeyInput.value = window.flux.gemini.getApiKeysRaw();
                    if (this.dom.modelSelect) {
                        this.dom.modelSelect.value = window.flux.gemini.getModel();
                    }
                    this.dom.settingsModal.style.display = 'flex';
                });
            }

            if (btnSave) {
                btnSave.addEventListener('click', () => {
window.flux.gemini.setApiKeys(this.dom.apiKeyInput.value);
                    if (this.dom.modelSelect) {
                        window.flux.gemini.setModel(this.dom.modelSelect.value);
                    }
                    this.dom.settingsModal.style.display = 'none';
                });
            }

            if (btnCancel) {
                btnCancel.addEventListener('click', () => {
                    this.dom.settingsModal.style.display = 'none';
                });
            }

            // Generation
            if (this.dom.genBtn) {
                this.dom.genBtn.addEventListener('click', async () => {
                    await this.handleGeneration();
                });
}

            // Export
            if (this.dom.exportBtn) {
                this.dom.exportBtn.addEventListener('click', () => {
                    this.exportGLB();
                });
            }
        }

async handleGeneration() {
            const prompt = this.dom.genPrompt.value;
            if (!prompt) return;

            if (!window.flux.gemini.hasKey()) {
                alert("Please set your Gemini API Key in Settings first.");
                return;
            }

            const rig = window.flux.rigManager;
            if (!rig.model) {
                alert("Please import a model first.");
                return;
            }

            // Show Loading Overlay
            window.flux.loader.showLoading(true);
            const loadingText = document.getElementById('loading-text');
            if (loadingText) loadingText.innerText = "Generating Animation...";

            try {
                const bones = rig.getSkeletonStructure();
                console.log("Flux: Requesting animation for:", prompt);
                
                const animData = await window.flux.gemini.generateAnimation(prompt, bones);
                console.log("Flux: Received Data", animData);

                const clip = rig.createAnimationFromJSON(animData);
                
                if (clip) {
                    this.refreshAnimationList();
                    rig.playAnimation(clip.name);
                    if (this.dom.playPauseBtn) this.dom.playPauseBtn.textContent = '';
                } else {
                    alert("Failed to create animation from AI response.");
                }

            } catch (e) {
                console.error(e);
                alert("Generation Failed: " + e.message);
            } finally {
                // Hide Loading Overlay
                window.flux.loader.showLoading(false);
            }
        }

        exportGLB() {
            const model = window.flux.currentModel;
            const animations = window.flux.rigManager.animations;
            
            if (window.flux.exporter) {
                const originalText = this.dom.exportBtn.textContent;
                this.dom.exportBtn.textContent = "Exporting...";
                this.dom.exportBtn.disabled = true;

                // Small delay to render UI change
                setTimeout(() => {
                    window.flux.exporter.exportModel(model, animations, 'flux_character.glb');
                    this.dom.exportBtn.textContent = originalText;
                    this.dom.exportBtn.disabled = false;
                }, 50);
            } else {
                console.error("Exporter service not available");
            }
        }

        onModelLoaded() {
            this.refreshAnimationList();
            // Reset controls
            if (this.dom.playPauseBtn) this.dom.playPauseBtn.textContent = '';
            this.updateSlider(0, 0);
        }

        refreshAnimationList() {
            const list = this.dom.animList;
            if (!list) return;

            list.innerHTML = '';
            const anims = window.flux.rigManager.getAnimationList();

            if (anims.length === 0) {
                list.innerHTML = '<div class="empty-state">No animations found</div>';
                return;
            }

            anims.forEach(anim => {
                const item = document.createElement('div');
                item.className = 'anim-item';
                item.textContent = anim.name;
                item.addEventListener('click', () => {
                    // Highlight logic
                    Array.from(list.children).forEach(c => c.classList.remove('active'));
                    item.classList.add('active');
                    
                    // Play
                    window.flux.rigManager.playAnimation(anim.name);
                    if (this.dom.playPauseBtn) this.dom.playPauseBtn.textContent = '';
                });
                list.appendChild(item);
            });
        }

        update() {
            // Called every frame
            if (this.isDragging) return; // Don't fight user input

            const rig = window.flux.rigManager;
            if (!rig) return;

            const status = rig.getStatus();
            
            // Update Time Displays
            if (this.dom.timeCurrent) this.dom.timeCurrent.textContent = status.time.toFixed(1) + 's';
            if (this.dom.timeTotal) this.dom.timeTotal.textContent = status.duration.toFixed(1) + 's';

            // Update Slider
            if (this.dom.slider && status.duration > 0) {
                this.dom.slider.value = status.progress * 100;
            }

            // Sync Play Button if state changed externally (e.g. finish)
            if (this.dom.playPauseBtn) {
                const symbol = status.playing ? '' : '';
                if (this.dom.playPauseBtn.textContent !== symbol) {
                    this.dom.playPauseBtn.textContent = symbol;
                }
            }
        }
        
        updateSlider(time, duration) {
             if (this.dom.timeCurrent) this.dom.timeCurrent.textContent = time.toFixed(1) + 's';
             if (this.dom.timeTotal) this.dom.timeTotal.textContent = duration.toFixed(1) + 's';
             if (this.dom.slider) this.dom.slider.value = (duration > 0 ? (time/duration)*100 : 0);
        }
    }

    window.flux.ui = new UIController();
    
    // Init immediately if document ready, or wait
    if (document.readyState === 'complete' || document.readyState === 'interactive') {
        window.flux.ui.init();
    } else {
        window.addEventListener('DOMContentLoaded', () => window.flux.ui.init());
    }
})();</script>
<script>/**
 * GeminiService
 * Handles communication with Google Gemini API for Animation Generation
 */
window.flux = window.flux || {};

(function() {
const _BASE_URL = "https://generativelanguage.googleapis.com/v1beta/models/";

// Environment Configuration
    // The system expects window.GEMINI_API_KEY to be available in the global scope.
    
    class GeminiService {
        constructor() {
            this.apiKeys = [];
            this.currentIndex = 0;
            this.model = "gemini-2.5-flash"; // Default
            this.loadKeys();
        }

        loadKeys() {
            // 1. Priority: Environment Variable (injected by host)
            // We check for common environment variable patterns
            const envKey = window.GEMINI_API_KEY || window.GOOGLE_API_KEY;
            
            if (envKey) {
                this.apiKeys = [envKey];
                console.log("Gemini: Using Environment API Key.");
                return;
            }

            // 2. Fallback: LocalStorage
            const storedKeys = localStorage.getItem('flux_gemini_api_keys');
            // Fallback to old single key
            const oldKey = localStorage.getItem('flux_gemini_api_key');

            if (storedKeys) {
                try {
                    this.apiKeys = JSON.parse(storedKeys);
                } catch (e) {
                    this.apiKeys = [];
                }
            } else if (oldKey) {
                this.apiKeys = [oldKey];
                // Migrate immediately
                this.saveKeys();
            }

            // Load index
            const storedIndex = localStorage.getItem('flux_gemini_key_index');
this.currentIndex = storedIndex ? parseInt(storedIndex, 10) : 0;

            // Load Model
            const storedModel = localStorage.getItem('flux_gemini_model');
            if (storedModel) {
                this.model = storedModel;
            }

            // Validation
            if (!Array.isArray(this.apiKeys)) this.apiKeys = [];
            if (this.currentIndex >= this.apiKeys.length || this.currentIndex < 0) {
                this.currentIndex = 0;
            }
        }

saveKeys() {
            localStorage.setItem('flux_gemini_api_keys', JSON.stringify(this.apiKeys));
            localStorage.setItem('flux_gemini_key_index', this.currentIndex);
            localStorage.setItem('flux_gemini_model', this.model);
        }

        /**
         * Set keys from a raw string (newline or comma separated)
         */
        setApiKeys(inputString) {
            if (!inputString) {
                this.apiKeys = [];
            } else {
                // Split by newline or comma, trim, and remove empty
                this.apiKeys = inputString.split(/[\n,]+/)
                    .map(k => k.trim())
                    .filter(k => k.length > 0);
            }
            
            // Reset index to 0 when keys change to ensure we start fresh
            this.currentIndex = 0;
            this.saveKeys();
        }

getApiKeysRaw() {
            return this.apiKeys.join('\n');
        }

        setModel(modelName) {
            this.model = modelName;
            this.saveKeys(); // Reusing saveKeys to save all config
        }

        getModel() {
            return this.model;
        }

        hasKey() {
            return this.apiKeys.length > 0;
        }

        /**
         * Generate animation data based on prompt and skeleton
         * Cycles through keys if one fails.
         */
async generateAnimation(userPrompt, boneList) {
            if (this.apiKeys.length === 0) throw new Error("No API Keys found. Please check Settings.");

            let lastError = null;
            const count = this.apiKeys.length;
            
            // Start from the remembered index
            const startIndex = this.currentIndex;

            console.log(`Gemini: Starting generation. Have ${count} keys. Starting at index ${startIndex}.`);

            // Try each key exactly once
            for (let i = 0; i < count; i++) {
                // Wrap around logic
                const index = (startIndex + i) % count;
                const apiKey = this.apiKeys[index];

                try {
                    const result = await this._makeRequest(apiKey, userPrompt, boneList);
                    
                    // Success! 
                    // If we drifted to a new key, save it as the new default
                    if (index !== this.currentIndex) {
                        console.log(`Gemini: Switching preferred key index from ${this.currentIndex} to ${index}`);
                        this.currentIndex = index;
                        this.saveKeys();
                    }
                    
                    return result;

                } catch (e) {
                    console.warn(`Gemini: Key index ${index} failed [Status: ${e.status || 'N/A'}]: ${e.message}`);
                    lastError = e;

                    // FORCE RETRY: We ignore the error type and try the next key.
                    // This fixes issues where a single malformed key (400) or permission issue (403)
                    // would previously halt the entire process.
                    
                    // Delay to prevent browser throttling and give a slight breather to the API
                    await new Promise(resolve => setTimeout(resolve, 500));
                }
            }

            throw new Error(`All ${count} API keys failed. Last error: ${lastError ? lastError.message : 'Unknown'}`);
        }

        /**
         * Internal request helper
         */
async _makeRequest(apiKey, userPrompt, boneList) {
            // Construct the prompt
            const systemPrompt = `
You are an expert 3D Technical Animator using the advanced Gemini 2.5 Flash engine.
Target Skeleton Bones: ${JSON.stringify(boneList)}

Task: Generate a JSON animation for the prompt: "${userPrompt}"

Requirements:
1. Output ONLY valid JSON. No markdown formatting.
2. Structure:
{
  "name": "ai_generated",
  "fps": 30,
  "duration": <float_total_seconds>,
  "tracks": [
    {
      "bone": "<BoneNameFromList>",
      "type": "quaternion", 
      "times": [0.0, 0.033, ...], // Time in SECONDS
      "values": [x,y,z,w, ...] // Flat array of keyframes
    },
    {
      "bone": "Hips", 
      "type": "vector", 
      "times": [0.0, ...], 
      "values": [x,y,z, ...] 
    }
  ]
}
3. "Hips" is the root. Move it if the action requires (e.g., jumping, walking).
4. Use "quaternion" for rotations (x,y,z,w). Ensure they are normalized.
5. Times MUST be in SECONDS, not frames.
6. Limit precision to 4 decimal places to save space.
7. Ensure the animation loops seamlessly if it's a cycle (walk, run).
`;

            const payload = {
                contents: [{
                    parts: [{ text: systemPrompt }]
                }],
                generationConfig: {
                    temperature: 1.0, // Slightly higher for Flash to encourage motion
                    maxOutputTokens: 8192,
                    responseMimeType: "application/json"
                }
            };

// FIX: Default to gemini-1.5-flash for better quotas and speed. 
            // gemini-2.5-pro was likely a hallucination or placeholder.
const model = this.model || "gemini-2.5-flash";
            const url = `${_BASE_URL}${model}:generateContent?key=${apiKey}`;

            console.log(`Gemini: Requesting via ${model}...`);

            const response = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (!response.ok) {
                const errData = await response.json().catch(() => ({}));
                const error = new Error(errData.error?.message || response.statusText);
                error.status = response.status;
                throw error;
            }

            const data = await response.json();
            
            // Parse Gemini Response
            if (!data.candidates || data.candidates.length === 0) {
                throw new Error("No response candidates from Gemini.");
            }

            const text = data.candidates[0].content.parts[0].text;
            // Cleanup potential markdown code blocks if the model ignores the MIME type
            // Flash sometimes adds ```json ... ``` despite the mime type
            const cleanJson = text.replace(/```json/gi, '').replace(/```/g, '').trim();
            
            return JSON.parse(cleanJson);
        }
    }

    window.flux.gemini = new GeminiService();
})();</script>
    <script>/**
 * ExporterService
 * Handles exporting the 3D model and animations to GLB
 */
window.flux = window.flux || {};

(function() {
    class ExporterService {
        constructor() {
            // Check if GLTFExporter is loaded
            if (typeof THREE.GLTFExporter === 'undefined') {
                console.error("ExporterService: THREE.GLTFExporter is not loaded.");
            } else {
                this.exporter = new THREE.GLTFExporter();
            }
        }

        /**
         * Export model with animations
         * @param {THREE.Object3D} model 
         * @param {THREE.AnimationClip[]} animations 
         * @param {string} fileName 
         */
        exportModel(model, animations, fileName = 'flux_character.glb') {
            if (!this.exporter) return;
            if (!model) {
                alert("No model to export.");
                return;
            }

            console.log("Exporter: Starting export...", { model, animations });

            const options = {
                binary: true,
                animations: animations || [],
                truncateDrawRange: true
            };

            try {
                this.exporter.parse(
                    model,
                    (result) => {
                        if (result instanceof ArrayBuffer) {
                            this.saveArrayBuffer(result, fileName);
                        } else {
                            const output = JSON.stringify(result, null, 2);
                            this.saveString(output, fileName.replace('.glb', '.gltf'));
                        }
                    },
                    (error) => {
                        console.error('Exporter: Error during parsing', error);
                        alert("Export failed: " + error.message);
                    },
                    options
                );
            } catch (e) {
                console.error("Exporter: Exception", e);
                alert("Export failed: " + e.message);
            }
        }

        saveArrayBuffer(buffer, filename) {
            const blob = new Blob([buffer], { type: 'application/octet-stream' });
            this.triggerDownload(blob, filename);
        }

        saveString(text, filename) {
            const blob = new Blob([text], { type: 'text/plain' });
            this.triggerDownload(blob, filename);
        }

        triggerDownload(blob, filename) {
            const link = document.createElement('a');
            link.style.display = 'none';
            document.body.appendChild(link);
            link.href = URL.createObjectURL(blob);
            link.download = filename;
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(link.href);
        }
    }

    window.flux.exporter = new ExporterService();
})();</script>
    <!-- Main Application Logic -->
    <script>/**
 * Main Entry Point for Flux Animator
 * Handles Scene Setup, Rendering Loop, and Window Resizing
 */

// Namespace registration
window.flux = window.flux || {};

(function() {
    // --- Private Module Scope Variables ---
    // (Using underscore prefix for file-scoped variables to avoid collisions if we were in global, 
    // though this IIFE protects them. We attach public API to window.flux)
    
    let _scene, _camera, _renderer, _controls;
    let _clock;
    
    // Configuration for the environment
    const _envConfig = {
        bgColor: 0x222222,
        gridSize: 20,
        gridDivisions: 20
    };

    /**
     * Initialize the 3D Environment
     */
    function init() {
        console.log("Flux: Initializing Core Environment...");

        // 1. Scene
        _scene = new THREE.Scene();
        _scene.background = new THREE.Color(_envConfig.bgColor);
        
        // Fog for depth
        _scene.fog = new THREE.Fog(_envConfig.bgColor, 10, 50);

        // 2. Camera
        _camera = new THREE.PerspectiveCamera(
            60, // FOV
            window.innerWidth / window.innerHeight, // Aspect
            0.1, // Near
            1000 // Far
        );
        _camera.position.set(0, 1.5, 3); // Standard character viewing height

        // 3. Renderer
        const container = document.getElementById('canvas-container');
        _renderer = new THREE.WebGLRenderer({ antialias: true });
        _renderer.setPixelRatio(window.devicePixelRatio);
        _renderer.setSize(window.innerWidth, window.innerHeight);
        _renderer.outputEncoding = THREE.sRGBEncoding;
        _renderer.shadowMap.enabled = true;
        container.appendChild(_renderer.domElement);

        // 4. Lights
        setupLights();

        // 5. Helpers (Grid)
        const gridHelper = new THREE.GridHelper(_envConfig.gridSize, _envConfig.gridDivisions, 0x444444, 0x333333);
        _scene.add(gridHelper);

        // 6. Controls
        _controls = new THREE.OrbitControls(_camera, _renderer.domElement);
        _controls.enableDamping = true;
        _controls.dampingFactor = 0.05;
        _controls.target.set(0, 1, 0); // Look at roughly chest height of a character
        _controls.update();

        // 7. Clock
        _clock = new THREE.Clock();

        // 8. Event Listeners
        window.addEventListener('resize', onWindowResize, false);

        // 9. Expose to Namespace
        window.flux.scene = _scene;
        window.flux.camera = _camera;
        window.flux.renderer = _renderer;
        window.flux.controls = _controls;

// Start Loop
        animate();
        
        // Initialize Loader Service
        if (window.flux.loader) {
            window.flux.loader.init();
        }
        
        // Hide Loader
        setTimeout(() => {
            document.getElementById('loading-overlay').style.display = 'none';
            document.getElementById('ui-layer').style.display = 'block';
        }, 500);
    }

    /**
     * Setup Lighting Environment
     */
    function setupLights() {
        // Hemisphere Light (Sky/Ground ambient)
        const hemiLight = new THREE.HemisphereLight(0xffffff, 0x444444, 0.6);
        hemiLight.position.set(0, 20, 0);
        _scene.add(hemiLight);

        // Directional Light (Sun/Key light)
        const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
        dirLight.position.set(3, 10, 10);
        dirLight.castShadow = true;
        dirLight.shadow.camera.top = 2;
        dirLight.shadow.camera.bottom = -2;
        dirLight.shadow.camera.left = -2;
        dirLight.shadow.camera.right = 2;
        dirLight.shadow.camera.near = 0.1;
        dirLight.shadow.camera.far = 40;
        _scene.add(dirLight);
    }

    /**
     * Handle Window Resize
     */
    function onWindowResize() {
        if (!_camera || !_renderer) return;
        
        _camera.aspect = window.innerWidth / window.innerHeight;
        _camera.updateProjectionMatrix();
        _renderer.setSize(window.innerWidth, window.innerHeight);
    }

    /**
     * Main Animation Loop
     */
    function animate() {
        requestAnimationFrame(animate);

        const delta = _clock.getDelta();

        if (_controls) _controls.update();

// Placeholder for mixer updates later
        if (window.flux.mixers) {
            window.flux.mixers.forEach(mixer => mixer.update(delta));
        }

        // Update UI
        if (window.flux.ui) {
            window.flux.ui.update();
        }

        _renderer.render(_scene, _camera);
    }

    // Boot
    init();

})();</script>


</body></html>
